@using System.Diagnostics
@using System.Web.Mvc.Html
@model ProjectManagement.ViewModels.ProjectManager.VmPmIncentivePolicy

<style>
    .nav-tabs > li.active > a, .nav-tabs > li.active > a:hover, .nav-tabs > li.active > a:focus {
        /*background-color: #65C1E0;*/
        background-color: #569450;
        color: white;
    }

    .nav-stacked > li.active > a, .nav-stacked > li.active > a:hover, .nav-stacked > li.active > a:focus {
        background-color: #65C1E0;
        color: white;
    }

    .page-header-fixed .page-container {
        margin-top: 0px;
    }

    .navbar-fixed-top {
        position: relative;
    }
</style>
<style type="text/css">
    .tabColor {
        color: white !important;
        background-color: rgb(209, 234, 170);
        /*background-color:greenyellow;*/
    }
</style>

<div class="row">
    <div class="col-lg-12">
        <div class="portlet box green-seagreen">
            <div class="portlet-title">
                <div class="caption">
                    Welcome to Monthly Incentive
                </div>

            </div>
            <div class="portlet-body form">

                <div class="row">

                    <br />
                    <div class="col-lg-12">
                        <div class="col-lg-1">******</div><div class="col-lg-4">
                            Incentive Type<br />
                            -------------------
                        </div><div class="col-lg-3"></div><div class="col-lg-4"></div>
                    </div>
                    <br /><br /><br />

                    <div class="col-lg-12">
                        <div class="col-lg-4">
                            <div class="col-lg-3" style="color: red;">**Select Month</div>
                            <div class="col-lg-9">
                                @{
                                    List<SelectListItem> listItems = new List<SelectListItem>();

                                    listItems.Add(new SelectListItem
                                    {
                                        Text = "SELECT MONTH",
                                        Value = "0"
                                    });

                                    listItems.Add(new SelectListItem
                                    {
                                        Text = "January",
                                        Value = "1"
                                    });
                                    listItems.Add(new SelectListItem
                                    {
                                        Text = "February",
                                        Value = "2",
                                    });
                                    listItems.Add(new SelectListItem
                                    {
                                        Text = "March",
                                        Value = "3"
                                    });
                                    listItems.Add(new SelectListItem
                                    {
                                        Text = "April",
                                        Value = "4"
                                    });
                                    listItems.Add(new SelectListItem
                                    {
                                        Text = "May",
                                        Value = "5"
                                    });
                                    listItems.Add(new SelectListItem
                                    {
                                        Text = "June",
                                        Value = "6"
                                    });
                                    listItems.Add(new SelectListItem
                                    {
                                        Text = "July",
                                        Value = "7"
                                    });
                                    listItems.Add(new SelectListItem
                                    {
                                        Text = "August",
                                        Value = "8"
                                    });
                                    listItems.Add(new SelectListItem
                                    {
                                        Text = "September",
                                        Value = "9"
                                    });
                                    listItems.Add(new SelectListItem
                                    {
                                        Text = "October",
                                        Value = "10"
                                    });
                                    listItems.Add(new SelectListItem
                                    {
                                        Text = "November",
                                        Value = "11"
                                    });
                                    listItems.Add(new SelectListItem
                                    {
                                        Text = "December",
                                        Value = "12"
                                    });
                                }
                                @Html.DropDownList("DDDMonth", new SelectList(listItems, "Value", "Text"), new { @class = "form-control DDDMonthCls1" })
                            </div>


                        </div>
                        <div class="col-lg-4">
                            <div class="col-lg-4" style="color: red;">**Select Year</div>
                            <div class="col-lg-8">
                                @{
                                    List<SelectListItem> listItems2 = new List<SelectListItem>();

                                    listItems2.Add(new SelectListItem
                                    {
                                        Text = "2018",
                                        Value = "2018"
                                    });
                                    listItems2.Add(new SelectListItem
                                    {
                                        Text = "2019",
                                        Value = "2019"
                                    });
                                    listItems2.Add(new SelectListItem
                                    {
                                        Text = "2020",
                                        Value = "2020"
                                    });
                                    listItems2.Add(new SelectListItem
                                    {
                                        Text = "2021",
                                        Value = "2021"
                                    });
                                    listItems2.Add(new SelectListItem
                                    {
                                        Text = "2022",
                                        Value = "2022"
                                    });
                                    listItems2.Add(new SelectListItem
                                    {
                                        Text = "2023",
                                        Value = "2023"
                                    });
                                    listItems2.Add(new SelectListItem
                                    {
                                        Text = "2024",
                                        Value = "2024"
                                    });
                                    listItems2.Add(new SelectListItem
                                    {
                                        Text = "2025",
                                        Value = "2025"
                                    });
                                    listItems2.Add(new SelectListItem
                                    {
                                        Text = "2026",
                                        Value = "2026"
                                    });
                                    listItems2.Add(new SelectListItem
                                    {
                                        Text = "2027",
                                        Value = "2027"
                                    });
                                    listItems2.Add(new SelectListItem
                                    {
                                        Text = "2028",
                                        Value = "2028"
                                    });
                                    listItems2.Add(new SelectListItem
                                    {
                                        Text = "2029",
                                        Value = "2029"
                                    });
                                    listItems2.Add(new SelectListItem
                                    {
                                        Text = "2030",
                                        Value = "2030"
                                    });
                                }
                                @Html.DropDownList("DDDYear", new SelectList(listItems2, "Value", "Text"), "SELECT YEAR", new { @class = "form-control DDDYearCls" })
                            </div>

                        </div>
                        <div class="col-lg-4">
                            <div class="col-lg-4" style="color: red;">**Select Person</div>
                            <div class="col-lg-8">
                                @if (Model != null && Model.CmnUserModelsList.Any())
                                {

                                    @Html.DropDownListFor(model => model.EmployeeCode, new SelectList(@Model.CmnUserModelsList, "EmployeeCode", "UserFullName"), "SELECT PERSON", new { @class = "dropForPerson form-control", @id = "sltPerson", @onchange = "LoadProject()", Value = @Model.CmnUserModel.UserFullName })


                                }
                            </div>
                        </div>
                    </div>
                    <br /><br /><br />
                    <div class="col-lg-12">
                        <div class="col-lg-4">
                            <div class="col-lg-3" style="color: brown;">  Select Type </div>
                            <div class="col-lg-9">

                                @if (Model != null && Model.PmIncentiveBaseModelsList.Any())
                                {
                                    @*@Html.DropDownListFor(model => model.PmIncentiveBaseModels.Id, new SelectList(@Model.PmIncentiveBaseModelsList, "Id", "IncentiveName"), "SELECT INCENTIVE TYPE", new { @class = "dropForIncentive form-control", Value = @Model.PmIncentiveBaseModels.Id })*@
                                    @Html.DropDownListFor(model => model.PmIncentiveBaseModels.Id, new SelectList(ViewBag.IncentivesValue, "Value", "Text"), "SELECT INCENTIVE TYPE", new { @class = "dropForIncentive form-control" })

                                }
                            </div>
                        </div>

                        <div class="col-lg-4">
                            <div class="col-lg-4" style="color: brown;">Select Project</div>
                            <div class="col-lg-8">

                                @{
                                    Debug.Assert(@Model != null, "@Model != null");
                                }
                                @*@Html.DropDownListFor(model => model.ProjectMasterModel.ProjectMasterId, new SelectList(@Model.ProjectMasterModelsList, "ProjectMasterId", "ProjectName"), "SELECT PROJECT", new { @class = "dropForProjects form-control", Value = @Model.ProjectMasterModel.ProjectName })*@
                                @Html.DropDownListFor(model => model.ProjectMasterId, new SelectList(ViewBag.Projects, "Value", "Text"), "SELECT PROJECT", new { @class = "dropForProject form-control" })

                            </div>
                        </div>
                        <div class="col-lg-4">
                        </div>
                    </div>
                </div>
                <br />
                <div class="row">
                    <div class="col-lg-12">
                        <div class="col-lg-4">
                            <label class="control-label col-lg-3" style="color: brown;">Remarks</label>
                            <div class="col-lg-9">
                                @Html.TextAreaFor(model => model.PmIncentiveModels.Remarks, new { @class = "form-control" })
                            </div>
                        </div>
                        <div class="col-lg-4">
                            <label class="control-label col-lg-4" style="color: brown">Deduct Amount</label>
                            <div class="col-lg-8">
                                @Html.TextBoxFor(model => model.PmIncentiveModels.DeductionAmount, new { @class = "form-control" })
                            </div>
                        </div>
                        <div class="col-lg-4">
                            <label class="control-label col-lg-4" style="color: brown">Deduct Remarks</label>
                            <div class="col-lg-8">
                                @Html.TextAreaFor(model => model.PmIncentiveModels.D_Remarks, new { @class = "form-control" })
                            </div>
                        </div>
                    </div>
                    <br /><br /><br />
                    <div class="col-lg-12">
                        <div class="col-lg-4"></div>
                        <div class="col-lg-4">
                            <button id="btnAdd" class="btn btn-lg blue m-icon-big"><i class="fa fa-plus-circle" aria-hidden="true"></i>Add</button>
                        </div>
                        <div class="col-lg-4"></div>

                    </div>
                    <br /><br /><br />
                </div>
                <br /><br /><br />
                @if (TempData["Message2"] != null)
                {

                    var msgss = TempData["Message2"];

                    <div class="alert alert-danger alert-dismissable">
                        <button type="button" class="close" data-dismiss="alert" aria-hidden="true"></button>
                        <strong>Message:</strong> @msgss
                    </div>

                }
                <br /><br />
                <div class="row">
                    <div class="col-sm-12">
                        <div class="portlet light bordered">
                            <div class="portlet box green-haze">
                                <div class="portlet-body">
                                    <div class="table-scrollable table-responsive" style="overflow-y: auto;overflow-x: auto">
                                        <table class="table table-bordered table-striped table-condensed flip-content" id="tbl" style="overflow-y: auto;overflow-x: auto">
                                            <thead>
                                                <tr>
                                                    <th style="width: 100px;">Incentive Type</th>
                                                    <th>P_Name</th>
                                                    <th>EmpCode</th>
                                                    <th>Amount</th>
                                                    <th>Remarks</th>
                                                    <th>D_Amount</th>
                                                    <th>D_Remarks</th>
                                                    <th>F_Amount</th>
                                                    <th>Month</th>
                                                    <th>Year</th>
                                                    <th>Action</th>

                                                </tr>
                                            </thead>
                                            <tbody id="tBody" class="tBody" style="overflow-y: auto;overflow-x: auto">

                                                @foreach (var pmCusModel in Model.PmIncentiveModels.CustomPmIncentiveModels)
                                                {
                                                    Html.RenderPartial("~/Views/ProjectManager/Partial/_PmIncentiveList.cshtml", pmCusModel);
                                                }
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <br />
                <div class="row">
                    <div class="col-lg-12">
                        <div class="col-lg-1">******</div><div class="col-lg-4">Incharge Percentage<br />------------------------------------------------</div><div class="col-lg-3"></div><div class="col-lg-4"></div>
                    </div>
                    <br /><br /><br />
                    <div class="col-sm-12">
                        <div class="portlet light bordered">
                            <div class="portlet box green-haze">
                                <div class="portlet-body">
                                    <div>
                                        <table class="table table-bordered table-striped table-condensed flip-content" id="tblInchargePercentage" style="overflow-y: auto;overflow-x: auto;width: 400px">
                                            <thead>
                                                <tr>
                                                    <th>Team Incentive</th>
                                                    <th>Head <br />Percentage</th>
                                                    <th>Month</th>
                                                    <th>Year</th>
                                                </tr>
                                            </thead>
                                            <tbody></tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                @if (TempData["Message71"] != null)
                {

                    var msgss = TempData["Message71"];

                    <div class="alert alert-danger alert-dismissable">
                        <button type="button" class="close" data-dismiss="alert" aria-hidden="true"></button>
                        <strong>Message:</strong> @msgss
                    </div>

                }
                @*<br />
                    <div class="row">
                        <div class="col-lg-12">
                            <div class="col-lg-1">******</div><div class="col-lg-4">Per PO Reward For PM Incharge<br />------------------------------------------------</div><div class="col-lg-3"></div><div class="col-lg-4"></div>
                        </div>
                        <br /><br /><br />
                        <div class="col-sm-12">
                            <div class="portlet light bordered">
                                <div class="portlet box green-haze">
                                    <div class="portlet-body">
                                        <div>
                                            <table class="table table-bordered table-striped table-condensed flip-content" id="tblPoReward" style="overflow-y: auto;overflow-x: auto;width: 400px">
                                                <thead>
                                                    <tr>
                                                        <th>Po Reward</th>
                                                        <th>EmployeeCode</th>
                                                        <th style="display:none">MonNum</th>
                                                        <th>Month</th>
                                                        <th>Year</th>
                                                        <th>Details</th>
                                                    </tr>
                                                </thead>
                                                <tbody></tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>*@
                <br />
                @*<div class="row">
                        <div class="col-lg-12">
                            <div class="col-lg-1">******</div><div class="col-lg-4">Ratio Wise PM Incharge Penalties<br />------------------------------------------------</div><div class="col-lg-3"></div><div class="col-lg-4"></div>
                        </div>
                        <br /><br /><br />
                        <div class="col-sm-12">
                            <div class="portlet light bordered">
                                <div class="portlet box green-haze">
                                    <div class="portlet-body">
                                        <div>
                                            <table class="table table-bordered table-striped table-condensed flip-content" id="tblPoPenalties" style="overflow-y: auto;overflow-x: auto;width: 400px">
                                                <thead>
                                                    <tr>
                                                        <th>Penalties</th>
                                                        <th>EmployeeCode</th>
                                                        <th style="display:none">MonNum</th>
                                                        <th>Month</th>
                                                        <th>Year</th>
                                                        <th>Details</th>
                                                    </tr>
                                                </thead>
                                                <tbody></tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>*@
                <div class="row">
                    <br />
                    <div class="col-lg-12">
                        <div class="col-lg-1">******</div><div class="col-lg-4">
                            Others<br />
                            -------------------
                        </div><div class="col-lg-3"></div><div class="col-lg-4"></div>
                    </div>
                    <br /><br /><br />
                    <div class="col-lg-12">
                        <div class="col-lg-4">
                            <div class="col-lg-3" style="color: brown;"> Others Type </div>
                            <div class="col-lg-9">
                                @Html.TextBoxFor(model => model.PmIncentiveModels.OthersType, new { @class = "form-control", disabled = "disabled" })

                            </div>
                        </div>
                        <div class="col-lg-4">
                            <div class="col-lg-4" style="color: brown;">Select Project</div>
                            <div class="col-lg-8">
                                @{
                                    Debug.Assert(@Model != null, "@Model != null");
                                }
                                @*@Html.DropDownListFor(model => model.ProjectMasterModel.ProjectMasterId, new SelectList(@Model.ProjectMasterModelsList, "ProjectMasterId", "ProjectName"), "SELECT PROJECT", new { @class = "dropForProjects form-control", Value = @Model.ProjectMasterModel.ProjectName })*@
                                @Html.DropDownListFor(model => model.ProjectMasterId, new SelectList(ViewBag.AllProjects1, "Value", "Text"), "SELECT PROJECT", new { @class = "dropForProject12 form-control ddChosen", @id = "projectIdForOthers" })
                            </div>
                        </div>
                        <div class="col-lg-4">
                            <label class="control-label col-lg-4" style="color: brown;">Added Amount</label>
                            <div class="col-lg-8">
                                @Html.TextBoxFor(model => model.PmIncentiveModels.Amount, new { @class = "form-control", @id = "othersAmount" })
                            </div>
                        </div>
                    </div>
                    <br /><br />
                    <div class="col-lg-12">
                        <div class="col-lg-4">
                            <label class="control-label col-lg-3" style="color: brown;">Remarks</label>
                            <div class="col-lg-9">
                                @Html.TextAreaFor(model => model.PmIncentiveModels.Remarks, new { @class = "form-control", @id = "othersRemarks" })
                            </div>
                        </div>
                        <div class="col-lg-4">
                            <label class="control-label col-lg-4" style="color: brown">Deduct Amount</label>
                            <div class="col-lg-8">
                                @Html.TextBoxFor(model => model.PmIncentiveModels.DeductionAmount, new { @class = "form-control", @id = "othersDeduct" })
                            </div>
                        </div>
                        <div class="col-lg-4">
                            <label class="control-label col-lg-4" style="color: brown">Deduct Remarks</label>
                            <div class="col-lg-8">
                                @Html.TextAreaFor(model => model.PmIncentiveModels.D_Remarks, new { @class = "form-control", @id = "others_D_Remarks" })
                            </div>
                        </div>
                    </div>
                    <br /><br /><br />
                    <div class="col-lg-12">
                        <div class="col-lg-4"></div>
                        <div class="col-lg-4">
                            <button id="btnAdd1" class="btn btn-lg blue m-icon-big"><i class="fa fa-plus-circle" aria-hidden="true"></i>Add</button>
                        </div>
                        <div class="col-lg-4"></div>

                    </div>
                    <br /><br /><br />
                </div>

                <br /><br /><br />
                @if (TempData["Message6"] != null)
                {

                    var msgss = TempData["Message6"];

                    <div class="alert alert-danger alert-dismissable">
                        <button type="button" class="close" data-dismiss="alert" aria-hidden="true"></button>
                        <strong>Message:</strong> @msgss
                    </div>


                }

                <br /><br />
                <div class="row">
                    <div class="col-sm-12">
                        <div class="portlet light bordered">
                            <div class="portlet box green-haze">
                                <div class="portlet-body">
                                    <div class="table-scrollable table-responsive" style="overflow-y: auto;overflow-x: auto">

                                        <table class="table table-bordered table-striped table-condensed flip-content" id="tbl5" style="overflow-y: auto;overflow-x: auto">
                                            <thead>
                                                <tr>
                                                    <th style="width: 100px;">Incentive Type</th>
                                                    <th>P_Name</th>
                                                    <th>EmpCode</th>
                                                    <th>Amount</th>
                                                    <th>Remarks</th>
                                                    <th>D_Amount</th>
                                                    <th>D_Remarks</th>
                                                    <th>F_Amount</th>
                                                    <th>Month</th>
                                                    <th>Year</th>
                                                    <th>Action</th>
                                                </tr>
                                            </thead>
                                            <tbody id="tBody5" class="tBody5" style="overflow-y: auto;overflow-x: auto">

                                                @foreach (var pmCusModel in Model.PmIncentiveModels.CustomPmIncentiveModels)
                                                {
                                                    Html.RenderPartial("~/Views/ProjectManager/Partial/_PmIncentiveOthersList.cshtml", pmCusModel);
                                                }

                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
               
                @*<div class="row">
                    <br />
                    <div class="col-lg-12">
                        <div class="col-lg-1">******</div><div class="col-lg-4">
                            Accessories Project<br />
                            -------------------
                        </div><div class="col-lg-3"></div><div class="col-lg-4"></div>
                    </div>
                    <br /><br /><br />

                    <div class="col-lg-12">
                        <div class="col-lg-4">
                            <div class="col-lg-3" style="color: brown;"> Type </div>
                            <div class="col-lg-9">

                                @Html.DropDownListFor(model => model.PmAccessoriesModel.IncentiveTypeForAccessories, new SelectList(new[]
                                {
                                    new SelectListItem { Text = "Select Type", Value = "", Selected = true },
                                    new SelectListItem { Text = "Charger", Value = "Charger"},
                                    new SelectListItem { Text = "Cable", Value = "Cable"},
                                    new SelectListItem { Text = "Battery", Value = "Battery"},
                                    new SelectListItem { Text = "Housing", Value = "Housing"},
                                    new SelectListItem { Text = "PCB", Value = "PCB"},
                                    new SelectListItem { Text = "EarPhone", Value = "EarPhone"}
                                }, "Value", "Text"), new { @class = "form-control" })
                                @Html.ValidationMessageFor(model => model.PmAccessoriesModel.IncentiveTypeForAccessories, String.Empty, new { @class = "required" })
                            </div>
                        </div>

                        <div class="col-lg-4">

                            <div class="col-lg-4" style="color: brown;">Select Project</div>
                            <div class="col-lg-8">

                                @{
                                    Debug.Assert(@Model != null, "@Model != null");
                                }

                                @Html.DropDownListFor(model => model.ProjectMasterId, new SelectList(ViewBag.AllProjects1, "Value", "Text"), "SELECT PROJECT", new { @class = "dropForProjectForAcc form-control ddChosen", @id = "projectIdForAccessories" })

                            </div>
                        </div>
                        <div class="col-lg-4">
                            <label class="control-label col-lg-4" style="color: brown;">Added Amount</label>
                            <div class="col-lg-8">
                                @Html.TextBoxFor(model => model.PmAccessoriesModel.Amount, new { @class = "form-control", @id = "accessoriesAmount", @Value = "5000", @disabled = "disabled" })
                            </div>
                        </div>
                    </div>
                    <br /><br />
                    <div class="col-lg-12">

                        <div class="col-lg-4">
                            <label class="control-label col-lg-3" style="color: brown;">Remarks</label>
                            <div class="col-lg-9">
                                @Html.TextAreaFor(model => model.PmAccessoriesModel.Remarks, new { @class = "form-control", @id = "accessoriesRemarks" })
                            </div>
                        </div>
                        <div class="col-lg-4">
                            <label class="control-label col-lg-4" style="color: brown">Deduct Amount</label>
                            <div class="col-lg-8">
                                @Html.TextBoxFor(model => model.PmAccessoriesModel.DeductionAmount, new { @class = "form-control", @id = "accessoriesDeduct", @type = "number", @min = "0", })
                            </div>
                        </div>
                        <div class="col-lg-4">
                            <label class="control-label col-lg-4" style="color: brown">Deduct Remarks</label>
                            <div class="col-lg-8">
                                @Html.TextAreaFor(model => model.PmAccessoriesModel.D_Remarks, new { @class = "form-control", @id = "accessories_D_Remarks" })
                            </div>
                        </div>
                    </div>
                    <br /><br /><br />
                    <div class="col-lg-12">
                        <div class="col-lg-4"></div>
                        <div class="col-lg-4">
                            <button id="btnAddForAccessories" class="btn btn-lg blue m-icon-big"><i class="fa fa-plus-circle" aria-hidden="true"></i>Add</button>
                        </div>
                        <div class="col-lg-4"></div>

                    </div>
                    <br /><br /><br />
                </div>
                <br /><br />
                <div class="row">
                    <div class="col-sm-12">
                        <div class="portlet light bordered">
                            <div class="portlet box green-haze">
                                <div class="portlet-body">
                                    <div class="table-scrollable table-responsive" style="overflow-y: auto;overflow-x: auto">

                                        <table class="table table-bordered table-striped table-condensed flip-content" id="tblForAccessories" style="overflow-y: auto;overflow-x: auto">
                                            <thead>
                                                <tr>
                                                    <th style="width: 100px;">Incentive Type</th>
                                                    <th>P_Name</th>
                                                    <th>EmpCode</th>
                                                    <th>Amount</th>
                                                    <th>Remarks</th>
                                                    <th>D_Amount</th>
                                                    <th>D_Remarks</th>
                                                    <th>F_Amount</th>
                                                    <th>Month</th>
                                                    <th>Year</th>
                                                    <th>Action</th>

                                                </tr>
                                            </thead>
                                            <tbody id="tbodyForAccess" class="tbodyForAccess" style="overflow-y: auto;overflow-x: auto">

                                                @foreach (var pmAccessModel in Model.PmAccessoriesModels)
                                                {
                                                    Html.RenderPartial("~/Views/ProjectManager/Partial/_PmIncentiveForAccessories.cshtml", pmAccessModel);
                                                }

                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <br /><br /><br />*@
                @*<div class="row">
                    <div class="col-lg-12"><div class="col-lg-1">******</div><div class="col-lg-4">Inventory Management & Market Issue Support<br />----------------------------------------------</div><div class="col-lg-3"></div><div class="col-lg-4"></div></div>
                    <br /><br /><br />
                    <div class="col-lg-12">
                        <div class="col-lg-1" style="color: brown;">  Select Type </div>
                        <div class="col-lg-3">

                            @if (Model != null && Model.PmIncentiveBaseModelsList.Any())
                            {

                                <div class="col-lg-12">
                                    @Html.DropDownListFor(model => model.PmIncentiveBaseModels.Id, new SelectList(ViewBag.IncentivesValue1, "Value", "Text"), "SELECT INCENTIVE TYPE", new { @class = "dropForIncentive1 form-control", @id = "pmIncentiveTypeForMarketIssue" })

                                </div>

                            }
                        </div>

                        <div class="col-lg-1">PersonNo.</div>
                        <div class="col-lg-1"><input class="form-control perPersonNo" id="perPersonNo" type="number" min="1" max="999" /></div>
                        <div class="col-lg-1"></div>
                        <div class="col-lg-2" style="color: brown;">Select Multi Project</div>
                        <div class="col-lg-3">

                            @{
                                Debug.Assert(@Model != null, "@Model != null");
                            }
                            @Html.DropDownListFor(model => model.ProjectMasterId, new SelectList(ViewBag.AllProjects, "Value", "Text"), new { @class = "dropForProject1 form-control", @id = "multiple", multiple = "multiple" })


                        </div>

                    </div>
                    <br /><br /><br /><br />
                    <div class="col-lg-12">
                        <div class="col-lg-1" style="color: brown;">  Remarks </div>
                        <div class="col-lg-3">

                            @Html.TextAreaFor(model => model.PmIncentiveModels.Remarks, new { @class = "form-control pmMarketIssueRemarks", @id = "pmMarketIssueRemarks" })
                        </div>

                        <div class="col-lg-1">Deduct Amount</div>
                        <div class="col-lg-1">@Html.TextBoxFor(model => model.PmIncentiveModels.DeductionAmount, new { @class = "form-control marketIssueDAmount", @id = "marketIssueDAmount" })</div>
                        <div class="col-lg-1"></div>
                        <div class="col-lg-2" style="color: brown;">Deduct Remarks</div>
                        <div class="col-lg-3">

                            @Html.TextBoxFor(model => model.PmIncentiveModels.D_Remarks, new { @class = "form-control marketIssueDRemarks", @id = "marketIssueDRemarks" })

                        </div>
                    </div>
                    <br /><br />
                    <br /><br />

                    <div class="col-lg-12">
                        <div class="col-lg-4"></div>
                        <div class="col-lg-4">
                            <button id="btnAdd2" class="btn btn-lg blue m-icon-big"><i class="fa fa-plus-circle" aria-hidden="true"></i>Add</button>
                        </div>
                        <div class="col-lg-4"></div>

                    </div>
                    <br /><br /><br />
                    <div class="col-sm-12">
                        <div class="portlet light bordered">
                            <div class="portlet box green-haze">
                                <div class="portlet-body">
                                    <div class="table-scrollable table-responsive" style="overflow-y: auto;overflow-x: auto">

                                        <table class="table table-bordered table-striped table-condensed flip-content" id="tbl4" style="overflow-y: auto;overflow-x: auto">
                                            <thead>
                                                <tr>
                                                    <th>Incentive Type</th>
                                                    <th>Multi_Project_Name</th>
                                                    <th>EmpCode</th>
                                                    <th>Amount</th>
                                                    <th>Remarks</th>
                                                    <th>D_Amount</th>
                                                    <th>D_Remarks</th>
                                                    <th>F_Amount</th>
                                                    <th>Month</th>
                                                    <th>Year</th>
                                                    <th>Action</th>

                                                </tr>
                                            </thead>
                                            <tbody id="tbody4" class="tbody4">

                                                @foreach (var pmCusModel in Model.PmIncentiveModels.CustomPmIncentiveModels)
                                                {
                                                    Html.RenderPartial("~/Views/ProjectManager/Partial/_PmIncentiveMarketIssue.cshtml", pmCusModel);
                                                }

                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>*@
                <br /><br /><br />
                <div class="row">
                    <div class="col-lg-12">
                        <div class="col-lg-1">******</div><div class="col-lg-4">Po 1st Order & Per repeat Order<br />------------------------------------------------</div><div class="col-lg-3"></div><div class="col-lg-4"></div>
                    </div>
                    <br /><br /><br />
                    <div class="col-sm-12">
                        <div class="portlet light bordered">
                            <div class="portlet box green-haze">
                                <div class="portlet-body">
                                    <div class="table-scrollable table-responsive" style="overflow-y: auto;overflow-x: auto">
                                        <table class="table table-bordered table-striped table-condensed flip-content" id="tbl2" style="overflow-y: auto;overflow-x: auto">
                                            <thead>
                                                <tr>
                                                    <th>Project Name</th>
                                                    <th>EmployeeCode</th>
                                                    <th>PoCategory</th>
                                                    <th>PoDate</th>
                                                    <th>PO No.</th>
                                                    <th>Amount</th>
                                                    <th>Remarks</th>
                                                    <th>DeductionAmount</th>
                                                    <th>Deduction Remarks</th>
                                                </tr>
                                            </thead>
                                            <tbody></tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
                <br /><br /><br />
                <div class="row">
                    <div class="col-lg-12">
                        <div class="col-lg-1">******</div><div class="col-lg-4">All Uploaded Document Incentive<br />------------------------------------------------</div><div class="col-lg-3"></div><div class="col-lg-4"></div>
                    </div>
                    <br /><br /><br />
                    <div class="col-sm-12">
                        <div class="portlet light bordered">
                            <div class="portlet box green-haze">
                                <div class="portlet-body">
                                    <div class="table-scrollable table-responsive" style="overflow-y: auto;overflow-x: auto">
                                        <table class="table table-bordered table-striped table-condensed flip-content tblDoc" id="tblDoc" style="overflow-y: auto;overflow-x: auto">
                                            <thead>
                                                <tr>
                                                    <th style="display:none">Project ID</th>
                                                    <th>Incentive<br /> Type</th>
                                                    <th>Project Name</th>
                                                    <th>Order</th>
                                                    <th>EmployeeCode</th>
                                                    <th>EffectiveMonth</th>
                                                    <th>AccessoriesType</th>
                                                    <th>Topic/Remarks</th>
                                                    <th>IsDocument<br /> Uploded?</th>
                                                    <th>Currency<br/>Type</th>
                                                    <th>Amount</th>
                                                    @*<th>DeductionAmount</th>
                                                      <th>Deduction Remarks</th>*@
                                                    <th>FinalAmount</th>
                                                </tr>
                                            </thead>
                                            <tbody></tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
                <br /><br /><br />
                @*<div class="row">
                    <div class="col-lg-12">
                        <div class="col-lg-1">******</div><div class="col-lg-4">Order wise Project Closing<br />------------------------------------------------</div><div class="col-lg-3"></div><div class="col-lg-4"></div>
                    </div>
                    <br /><br /><br />
                    <div class="col-sm-12">
                        <div class="portlet light bordered">
                            <div class="portlet box green-haze">
                                <div class="portlet-body">
                                    <div class="table-scrollable table-responsive" style="overflow-y: auto;overflow-x: auto">
                                        <table class="table table-bordered table-striped table-condensed flip-content tblProjectClosing" id="tblProjectClosing" style="overflow-y: auto;overflow-x: auto">
                                            <thead>
                                                <tr>
                                                    <th style="display:none">Project ID</th>
                                                    <th>Project Name</th>
                                                    <th>Order</th>
                                                    <th>Project Closing Date</th>
                                                    <th>EffectiveMonth/<br />Market Clearance Date</th>
                                                    <th>EmployeeCode</th>
                                                    <th>Amount</th>
                                                    <th>FinalAmount</th>
                                                </tr>
                                            </thead>
                                            <tbody></tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
                <br /><br /><br />*@
                <div class="row">
                    <div class="col-lg-12">
                        <div class="col-lg-1">******</div><div class="col-lg-4">Raw Material Upload delay Penalties<br />------------------------------------------------</div><div class="col-lg-3"></div><div class="col-lg-4"></div>
                    </div>
                    <br /><br /><br />
                    <div class="col-sm-12">
                        <div class="portlet light bordered">
                            <div class="portlet box green-haze">
                                <div class="portlet-body">
                                    <div class="table-scrollable table-responsive" style="overflow-y: auto;overflow-x: auto">
                                        <table class="table table-bordered table-striped table-condensed flip-content tblRawMaterialDelay" id="tblRawMaterialDelay" style="overflow-y: auto;overflow-x: auto">
                                            <thead>
                                                <tr>
                                                    <th style="display:none">Project ID</th>
                                                    <th>Project Name</th>
                                                    <th>Order</th>
                                                    <th>PoCategory</th>
                                                    <th>PoQuantity</th>
                                                    <th>Project Manager<br/> Clearance Date</th>
                                                    <th>Raw Material <br />Added Date</th>
                                                    <th>DaysPassed</th>
                                                    <th>EmployeeCode</th>
                                                    <th style="display: none">IncentiveName</th>
                                                    <th>Amount</th>
                                                    <th>FinalAmount</th>
                                                </tr>
                                            </thead>
                                            <tbody></tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
                
                <br /><br /><br />
                <div class="row">
                    <div class="col-lg-12">
                        <div class="col-lg-1">******</div><div class="col-lg-4">PM Shipment Clearance VS LSD<br />------------------------------------------------</div><div class="col-lg-3"></div><div class="col-lg-4"></div>
                    </div>
                    <br /><br /><br />
                    <div class="col-sm-12">
                        <div class="portlet light bordered">
                            <div class="portlet box green-haze">
                                <div class="portlet-body">
                                    <div class="table-scrollable table-responsive" style="overflow-y: auto;overflow-x: auto">
                                        <table class="table table-bordered table-striped table-condensed flip-content tblShipClearance" id="tblShipClearance" style="overflow-y: auto;overflow-x: auto">
                                            <thead>
                                                <tr>
                                                    <th style="display:none">Project ID</th>
                                                    <th>Project Name</th>
                                                    <th>Order</th>
                                                    <th>ProjectType</th>
                                                    <th>PoCategory</th>
                                                    <th>Project Manager<br /> Clearance Date</th>
                                                    <th>LSD</th>
                                                    <th>DaysBeforeLsd</th>
                                                    <th>DaysAfterLsd</th>
                                                    <th>Reward</th>
                                                    <th>RealPenalties</th>
                                                    <th>Penalties</th>
                                                    <th>EmployeeCode</th>
                                                    <th>Amount</th>
                                                    <th>FinalAmount</th>
                                                </tr>
                                            </thead>
                                            <tbody></tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>

                @*Shipment All data--------Old Policy Upto Sept 2019</div>*@
                @*<div class="row">
                        <div class="col-lg-12">
                            <div class="col-lg-1">******</div><div class="col-lg-4">Shipment All data<br />------------------------------------------------</div><div class="col-lg-3"></div><div class="col-lg-4"></div>
                        </div>
                        <br /><br /><br />
                        <div class="col-sm-12">
                            <div class="portlet light bordered">
                                <div class="portlet box green-haze">
                                    <div class="portlet-body">
                                        <div class="table-scrollable table-responsive" style="overflow-y: auto;overflow-x: auto">
                                            <table class="table table-bordered table-striped table-condensed flip-content" id="tbl3" style="overflow-y: auto;overflow-x: auto">
                                                <thead>
                                                    <tr>
                                                        <th>Project Name</th>
                                                        <th>EmployeeCode</th>
                                                        <th>Project Type</th>
                                                        <th>LSD</th>
                                                        <th>Shipment Taken</th>
                                                        <th>NoOfdays</th>
                                                        <th>OrderNo.</th>
                                                        <th>Amount</th>
                                                        <th>Remarks</th>
                                                        <th>DeductionAmount</th>
                                                        <th>Deduction Remarks</th>
                                                        <th>Final</th>
                                                    </tr>
                                                </thead>
                                                <tbody></tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>*@
                @*<br /><br /><br />
                <div class="row">
                    <div class="col-lg-12">
                        <div class="col-lg-1">******</div><div class="col-lg-4">Pi Closing & Final Closing<br />------------------------------------------------</div><div class="col-lg-3"></div><div class="col-lg-4"></div>
                    </div>
                    <br /><br /><br />
                    <div class="col-sm-12">
                        <div class="portlet light bordered">
                            <div class="portlet box green-haze">
                                <div class="portlet-body">
                                    <div class="table-scrollable table-responsive" style="overflow-y: auto;overflow-x: auto">
                                        <table class="table table-bordered table-striped table-condensed flip-content" id="tblForPi" style="overflow-y: auto;overflow-x: auto">
                                            <thead>
                                                <tr>
                                                    <th>Project Name</th>
                                                    <th>EmployeeCode</th>
                                                    <th>PoCategory</th>
                                                    <th>PoDate</th>
                                                    <th>PO No.</th>
                                                    <th>Closing Month</th>
                                                    <th>Closing Date</th>
                                                    <th>ClosingType</th>
                                                    <th>Amount</th>
                                                    <th>Remarks</th>
                                                    <th>DeductionAmount</th>
                                                    <th>Deduction Remarks</th>
                                                </tr>
                                            </thead>
                                            <tbody></tbody>

                                        </table>

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>*@

                <br /><br /><br />
                <div class="row">
                    <div class="col-lg-12">
                        <div class="col-lg-1">******</div><div class="col-lg-4">95% of any Model Production Reward<br />------------------------------------------------</div><div class="col-lg-3"></div><div class="col-lg-4"></div>
                    </div>
                    <br /><br /><br />
                    <div class="col-sm-12">
                        <div class="portlet light bordered">
                            <div class="portlet box green-haze">
                                <div class="portlet-body">
                                    <div class="table-scrollable table-responsive" style="overflow-y: auto;overflow-x: auto">
                                        <table class="table table-bordered table-striped table-condensed flip-content" id="tblProduction" style="overflow-y: auto;overflow-x: auto">
                                            <thead>
                                                <tr>
                                                    <th style="display: none;">ProjectID</th>
                                                    <th>Project Name</th>
                                                    <th>Employee<br />Code</th>
                                                    <th style="display: none;">UserFullName</th>
                                                    <th>Sourcing<br />Type</th>
                                                    <th>Order</th>
                                                    <th>Warehouse<br />EntryDate</th>
                                                    <th style="display: none;">Extended Warehouse<br />EntryDate</th>
                                                    <th style="display: none;">ProjectManagerUserId</th>
                                                    <th>Order<br />Quantity</th>
                                                    <th>Total<br />Production<br />Quantity</th>
                                                    <th>Effective<br />Days</th>
                                                    <th>Reward<br /> Percentage</th>
                                                    <th>Existed<br /> Percentage</th>
                                                    <th>Reward<br /> Amount</th>
                                                    <th>Deduct<br /> Amount</th>
                                                </tr>
                                            </thead>
                                            <tbody></tbody>

                                        </table>

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>

                @*<br /><br /><br />
                    <div class="row">
                        <div class="col-lg-12">
                            <div class="col-lg-1">******</div><div class="col-lg-4">95% of a Lot(Model Wise) Sales Out<br />------------------------------------------------</div><div class="col-lg-3"></div><div class="col-lg-4"></div>
                        </div>
                        <br /><br /><br />
                        <div class="col-sm-12">
                            <div class="portlet light bordered">
                                <div class="portlet box green-haze">
                                    <div class="portlet-body">
                                        <div class="table-scrollable table-responsive" style="overflow-y: auto;overflow-x: auto">
                                            <table class="table table-bordered table-striped table-condensed flip-content" id="tblSalesOut" style="overflow-y: auto;overflow-x: auto">
                                                <thead>
                                                    <tr>
                                                        <th style="display: none;">ProjectID</th>
                                                        <th>Project Name</th>
                                                        <th>Employee<br />Code</th>
                                                        <th style="display: none;">UserFullName</th>
                                                        <th>Order</th>
                                                        <th>Warehouse<br />EntryDate</th>
                                                        <th style="display: none;">Extended Warehouse<br />EntryDate</th>
                                                        <th style="display: none;">ProjectManagerUserId</th>
                                                        <th>Effective<br />Days</th>
                                                        <th>Order<br />Quantity</th>
                                                        <th style="display: none;">Total<br />TblBarcodeIMEI</th>
                                                        <th>Total<br />SalesOut</th>
                                                        <th>Reward<br /> Percentage</th>
                                                        <th>Existed<br /> Percentage</th>
                                                        <th>Reward<br /> Amount</th>
                                                        <th>Deduct<br /> Amount</th>
                                                    </tr>
                                                </thead>
                                                <tbody></tbody>

                                            </table>

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>*@

                @*<br /><br /><br />
                    <div class="row">
                        <div class="col-lg-12">
                            <div class="col-lg-1">******</div><div class="col-lg-4">PoDate--->LSD--->VesselDate Reward/Penalties<br />------------------------------------------------</div><div class="col-lg-3"></div><div class="col-lg-4"></div>
                        </div>
                        <br /><br /><br />
                        <div class="col-sm-12">
                            <div class="portlet light bordered">
                                <div class="portlet box green-haze">
                                    <div class="portlet-body">
                                        <div class="table-scrollable table-responsive" style="overflow-y: auto;overflow-x: auto">
                                            <table class="table table-bordered table-striped table-condensed flip-content" id="tblVessel" style="overflow-y: auto;overflow-x: auto">
                                                <thead>
                                                    <tr>
                                                        <th style="display: none;">ProjectID</th>
                                                        <th>Project Name</th>
                                                        <th>Employee<br />Code</th>
                                                        <th style="display: none;">UserFullName</th>
                                                        <th style="display: none;">ProjectManagerUserId</th>
                                                        <th>ProjectType</th>
                                                        <th>Order</th>
                                                        <th>PoDate</th>
                                                        <th>LSD</th>
                                                        <th>Po Vs LSD<br />Diff</th>
                                                        <th>VesselDate</th>
                                                        <th>Lsd Vs Vesel <br />Diff For <br />Deduct</th>
                                                        <th>DeductPoint</th>
                                                        <th>Deducted<br />Amount</th>
                                                        <th>LSD Vs Vessel<br />DiffForReward</th>
                                                        <th>Reward<br />Point</th>
                                                        <th>Reward<br /> Amount</th>
                                                    </tr>
                                                </thead>
                                                <tbody></tbody>

                                            </table>

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>*@
                <br />
                <br /><br />
                <div class="row">
                    <div class="col-md-12">
                        <!-- BEGIN EXAMPLE TABLE PORTLET-->
                        <div class="portlet light bordered">
                            <div class="portlet-title">
                                <div class="col-lg-12">
                                    <div class="caption font-dark">
                                        <i class="icon-settings font-dark"></i>
                                        <span class="caption-subject bold uppercase" style="color: red">Final Incentive</span>
                                    </div>
                                    <div class="tools"> </div>
                                </div>
                            </div>
                            <div class="portlet-body">
                                <br />
                                <div class="col-lg-12">
                                    <div class="col-lg-1">******</div><div class="col-lg-4">
                                        Total Incentive<br />
                                        -------------------
                                    </div><div class="col-lg-3"></div><div class="col-lg-4"></div>
                                </div>
                                <br /><br /><br />
                                <div class="col-lg-12">
                                    <div class="col-lg-4">
                                        <div class="col-lg-6" style="color: brown;"> Generated Incentive </div>
                                        <div class="col-lg-6">
                                            @Html.TextBoxFor(model => model.SwQcOthersIncentiveModelTotal.FinalIssueAmount, new { @class = "form-control FinalIssueAmount", @id = "FinalIssueAmount", disabled = "disabled" })
                                        </div>
                                    </div>
                                    <div class="col-lg-4">
                                        <div class="col-lg-6" style="color: brown;"> Total Deduction </div>
                                        @*<input style="display:none" id="dAmounts" value="" />*@
                                        <div class="col-lg-6">
                                            @Html.TextBoxFor(model => model.SwQcOthersIncentiveModelTotal.Deduction, new { @class = "form-control Deduction", @id = "Deduction", disabled = "disabled" })
                                        </div>
                                    </div>
                                    <div class="col-lg-4"></div>
                                </div>
                                <br /><br />
                                <div class="col-lg-12">
                                    <div class="col-lg-4">
                                        <div class="col-lg-4" style="color: brown;"> Total Incentive </div>
                                        <div class="col-lg-8">
                                            @Html.TextBoxFor(model => model.SwQcOthersIncentiveModelTotal.FinalTotalAmount, new { @class = "form-control FinalTotalAmount", @id = "FinalTotalAmount", disabled = "disabled" })

                                        </div>
                                    </div>
                                    <div class="col-lg-4">
                                        @*<label class="control-label col-lg-4" style="color: brown">Added Amount</label>
                                            <div class="col-lg-8">
                                                @Html.TextBoxFor(model => model.SwQcOthersIncentiveModelTotal.FinalAddedAmount, new { @class = "form-control", @id = "FinalAddedAmount", @type = "number", onchange = "FinalAddedAmountChange()" })
                                            </div>*@
                                    </div>

                                    <div class="col-lg-4">

                                        @*<label class="control-label col-lg-4" style="color: brown">Added Remarks</label>
                                            <div class="col-lg-8">
                                                @Html.TextBoxFor(model => model.SwQcOthersIncentiveModelTotal.FinalAddedRemarks, new { @class = "form-control", @id = "FinalAddedRemarks" })
                                            </div>*@
                                    </div>
                                </div>
                                <br /><br />
                                <div class="col-lg-12">
                                    <div class="col-lg-4">

                                        @*<div class="col-lg-4" style="color: brown;">Deduction</div>
                                            <div class="col-lg-8">
                                                @Html.TextBoxFor(model => model.SwQcOthersIncentiveModelTotal.FinalDeduction, new { @class = "form-control FinalDeduction", @id = "FinalDeduction", @type = "number", onchange = "FinalDeductionChange()" })


                                            </div>*@

                                    </div>
                                    <div class="col-lg-4">
                                        @*<label class="control-label col-lg-4" style="color: brown">Deduction Remarks</label>
                                            <div class="col-lg-8">
                                                @Html.TextBoxFor(model => model.SwQcOthersIncentiveModelTotal.FinalDeductionRemarks, new { @class = "form-control", @id = "FinalDeductionRemarks" })
                                            </div>*@
                                    </div>
                                    <div class="col-lg-4">
                                        @*<label class="control-label col-lg-4" style="color: brown">Final Incentive</label>
                                            <div class="col-lg-8">
                                                @Html.TextBoxFor(model => model.SwQcOthersIncentiveModelTotal.FinalIncentive, new { @class = "form-control", @id = "FinalIncentive", disabled = "disabled" })
                                            </div>*@
                                    </div>

                                </div>
                                <br /><br />
                            </div>
                        </div>
                        <!-- END EXAMPLE TABLE PORTLET-->
                        <!-- BEGIN EXAMPLE TABLE PORTLET-->
                    </div>

                </div>
                <br />
                <div class="form-actions">
                    <div class="row">
                        <div class="col-md-6">
                            <input class="btn sbold uppercase btn-outline blue" type="submit" id="btnSave" value="Save" onchange="winLoads()" />
                        </div>
                        @*<div class="col-md-6">
                                <input class="btn sbold uppercase btn-outline red" type="submit" id="btnPrint" value="Print" />
                            </div>*@
                    </div>
                </div>
                <div>
                </div>

            </div>
        </div>
    </div>
</div>


<script>
    $(function () {
        $("body:first").addClass("page-sidebar-closed");
        $("ul.page-sidebar-menu").addClass("page-sidebar-menu-closed");
    });
    var AllFinalAmount = 0;
    var AllPenalties = 0;
    $(function () {
        $('#multiple').chosen({
            disable_search_threshold: 10,
            no_results_text: "Oops, nothing found!",
            placeholder: "SELECT MULTI PROJECT",
            width: "95%"
        });

        @*$("#btnPrint").on('click', function (e) {
            e.preventDefault();
            var monthName = $('#DDDMonth option:selected').text();
            var monthNum = $('#DDDMonth option:selected').val();
            var yearName = $('#DDDYear option:selected').text();
            var personEmpName = $('#sltPerson option:selected').text();
            console.log("personEmpName  :" + personEmpName);

            var personEmpCode = $('#sltPerson option:selected').val();
            console.log("personEmpCode  :" + personEmpCode);

            if (monthName == "SELECT MONTH") {

                alertify.dialog('alert').set({
                    'title': '   ',
                    'transition': 'zoom',
                    'message': "Please must select Month",
                }).show();
                return false;
            }
            if (yearName == "SELECT YEAR") {

                alertify.dialog('alert').set({
                    'title': '   ',
                    'transition': 'zoom',
                    'message': "Please must select Year",
                }).show();
                return false;
            }

            window.open('@Url.Action("PmIncentiveReportPerPerson", "ProjectManager")' + '?EmpCode=' + personEmpCode + '&Month=' + monthName + '&MonNum=' + monthNum + '&Year=' + yearName + '&Name=' + personEmpName);
        });*@

        @*$("#btnAdd2").on('click', function (e) {

            e.preventDefault();
            var incentiveTypeAndAmount = $('#pmIncentiveTypeForMarketIssue option:selected').text();
            console.log("incentiveTypeAndAmount  :" + incentiveTypeAndAmount);

            var incentiveTypeAndAmountSplit = incentiveTypeAndAmount.split('-');
            //alert(incentiveTypeAndAmountSplit);
            var incentiveType = incentiveTypeAndAmountSplit[0];
            var incentiveAmount = incentiveTypeAndAmountSplit[1];
            console.log("incentiveType---" + incentiveType);
            console.log("incentiveAmount---" + incentiveAmount);

            var incentiveId = $('#pmIncentiveTypeForMarketIssue option:selected').val();
            console.log("incentiveId  :" + incentiveId);

            var personEmpName = $('#sltPerson option:selected').text();
            console.log("personEmpName  :" + personEmpName);

            var personEmpCode = $('#sltPerson option:selected').val();
            console.log("personEmpCode  :" + personEmpCode);
            var perPersonNo = $('#perPersonNo').val();
            console.log("perPersonNo :" + perPersonNo);
            var multiProjectName = $('#multiple option:selected').text();
            console.log("projectName  :" + multiProjectName);

            var multiprojectIds = $('#multiple').val();
            console.log("projectMasterId  :" + multiprojectIds);

            var monName = $('#DDDMonth option:selected').text();
            var monId = $('#DDDMonth option:selected').val();
            console.log(monName);
            console.log(monId);

            var yearName = $('#DDDYear option:selected').text();
            var yearId = $('#DDDYear option:selected').val();
            console.log(yearName);
            console.log(yearId);

            if (perPersonNo == "") {

                alertify.dialog('alert').set({
                    'title': '   ',
                    'transition': 'zoom',
                    'message': "Please must put PersonNo.",
                }).show();
                return false;
            }
            if (monName == "SELECT MONTH") {

                alertify.dialog('alert').set({
                    'title': '   ',
                    'transition': 'zoom',
                    'message': "Please must select Month",
                }).show();
                return false;
            }
            if (yearName == "SELECT YEAR") {

                alertify.dialog('alert').set({
                    'title': '   ',
                    'transition': 'zoom',
                    'message': "Please must select Year",
                }).show();
                return false;
            }

            if (personEmpName == "SELECT PERSON") {

                alertify.dialog('alert').set({
                    'title': '   ',
                    'transition': 'zoom',
                    'message': "Please must select Person",
                }).show();
                return false;
            }
            var remarks = $('#pmMarketIssueRemarks').val();
            console.log(remarks);

            var deductAmount = $('#marketIssueDAmount').val();
            console.log(deductAmount);

            var d_remarks = $('#marketIssueDRemarks').val();
            console.log(d_remarks);


            var finalAmount = (incentiveTypeAndAmountSplit[1] / perPersonNo) - deductAmount;
            console.log("finalAmount :" + finalAmount);

            $.post('@Url.Action("AddProjectForMarketIssue", "ProjectManager")', {
                incentiveType: incentiveType, incentiveAmount: incentiveAmount, incentiveId: incentiveId, personEmpCode: personEmpCode, multiProjectName: multiProjectName,
                multiprojectIds: multiprojectIds, monName: monName, monId: monId, yearName: yearName,
                yearId: yearId, remarks: remarks, deductAmount: deductAmount, d_remarks: d_remarks, finalAmount: (incentiveTypeAndAmountSplit[1] / perPersonNo) - deductAmount, perPersonNo: perPersonNo
            }, function (data) {
                console.log(data);
                $('#tbody4').append(data);
                //Add incentive
                //var final_Am_Id1 = $.trim($('#tbl4').find('td:eq(11)').text());
                var final_Am_Id1 = +finalAmount;
                console.log("incentive :" + final_Am_Id1);
                AllFinalAmount += +final_Am_Id1;
                $('#FinalIssueAmount').val(AllFinalAmount.toFixed(2));
                $('#FinalTotalAmount').val(+$('#FinalIssueAmount').val());

                //$('#FinalIncentive').val(+$('#FinalIssueAmount').val() + +$('#Deduction').val());

                //end add incentive
            });

            $('#perPersonNo').val("");
            $('#pmMarketIssueRemarks').val("");
            $('#marketIssueDAmount').val("");
            $('#marketIssueDRemarks').val("");
        });*@

        @*$("#btnAddForAccessories").on('click', function (e) {

            e.preventDefault();
            var incentiveTypeAccessories = $('#PmAccessoriesModel_IncentiveTypeForAccessories option:selected').text();
            console.log("incentiveTypeAccessories  :" + incentiveTypeAccessories);

            var projectName1 = $('#projectIdForAccessories option:selected').text();
            console.log("projectName1  :" + projectName1);
            var projectNameSplit = projectName1.split('(');
            var projectName = projectNameSplit[0];
            console.log("projectName---" + projectName);

            var projectMasterId = $('#projectIdForAccessories option:selected').val();
            console.log("projectMasterId  :" + projectMasterId);

            var personEmpName = $('#sltPerson option:selected').text();
            console.log("personEmpName  :" + personEmpName);

            var personEmpCode = $('#sltPerson option:selected').val();
            console.log("personEmpCode  :" + personEmpCode);

            var monName = $('#DDDMonth option:selected').text();
            var monId = $('#DDDMonth option:selected').val();
            console.log(monName);
            console.log(monId);

            var yearName = $('#DDDYear option:selected').text();
            var yearId = $('#DDDYear option:selected').val();
            console.log(yearName);
            console.log(yearId);

            if (monName == "SELECT MONTH") {

                alertify.dialog('alert').set({
                    'title': '   ',
                    'transition': 'zoom',
                    'message': "Please must select Month",
                }).show();
                return false;
            }
            if (yearName == "SELECT YEAR") {

                alertify.dialog('alert').set({
                    'title': '   ',
                    'transition': 'zoom',
                    'message': "Please must select Year",
                }).show();
                return false;
            }

            if (personEmpName == "SELECT PERSON") {

                alertify.dialog('alert').set({
                    'title': '   ',
                    'transition': 'zoom',
                    'message': "Please must select Person",
                }).show();
                return false;
            }
            var accessoriesAmount = $('#accessoriesAmount').val();
            var remarks = $('#accessoriesRemarks').val();
            console.log(remarks);

            var deductAmount = $('#accessoriesDeduct').val();
            console.log(deductAmount);

            var d_remarks = $('#accessories_D_Remarks').val();
            console.log(d_remarks);


            var finalAmount = accessoriesAmount - deductAmount;
            console.log("finalAmount :" + finalAmount);

            $.post('@Url.Action("AddProjectFoAccessories", "ProjectManager")', {
                incentiveTypeAccessories: incentiveTypeAccessories,
                projectName: projectName,
                projectMasterId: projectMasterId,
                personEmpCode: personEmpCode,
                accessoriesAmount: accessoriesAmount,
                remarks: remarks,
                deductAmount: deductAmount,
                d_remarks: d_remarks,
                finalAmount: accessoriesAmount - deductAmount,
                monName: monName,
                monId: monId,
                yearName: yearName,
                yearId: yearId,
            }, function (data) {
                console.log(data);
                $('#tbodyForAccess').append(data);
                //Add incentive
                //var final_Am_Id1 = $.trim($('#tblForAccessories').find('td:eq(9)').text());
                var final_Am_Id1 = +finalAmount;
                console.log("incentive :" + final_Am_Id1);
                AllFinalAmount += +final_Am_Id1;
                $('#FinalIssueAmount').val(AllFinalAmount.toFixed(2));
                $('#FinalTotalAmount').val(+$('#FinalIssueAmount').val());
                // $('#FinalIncentive').val(+$('#FinalIssueAmount').val() + +$('#Deduction').val());
                //end add incentive
            });

            $('#accessoriesRemarks').val("");
            $('#accessoriesDeduct').val("");
            $('#accessories_D_Remarks').val("");

        });*@


        $("#btnSave").on('click', function (e) {
            e.preventDefault();

            var issueVal = "";
            var productionVal = "";
            var salesOutVal = "";
            var vesselVal = "";
            var marketVal = "";
            var poVal = "";
            var docVal = "";
            var rawVal = "";
            var shipClrVal = "";
           // var projectClsVal = "";
            var accessVal = "";
            var othersVal = "";
            var piVal = "";
            // var shipVal = "";
            var poRewardVal = "";
            var poPenaltiesVal = "";
          
            
            var obj = {};
            var objArr = [];

            var monthName = $('#DDDMonth option:selected').text();
            var monthNum = $('#DDDMonth option:selected').val();
            var yearName = $('#DDDYear option:selected').text();


            if (monthName == "SELECT MONTH") {

                alertify.dialog('alert').set({
                    'title': '   ',
                    'transition': 'zoom',
                    'message': "Please must select Month",
                }).show();
                return false;
            }
            if (yearName == "SELECT YEAR") {

                alertify.dialog('alert').set({
                    'title': '   ',
                    'transition': 'zoom',
                    'message': "Please must select Year",
                }).show();
                return false;
            }



            var projectId;
            var pm_Incentive_Base_Id;
            var monNum;
            var proName;
            var employeeCode;
            var amount;
            var remarks;
            var deductionAmount;
            var d_Remarks;
            var finalAmount;
            var month;
            var year;


            $("#tbl tr.tableTrCls1").each(function () {
                obj = new Object();

                projectId = $.trim($(this).find('td:eq(0)').text());
                pm_Incentive_Base_Id = $.trim($(this).find('td:eq(1)').text());
                monNum = $.trim($(this).find('td:eq(2)').text());
                proName = $.trim($(this).find('td:eq(4)').text());
                console.log("proName---->" + proName);

                employeeCode = $.trim($(this).find('td:eq(5)').text());
                amount = $.trim($(this).find('td:eq(6)').text());
                remarks = $.trim($(this).find('td:eq(7)').text());
                deductionAmount = $.trim($(this).find('td:eq(8)').text());
                d_Remarks = $.trim($(this).find('td:eq(9)').text());
                finalAmount = $.trim($(this).find('td:eq(10)').text());
                month = $.trim($(this).find('td:eq(11)').text());
                year = $.trim($(this).find('td:eq(12)').text());

                obj.ProjectId = projectId;
                obj.Pm_Incentive_Base_Id = pm_Incentive_Base_Id;
                obj.MonNum = monNum;
                obj.ProjectName = proName;
                obj.EmployeeCode = employeeCode;
                obj.Amount = amount;
                obj.Remarks = remarks;
                if (deductionAmount == undefined || deductionAmount == "" || deductionAmount == null) {
                    obj.DeductionAmount = 0;
                }
                else {
                    obj.DeductionAmount = deductionAmount;
                }
                obj.FinalAmount = finalAmount;
                obj.D_Remarks = d_Remarks;


                obj.Month = monthName;
                obj.Year = yearName;
                obj.MonNum = monthNum;

                objArr.push(obj);

                console.log(" obj.proName---->" + obj.ProjectName);
                console.log("objArr---->" + objArr);

            });

            $.ajax({
                type: 'POST',
                url: '@Url.Action("PmMonthlyIncentive", "ProjectManager")',
                data: "{objArr:'" + JSON.stringify(objArr) + "'}",
                contentType: "application/json; charset=utf-8",
                dataType: 'json',
                async: false,
                success: function (data) {
                    issueVal = "yes";
                    if (!data.success) {
                        if (data.errors.name) {
                            //  $('.throw_error').fadeIn(1000).html(data.errors.name);
                        }
                    }
                    else {
                        //  $('#success').fadeIn(1000).append('<p>' + data.posted + '</p>');
                    }
                }
            });
            @*var poRewardObj = {};
            var poRewardObjArr = [];


            var poRewardEmployeeCode;
            var poRewardMonth;
            var poRewardYear;
            var poRewardMonNum;

            $("#tblPoReward tr.tableTrCls2").each(function () {
                poRewardObj = new Object();

                poRewardEmployeeCode = $.trim($(this).find('td:eq(1)').text());
                poRewardMonth = $('#DDDMonth option:selected').text();
                poRewardMonNum = $('#DDDMonth option:selected').val();
                poRewardYear = $('#DDDYear option:selected').val();

                poRewardObj.EmployeeCode = poRewardEmployeeCode;
                poRewardObj.Month = poRewardMonth;
                poRewardObj.MonNum = poRewardMonNum;
                poRewardObj.Year = poRewardYear;

                poRewardObjArr.push(poRewardObj);
            });

            $.ajax({
                type: 'POST',
                url: '@Url.Action("SavePoDetailsPageForPmHead", "ProjectManager")',
                data: "{poRewardObjArr:'" + JSON.stringify(poRewardObjArr) + "'}",
                contentType: "application/json; charset=utf-8",
                dataType: 'json',
                async: false,
                success: function (data) {
                    poRewardVal = "yes";
                    if (!data.success) {
                        if (data.errors.name) {
                            //  $('.throw_error').fadeIn(1000).html(data.errors.name);
                        }
                    }
                    else {
                        //  $('#success').fadeIn(1000).append('<p>' + data.posted + '</p>');
                    }
                }
            });*@
            @*var poPenaltiesObj = {};
            var poPenaltiesObjArr = [];

            var poPenaltiesEmployeeCode;
            var poPenaltiesMonth;
            var poPenaltiesYear;
            var poPenaltiesMonNum;

            $("#tblPoPenalties tr.tableTrCls2").each(function () {
                poPenaltiesObj = new Object();

                poPenaltiesEmployeeCode = $.trim($(this).find('td:eq(1)').text());
                poPenaltiesMonth = $('#DDDMonth option:selected').text();
                poPenaltiesMonNum = $('#DDDMonth option:selected').val();
                poPenaltiesYear = $('#DDDYear option:selected').val();

                poPenaltiesObj.EmployeeCode = poPenaltiesEmployeeCode;
                poPenaltiesObj.Month = poPenaltiesMonth;
                poPenaltiesObj.MonNum = poPenaltiesMonNum;
                poPenaltiesObj.Year = poPenaltiesYear;

                poPenaltiesObjArr.push(poPenaltiesObj);
            });

            $.ajax({
                type: 'POST',
                url: '@Url.Action("SavePenaltiesDetailsPageForPmHead", "ProjectManager")',
                data: "{poPenaltiesObjArr:'" + JSON.stringify(poPenaltiesObjArr) + "'}",
                contentType: "application/json; charset=utf-8",
                dataType: 'json',
                async: false,
                success: function (data) {
                    poPenaltiesVal = "yes";
                    if (!data.success) {
                        if (data.errors.name) {
                            //  $('.throw_error').fadeIn(1000).html(data.errors.name);
                        }
                    }
                    else {
                        //  $('#success').fadeIn(1000).append('<p>' + data.posted + '</p>');
                    }
                }
            });*@
            ///up/Uploded document/////
            var inChrgObj = {};
            var inChrgObjArr = [];

            var teamIns;
            var headPercentage;
            var empCodes;

            var inChrgMonth;
            var inChrgYear;
            var inChrgMonNum;
           
            $("#tblInchargePercentage tr.tableTrCls2").each(function () {
                inChrgObj = new Object();

                teamIns = $.trim($(this).find('td:eq(0)').text());
                headPercentage = $.trim($(this).find('td:eq(1)').text());
                
                empCodes = $('#sltPerson option:selected').val();
                inChrgMonth = $('#DDDMonth option:selected').text();
                inChrgMonNum = $('#DDDMonth option:selected').val();
                inChrgYear = $('#DDDYear option:selected').val();

                inChrgObj.TeamIncentive = teamIns;
                inChrgObj.InchargePecentage = headPercentage;
                inChrgObj.EmployeeCode = empCodes;
               
                inChrgObj.Month = inChrgMonth;
                inChrgObj.MonNum = inChrgMonNum;
                inChrgObj.Year = inChrgYear;

                inChrgObjArr.push(inChrgObj);
            });

            $.ajax({
                type: 'POST',
                url: '@Url.Action("SaveHeadTeamIncentivePercentage", "ProjectManager")',
                data: "{inChrgObjArr:'" + JSON.stringify(inChrgObjArr) + "'}",
                contentType: "application/json; charset=utf-8",
                dataType: 'json',
                async: false,
                success: function (data) {
                   // headVal = "yes";
                    if (!data.success) {
                        if (data.errors.name) {
                            //  $('.throw_error').fadeIn(1000).html(data.errors.name);
                        }
                    }
                    else {
                        //  $('#success').fadeIn(1000).append('<p>' + data.posted + '</p>');
                    }
                }
            });

            //incharge
            var poObj = {};
            var poObjArr = [];

            var poProjectId;
            var poProName;
            var poEmployeeCode;
            var poPoCategory;
            var poPoDate;
            var poOrderNumber;
            var poAmount;
            var poRemarks;
            var poDeductionAmount;
            var poDRemarks;
            var poFinalAmount;
            var poMonth;
            var poYear;
            var poMonNum;
            var poProjectManagerUserId;
            var poProjectType;

            $("#tbl2 tr.tableTrCls2").each(function () {
                poObj = new Object();

                poProName = $.trim($(this).find('td:eq(0)').text());
                console.log("poProName---->" + poProName);
                poProjectId = $.trim($(this).find('td:eq(1)').text());
                poEmployeeCode = $.trim($(this).find('td:eq(2)').text());
                poPoCategory = $.trim($(this).find('td:eq(3)').text());
                poPoDate = $.trim($(this).find('td:eq(4)').text());
                poOrderNumber = $.trim($(this).find('td:eq(5)').text());
                poAmount = $.trim($(this).find('td:eq(6)').text());
                poProjectManagerUserId = $.trim($(this).find('td:eq(7)').text());
                poProjectType = $.trim($(this).find('td:eq(8)').text());
                poRemarks = $.trim($(this).find('#po_Remarks').val());

                poDeductionAmount = $.trim($(this).find('#po_D_Amount').val());
                poDRemarks = $.trim($(this).find('#po_D_Remarks').val());
                poMonth = $('#DDDMonth option:selected').text();
                poMonNum = $('#DDDMonth option:selected').val();
                poYear = $('#DDDYear option:selected').val();


                poObj.ProjectName = poProName;
                poObj.ProjectId = poProjectId;
                poObj.EmployeeCode = poEmployeeCode;
                poObj.PoCategory = poPoCategory;
                poObj.PoDate = poPoDate;
                poObj.OrderNumber = poOrderNumber;
                poObj.Amount = poAmount;
                poObj.Remarks = poRemarks;

                if (poDeductionAmount == undefined || poDeductionAmount == "" || poDeductionAmount == null) {
                    poObj.DeductionAmount = 0;
                }
                else {
                    poObj.DeductionAmount = poDeductionAmount;
                }
                poObj.D_Remarks = poDRemarks;
                //if (poObj.DeductionAmount != undefined && poObj.D_Remarks == "") {

                //    alertify.dialog('alert').set({
                //        'title': '   ',
                //        'transition': 'zoom',
                //        'message': "Please must put Deduction Remarks",
                //    }).show();
                //    return false;
                //}
                poObj.FinalAmount = $.trim($(this).find('td:eq(6)').text()) - $.trim($(this).find('#po_D_Amount').val());
                poObj.Month = poMonth;
                poObj.MonNum = poMonNum;
                poObj.Year = poYear;
                poObj.ProjectManagerUserId = poProjectManagerUserId;
                poObj.ProjectType = poProjectType;

                poObjArr.push(poObj);

                console.log("poObj.ProjectName---->" + poObj.ProjectName);
                console.log("poObj---->" + poObjArr);

            });

            $.ajax({
                type: 'POST',
                url: '@Url.Action("GetPoOrderDetails", "ProjectManager")',
                data: "{poObjArr:'" + JSON.stringify(poObjArr) + "'}",
                contentType: "application/json; charset=utf-8",
                dataType: 'json',
                async: false,
                success: function (data) {
                    poVal = "yes";
                    if (!data.success) {
                        if (data.errors.name) {
                            //  $('.throw_error').fadeIn(1000).html(data.errors.name);
                        }
                    }
                    else {
                        //  $('#success').fadeIn(1000).append('<p>' + data.posted + '</p>');
                    }
                }
            });

            ///up/Uploded document/////
            var docObj = {};
            var docObjArr = [];

            var docProjectIds;
            var docIncentiveType;
            var docMultiProjectName;
            var docOrders;
            var docEmployeeCode;
            var docEffectiveMonth;
            var docAccessoriesType;
            var docRemarks;
            var docAmount;
            var docFinalAmount;
            
            var docMonth;
            var docYear;
            var docMonNum;
           
            $("#tblDoc tr.tableTrCls2").each(function () {
                docObj = new Object();

               
                docProjectIds = $.trim($(this).find('td:eq(0)').text());
                docIncentiveType = $.trim($(this).find('td:eq(1)').text());
                docMultiProjectName = $.trim($(this).find('td:eq(2)').text());
                docOrders = $.trim($(this).find('td:eq(3)').text());
                docEmployeeCode = $.trim($(this).find('td:eq(4)').text());
                docEffectiveMonth = $.trim($(this).find('td:eq(5)').text());
                docAccessoriesType = $.trim($(this).find('td:eq(6)').text());
                docRemarks = $.trim($(this).find('td:eq(7)').text());
                docAmount = $.trim($(this).find('td:eq(10)').text());
               // docFinalAmount = $.trim($(this).find('td:eq(11)').text());
                docFinalAmount = $.trim($(this).find(".doc_FinalAmount1 .doc_FinalAmount").val());
                
                docMonth = $('#DDDMonth option:selected').text();
                docMonNum = $('#DDDMonth option:selected').val();
                docYear = $('#DDDYear option:selected').val();
               
                docObj.ProjectIds = docProjectIds;
                docObj.IncentiveType = docIncentiveType;
                docObj.MultiProjectName = docMultiProjectName;
                docObj.Orders = docOrders;
                docObj.EmployeeCode = docEmployeeCode;
                docObj.EffectiveMonth = docEffectiveMonth;
                docObj.AccessoriesType = docAccessoriesType;
                docObj.Remarks = docRemarks;
                docObj.Amount = docAmount;
                docObj.FinalAmount = docFinalAmount;
               
                docObj.Month = docMonth;
                docObj.MonNum = docMonNum;
                docObj.Year = docYear;
               
                docObjArr.push(docObj);

            });

            $.ajax({
                type: 'POST',
                url: '@Url.Action("SaveAllDocumentDetails", "ProjectManager")',
                data: "{docObjArr:'" + JSON.stringify(docObjArr) + "'}",
                contentType: "application/json; charset=utf-8",
                dataType: 'json',
                async: false,
                success: function (data) {
                    docVal = "yes";
                    if (!data.success) {
                        if (data.errors.name) {
                            //  $('.throw_error').fadeIn(1000).html(data.errors.name);
                        }
                    }
                    else {
                        //  $('#success').fadeIn(1000).append('<p>' + data.posted + '</p>');
                    }
                }
            });
            @*///order wise project closing/////
            var proClsObj = {};
            var proClsObjArr = [];

            var proClsProjectMasterId;
            var proClsProjectName;
            var proClsOrders;
            var proClsEmployeeCode;
            var proClsProjectClosingDate;
            var proClsMarketClearanceDate;
            var proClsAmount;

            var proClsMonth;
            var proClsYear;
            var proClsMonNum;

            $("#tblProjectClosing tr.tableTrCls2").each(function () {
                proClsObj = new Object();

                proClsProjectMasterId = $.trim($(this).find('td:eq(0)').text());
                proClsProjectName = $.trim($(this).find('td:eq(1)').text());
                proClsOrders = $.trim($(this).find('td:eq(2)').text());
                proClsProjectClosingDate = $.trim($(this).find('td:eq(3)').text());
                proClsMarketClearanceDate = $.trim($(this).find('td:eq(4)').text());
                proClsEmployeeCode = $.trim($(this).find('td:eq(5)').text());
                proClsAmount = $.trim($(this).find('td:eq(6)').text());

                proClsMonth = $('#DDDMonth option:selected').text();
                proClsMonNum = $('#DDDMonth option:selected').val();
                proClsYear = $('#DDDYear option:selected').val();

                proClsObj.ProjectMasterId = proClsProjectMasterId;
                proClsObj.ProjectName = proClsProjectName;
                proClsObj.Orders = proClsOrders;
                proClsObj.ProjectClosingDate = proClsProjectClosingDate;
                proClsObj.MarketClearanceDate = proClsMarketClearanceDate;
                proClsObj.EmployeeCode = proClsEmployeeCode;
                proClsObj.Amount = proClsAmount;

                proClsObj.FinalAmount = proClsAmount;
                proClsObj.Month = proClsMonth;
                proClsObj.MonNum = proClsMonNum;
                proClsObj.Year = proClsYear;

                proClsObjArr.push(proClsObj);

            });

            $.ajax({
                type: 'POST',
                url: '@Url.Action("SaveProjectClosingDetails", "ProjectManager")',
                data: "{proClsObjArr:'" + JSON.stringify(proClsObjArr) + "'}",
                contentType: "application/json; charset=utf-8",
                dataType: 'json',
                async: false,
                success: function (data) {
                    projectClsVal = "yes";
                    if (!data.success) {
                        if (data.errors.name) {
                            //  $('.throw_error').fadeIn(1000).html(data.errors.name);
                        }
                    }
                    else {
                        //  $('#success').fadeIn(1000).append('<p>' + data.posted + '</p>');
                    }
                }
            });*@
            ///Raw Material Upload delay Penalties/////
            var rawObj = {};
            var rawObjArr = [];

            var rawProjectMasterId;
            var rawProjectName;
            var rawOrders;
            var rawPoCategory;
            var rawPoQuantity;
            var rawEmployeeCode;
            var rawPmClearenceDate;
            var rawMaterialAddDate;
            var rawDaysPassed;
            var rawIncentiveName;
            var rawAmount;
            
            var rawMonth;
            var rawYear;
            var rawMonNum;

            $("#tblRawMaterialDelay tr.tableTrCls2").each(function () {
                rawObj = new Object();

                rawProjectMasterId = $.trim($(this).find('td:eq(0)').text());
                rawProjectName = $.trim($(this).find('td:eq(1)').text());
                rawOrders = $.trim($(this).find('td:eq(2)').text());
                rawPoCategory = $.trim($(this).find('td:eq(3)').text());
                rawPoQuantity = $.trim($(this).find('td:eq(4)').text());
                rawPmClearenceDate = $.trim($(this).find('td:eq(5)').text());
                rawMaterialAddDate = $.trim($(this).find('td:eq(6)').text());
                rawDaysPassed = $.trim($(this).find('td:eq(7)').text());
                rawEmployeeCode = $.trim($(this).find('td:eq(8)').text());
                rawIncentiveName = $.trim($(this).find('td:eq(9)').text());
                rawAmount = $.trim($(this).find('td:eq(10)').text());

                rawMonth = $('#DDDMonth option:selected').text();
                rawMonNum = $('#DDDMonth option:selected').val();
                rawYear = $('#DDDYear option:selected').val();

                rawObj.ProjectMasterId = rawProjectMasterId;
                rawObj.ProjectName = rawProjectName;
                rawObj.Orders = rawOrders;
                rawObj.PoCategory = rawPoCategory;
                rawObj.PoQuantity = rawPoQuantity;
                rawObj.ProjectManagerClearanceDate = rawPmClearenceDate;
                rawObj.RawMaterialAddedDate = rawMaterialAddDate;
                rawObj.DaysPassed = rawDaysPassed;
                rawObj.IncentiveName = rawIncentiveName;
                rawObj.EmployeeCode = rawEmployeeCode;
                rawObj.Amount = rawAmount;
                rawObj.FinalAmount = rawAmount;
                rawObj.Month = rawMonth;
                rawObj.MonNum = rawMonNum;
                rawObj.Year = rawYear;

                rawObjArr.push(rawObj);

            });

            $.ajax({
                type: 'POST',
                url: '@Url.Action("SaveRawUploadDelayDetails", "ProjectManager")',
                data: "{rawObjArr:'" + JSON.stringify(rawObjArr) + "'}",
                contentType: "application/json; charset=utf-8",
                dataType: 'json',
                async: false,
                success: function (data) {
                    rawVal = "yes";
                    if (!data.success) {
                        if (data.errors.name) {
                            //  $('.throw_error').fadeIn(1000).html(data.errors.name);
                        }
                    }
                    else {
                        //  $('#success').fadeIn(1000).append('<p>' + data.posted + '</p>');
                    }
                }
            });
            ///PM Shipment Clearance VS LSD/////
            var shipClrObj = {};
            var shipClrObjArr = [];

            var shipClrProjectMasterId;
            var shipClrProjectName;
            var shipClrOrders;
            var shipClrProjectType;
            var shipClrPoCategory;
            var shipClrPmClearenceDate;
            var shipClrLsd;
            var shipClrDaysBeforeLsd;
            var shipClrDaysAfterLsd;
            var shipClrReward;
            var shipClrRealPenalties;
            var shipClrPenalties;
            var shipClrEmployeeCode;
            var shipClrAmount;

            var shipClrMonth;
            var shipClrYear;
            var shipClrMonNum;

            $("#tblShipClearance tr.tableTrCls2").each(function () {
                shipClrObj = new Object();

                shipClrProjectMasterId = $.trim($(this).find('td:eq(0)').text());
                shipClrProjectName = $.trim($(this).find('td:eq(1)').text());
                shipClrOrders = $.trim($(this).find('td:eq(2)').text());
                shipClrProjectType = $.trim($(this).find('td:eq(3)').text());
                shipClrPoCategory = $.trim($(this).find('td:eq(4)').text());
                shipClrPmClearenceDate = $.trim($(this).find('td:eq(5)').text());
                shipClrLsd = $.trim($(this).find('td:eq(6)').text());
                shipClrDaysBeforeLsd = $.trim($(this).find('td:eq(7)').text());
                shipClrDaysAfterLsd = $.trim($(this).find('td:eq(8)').text());
                shipClrReward = $.trim($(this).find('td:eq(9)').text());
                shipClrRealPenalties = $.trim($(this).find('td:eq(10)').text());
                shipClrPenalties = $.trim($(this).find('td:eq(11)').text());
                shipClrEmployeeCode = $.trim($(this).find('td:eq(12)').text());
                shipClrAmount = $.trim($(this).find('td:eq(13)').text());

                shipClrMonth = $('#DDDMonth option:selected').text();
                shipClrMonNum = $('#DDDMonth option:selected').val();
                shipClrYear = $('#DDDYear option:selected').val();

                shipClrObj.ProjectMasterId = shipClrProjectMasterId;
                shipClrObj.ProjectName = shipClrProjectName;
                shipClrObj.Orders = shipClrOrders;
                shipClrObj.ProjectType = shipClrProjectType;
                shipClrObj.PoCategory = shipClrPoCategory;
                shipClrObj.ProjectManagerClearanceDate = shipClrPmClearenceDate;
                shipClrObj.LSD = shipClrLsd;
                shipClrObj.DaysBeforeLsd = shipClrDaysBeforeLsd;
                shipClrObj.DaysAfterLsd = shipClrDaysAfterLsd;
                shipClrObj.Reward = shipClrReward;
                shipClrObj.RealPenalties = shipClrRealPenalties;
                shipClrObj.Penalties = shipClrPenalties;

                shipClrObj.EmployeeCode = shipClrEmployeeCode;
                shipClrObj.Amount = shipClrAmount;
                shipClrObj.FinalAmount = shipClrAmount;
                
                shipClrObj.Month = shipClrMonth;
                shipClrObj.MonNum = shipClrMonNum;
                shipClrObj.Year = shipClrYear;

                shipClrObjArr.push(shipClrObj);

            });

            $.ajax({
                type: 'POST',
                url: '@Url.Action("SaveShipmentClearanceVsLsdDetails", "ProjectManager")',
                data: "{shipClrObjArr:'" + JSON.stringify(shipClrObjArr) + "'}",
                contentType: "application/json; charset=utf-8",
                dataType: 'json',
                async: false,
                success: function (data) {
                    shipClrVal = "yes";
                    if (!data.success) {
                        if (data.errors.name) {
                            //  $('.throw_error').fadeIn(1000).html(data.errors.name);
                        }
                    }
                    else {
                        //  $('#success').fadeIn(1000).append('<p>' + data.posted + '</p>');
                    }
                }
            });
            ///////////////Others//////////////////
            var othersObj = {};
            var othersObjArr = [];

            var othersProjectId;
            var othersProName;
            var othersIncentiveTypes;
            var othersEmployeeCode;
            var othersAmount;
            var othersRemarks;
            var othersDeductionAmount;
            var othersDRemarks;
            var othersFinalAmount;
            var othersMonth;
            var othersYear;
            var othersMonNum;

            $("#tbl5 tr.tableTrCls5").each(function () {
                othersObj = new Object();

                othersProjectId = $.trim($(this).find('td:eq(0)').text());
                othersMonNum = $.trim($(this).find('td:eq(1)').text());
                othersIncentiveTypes = $.trim($(this).find('td:eq(2)').text());
                othersProName = $.trim($(this).find('td:eq(3)').text());
                console.log("othersProName---->" + othersProName);

                othersEmployeeCode = $.trim($(this).find('td:eq(4)').text());
                othersAmount = $.trim($(this).find('td:eq(5)').text());
                othersRemarks = $.trim($(this).find('td:eq(6)').text());
                othersDeductionAmount = $.trim($(this).find('td:eq(7)').text());
                othersDRemarks = $.trim($(this).find('td:eq(8)').text());
                othersFinalAmount = $.trim($(this).find('td:eq(9)').text());
                othersMonth = $.trim($(this).find('td:eq(10)').text());
                othersYear = $.trim($(this).find('td:eq(11)').text());

                othersObj.ProjectId = othersProjectId;
                othersObj.IncentiveTypes = othersIncentiveTypes;
                othersObj.MonNum = othersMonNum;
                othersObj.ProjectName = othersProName;
                othersObj.EmployeeCode = othersEmployeeCode;
                othersObj.Amount = othersAmount;
                othersObj.Remarks = othersRemarks;
                if (othersDeductionAmount == undefined || othersDeductionAmount == "" || othersDeductionAmount == null) {
                    othersObj.DeductionAmount = 0;
                }
                else {
                    othersObj.DeductionAmount = othersDeductionAmount;
                }
                othersObj.FinalAmount = othersFinalAmount;
                othersObj.D_Remarks = othersDRemarks;


                othersObj.Month = othersMonth;
                othersObj.Year = othersYear;

                othersObjArr.push(othersObj);

                console.log(" othersObj.proName---->" + othersObj.ProjectName);
                console.log("othersObjArr---->" + othersObjArr);
            });

            $.ajax({
                type: 'POST',
                url: '@Url.Action("SaveOthersIncentiveTypesDetails", "ProjectManager")',
                data: "{othersObjArr:'" + JSON.stringify(othersObjArr) + "'}",
                contentType: "application/json; charset=utf-8",
                dataType: 'json',
                async: false,
                success: function (data) {
                    // othersVal = "yes";
                    if (!data.success) {
                        if (data.errors.name) {
                            //  $('.throw_error').fadeIn(1000).html(data.errors.name);
                        }
                    }
                    else {
                        //  $('#success').fadeIn(1000).append('<p>' + data.posted + '</p>');
                    }
                }
            });
            @*/////////////////Accessories////////////////

            var accessObj = {};
            var accessObjArr = [];

            var accessProjectId;
            var accessProName;
            var accessIncentiveTypes;
            var accessEmployeeCode;
            var accessAmount;
            var accessRemarks;
            var accessDeductionAmount;
            var accessDRemarks;
            var accessFinalAmount;
            var accessMonth;
            var accessYear;
            var accessMonNum;

            $("#tblForAccessories tr.tableTrClsForAccessories").each(function () {
                accessObj = new Object();

                accessProjectId = $.trim($(this).find('td:eq(0)').text());
                accessMonNum = $.trim($(this).find('td:eq(1)').text());
                accessIncentiveTypes = $.trim($(this).find('td:eq(2)').text());
                accessProName = $.trim($(this).find('td:eq(3)').text());
                console.log("accessProName---->" + accessProName);
                accessEmployeeCode = $.trim($(this).find('td:eq(4)').text());
                accessAmount = $.trim($(this).find('td:eq(5)').text());
                accessRemarks = $.trim($(this).find('td:eq(6)').text());
                accessDeductionAmount = $.trim($(this).find('td:eq(7)').text());
                accessDRemarks = $.trim($(this).find('td:eq(8)').text());
                accessFinalAmount = $.trim($(this).find('td:eq(9)').text());
                accessMonth = $.trim($(this).find('td:eq(10)').text());
                accessYear = $.trim($(this).find('td:eq(11)').text());

                accessObj.ProjectId = accessProjectId;
                accessObj.IncentiveTypeForAccessories = accessIncentiveTypes;
                accessObj.MonNum = accessMonNum;
                accessObj.ProjectName = accessProName;
                accessObj.EmployeeCode = accessEmployeeCode;
                accessObj.Amount = accessAmount;
                accessObj.Remarks = accessRemarks;
                if (accessDeductionAmount == undefined || accessDeductionAmount == "" || accessDeductionAmount == null) {
                    accessObj.DeductionAmount = 0;
                }
                else {
                    accessObj.DeductionAmount = accessDeductionAmount;
                }
                accessObj.FinalAmount = accessFinalAmount;
                accessObj.D_Remarks = accessDRemarks;
                accessObj.Month = accessMonth;
                accessObj.Year = accessYear;

                accessObjArr.push(accessObj);

                console.log("accessObj---->" + accessObj.ProjectName);
                console.log("accessObjArr---->" + accessObjArr);
            });

            $.ajax({
                type: 'POST',
                url: '@Url.Action("SaveAccessoriesDetails", "ProjectManager")',
                data: "{accessObjArr:'" + JSON.stringify(accessObjArr) + "'}",
                contentType: "application/json; charset=utf-8",
                dataType: 'json',
                async: false,
                success: function (data) {
                    accessVal = "yes";
                    if (!data.success) {
                        if (data.errors.name) {
                            //  $('.throw_error').fadeIn(1000).html(data.errors.name);
                        }
                    }
                    else {
                        //  $('#success').fadeIn(1000).append('<p>' + data.posted + '</p>');
                    }
                }
            });*@
            ////////////////////////////////
            //old policy upto Sept 2019
            @*var shipObj = {};
            var shipObjArr = [];

            var shipProjectId;
            var shipProName;
            var shipEmployeeCode;
            var shipOrderNumber;
            var ship_Amount;
            var ship_Remarks;
            var ship_D_Amount;
            var ship_D_Remarks;
            var ship_finalAmount;
            var shipMonth;
            var shipYear;
            var shipMonNum;
            var ship_NoOfdays;
            var ship_ProjectManagerUserId;
            var shipProjectType;
            var shipApproxShipmentDate;
            var shipChainaInspectionDate;

            $("#tbl3 tr.tableTrCls3").each(function () {
                shipObj = new Object();

                shipProName = $.trim($(this).find('td:eq(0)').text());
                console.log("poProName---->" + shipProName);
                shipProjectId = $.trim($(this).find('td:eq(1)').text());
                shipEmployeeCode = $.trim($(this).find('td:eq(2)').text());
                shipProjectType = $.trim($(this).find('td:eq(3)').text());
                shipApproxShipmentDate = $.trim($(this).find('td:eq(4)').text());
                shipChainaInspectionDate = $.trim($(this).find('td:eq(5)').text());
                ship_NoOfdays = $.trim($(this).find('td:eq(6)').text());
                shipOrderNumber = $.trim($(this).find('td:eq(7)').text());
                ship_Amount = $.trim($(this).find('td:eq(8)').text());
                ship_ProjectManagerUserId = $.trim($(this).find('td:eq(9)').text());
                ship_Remarks = $.trim($(this).find('#ship_Remarks').val());
                ship_D_Amount = $.trim($(this).find('td:eq(11)').text());
                ship_D_Remarks = $.trim($(this).find('#ship_D_Remarks').val());
                //ship_finalAmount = $.trim($(this).find('td:eq(13)').val());
                shipMonth = $('#DDDMonth option:selected').text();
                shipMonNum = $('#DDDMonth option:selected').val();
                shipYear = $('#DDDYear option:selected').val();


                shipObj.ProjectName = shipProName;
                shipObj.ProjectId = shipProjectId;
                shipObj.EmployeeCode = shipEmployeeCode;
                shipObj.OrderNumber = shipOrderNumber;
                shipObj.Amount = ship_Amount;
                shipObj.Remarks = ship_Remarks;
                shipObj.DeductionAmount = ship_D_Amount;
                shipObj.D_Remarks = ship_D_Remarks;
                shipObj.FinalAmount = $.trim($(this).find('td:eq(8)').text()) - $.trim($(this).find('td:eq(11)').text());
                shipObj.Month = shipMonth;
                shipObj.MonNum = shipMonNum;
                shipObj.Year = shipYear;
                shipObj.ProjectManagerUserId = ship_ProjectManagerUserId;
                shipObj.ProjectType = shipProjectType;
                shipObj.ApproxShipmentDate = shipApproxShipmentDate;
                shipObj.ChainaInspectionDate = shipChainaInspectionDate;
                shipObj.NoOfdays = ship_NoOfdays;

                shipObjArr.push(shipObj);

                console.log("shipObj.ProjectName---->" + shipObj.ProjectName);
                console.log("shipObjArr---->" + shipObjArr);

            });


            $.ajax({
                type: 'POST',
                url: '@Url.Action("GetShipmentDetailsForSave", "ProjectManager")',
                data: "{shipObjArr:'" + JSON.stringify(shipObjArr) + "'}",
                contentType: "application/json; charset=utf-8",
                dataType: 'json',
                async: false,
                success: function (data) {
                    shipVal = "yes";
                    if (!data.success) {
                        if (data.errors.name) {
                            //  $('.throw_error').fadeIn(1000).html(data.errors.name);
                        }
                    }
                    else {
                        //  $('#success').fadeIn(1000).append('<p>' + data.posted + '</p>');
                    }
                }
            });*@


            @*var marketIssueObj = {};
            var marketIssueObjArr = [];

            var marketIssueProjectId;
            var marketIssueProName;
            var marketIssueEmployeeCode;
            var marketIssueAmount;
            var marketIssueRemarks;
            var marketIssueDAmount;
            var marketIssueDRemarks;
            var marketIssuefinalAmount;
            var marketIssueMonth;
            var marketIssueYear;
            var marketIssueMonNum;
            var marketIssuePersonNo;

            $("#tbl4 tr.tableTrCls4").each(function () {
                marketIssueObj = new Object();

                marketIssueProjectId = $.trim($(this).find('td:eq(0)').text());
                pm_Incentive_Base_Id = $.trim($(this).find('td:eq(1)').text());
                marketIssueMonNum = $.trim($(this).find('td:eq(2)').text());
                marketIssuePersonNo = $.trim($(this).find('td:eq(3)').text());
                marketIssueProName = $.trim($(this).find('td:eq(5)').text());
                console.log("proName---->" + multiProjectName);

                marketIssueEmployeeCode = $.trim($(this).find('td:eq(6)').text());
                marketIssueAmount = $.trim($(this).find('td:eq(7)').text());
                marketIssueRemarks = $.trim($(this).find('td:eq(8)').text());
                marketIssueDAmount = $.trim($(this).find('td:eq(9)').text());
                marketIssueDRemarks = $.trim($(this).find('td:eq(10)').text());
                marketIssuefinalAmount = $.trim($(this).find('td:eq(11)').text());
                marketIssueMonth = $.trim($(this).find('td:eq(12)').text());
                marketIssueYear = $.trim($(this).find('td:eq(13)').text());


                marketIssueObj.MultiProjectIds = marketIssueProjectId;
                marketIssueObj.Pm_Incentive_Base_Id = pm_Incentive_Base_Id;
                marketIssueObj.MonNum = marketIssueMonNum;
                marketIssueObj.multiProjectName = marketIssueProName;
                marketIssueObj.EmployeeCode = marketIssueEmployeeCode;
                marketIssueObj.Amount = marketIssueAmount;
                marketIssueObj.Remarks = marketIssueRemarks;
                marketIssueObj.PersonNo = marketIssuePersonNo;
                if (marketIssueDAmount == undefined || marketIssueDAmount == "" || marketIssueDAmount == null) {
                    marketIssueObj.DeductionAmount = 0;
                }
                else {
                    marketIssueObj.DeductionAmount = marketIssueDAmount;
                }
                marketIssueObj.FinalAmount = marketIssuefinalAmount;
                marketIssueObj.D_Remarks = marketIssueDRemarks;


                marketIssueObj.Month = marketIssueMonth;
                marketIssueObj.Year = marketIssueYear;

                marketIssueObjArr.push(marketIssueObj);

                console.log(" marketIssueObj.proName---->" + marketIssueObj.ProjectName);
                console.log("marketIssueObjArr---->" + marketIssueObjArr);

            });

            $.ajax({
                type: 'POST',
                url: '@Url.Action("SaveMarketIssue", "ProjectManager")',
                data: "{marketIssueObjArr:'" + JSON.stringify(marketIssueObjArr) + "'}",
                contentType: "application/json; charset=utf-8",
                dataType: 'json',
                async: false,
                success: function (data) {
                    marketVal = "yes";
                    if (!data.success) {
                        if (data.errors.name) {
                            //  $('.throw_error').fadeIn(1000).html(data.errors.name);
                        }
                    }
                    else {
                        //  $('#success').fadeIn(1000).append('<p>' + data.posted + '</p>');
                    }
                }
            });*@

            ///////////PiClosing////////////////


            @*var piObj = {};
            var piObjArr = [];

            var piProjectId;
            var piProName;
            var piEmployeeCode;
            var piPoCategory;
            var piPoDate;
            var piOrderNumber;
            var piProjectManagerUserId;
            var piClosingMonth;
            var piClosingDate;
            var piClosingType;
            var piAmount;
            var piRemarks;
            var piDeductionAmount;
            var piDRemarks;
            var piMonth;
            var piYear;
            var piMonNum;


            $("#tblForPi tr.tableTrCls3").each(function () {
                piObj = new Object();

                piProName = $.trim($(this).find('td:eq(0)').text());
                piProjectId = $.trim($(this).find('td:eq(1)').text());
                piEmployeeCode = $.trim($(this).find('td:eq(2)').text());
                piPoCategory = $.trim($(this).find('td:eq(3)').text());
                piPoDate = $.trim($(this).find('td:eq(4)').text());
                piOrderNumber = $.trim($(this).find('td:eq(5)').text());
                piProjectManagerUserId = $.trim($(this).find('td:eq(6)').text());
                piClosingMonth = $.trim($(this).find('td:eq(7)').text());
                piClosingDate = $.trim($(this).find('td:eq(8)').text());
                piClosingType = $.trim($(this).find('td:eq(9)').text());
                piAmount = $.trim($(this).find('td:eq(10)').text());
                piRemarks = $.trim($(this).find('#pi_Remarks').val());
                piDeductionAmount = $.trim($(this).find('#pi_DeductAmount').val());
                piDRemarks = $.trim($(this).find('#pi_D_Remarks').val());
                piMonth = $('#DDDMonth option:selected').text();
                piMonNum = $('#DDDMonth option:selected').val();
                piYear = $('#DDDYear option:selected').val();


                piObj.ProjectName = piProName;
                piObj.ProjectId = piProjectId;
                piObj.EmployeeCode = piEmployeeCode;
                piObj.PoCategory = piPoCategory;
                piObj.PoDate = piPoDate;
                piObj.OrderNumber = piOrderNumber;
                piObj.ProjectManagerUserId = piProjectManagerUserId;
                piObj.ClosingMonth = piClosingMonth;
                piObj.ClosingDate = piClosingDate;
                piObj.ClosingType = piClosingType;
                piObj.ClosingAmount = piAmount;
                piObj.Remarks = piRemarks;
                // piObj.DeductionAmount = piDeductionAmount;

                if (piDeductionAmount == undefined || piDeductionAmount == "" || piDeductionAmount == null) {
                    piObj.DeductionAmount = 0;
                }
                else {
                    piObj.DeductionAmount = piDeductionAmount;
                }
                piObj.D_Remarks = piDRemarks;
                piObj.Month = piMonth;
                piObj.MonNum = piMonNum;
                piObj.Year = piYear;
                piObj.FinalAmount = $.trim($(this).find('td:eq(10)').text()) - $.trim($(this).find('#pi_DeductAmount').val());


                piObjArr.push(piObj);

                console.log("piObj.ProjectName---->" + piObj.ProjectName);
                console.log("piObjArr---->" + piObjArr);

            });

            $.ajax({
                type: 'POST',
                url: '@Url.Action("SavePiDetails", "ProjectManager")',
                data: "{piObjArr:'" + JSON.stringify(piObjArr) + "'}",
                contentType: "application/json; charset=utf-8",
                dataType: 'json',
                async: false,
                success: function (data) {
                    piVal = "yes";
                    if (!data.success) {
                        if (data.errors.name) {
                            //  $('.throw_error').fadeIn(1000).html(data.errors.name);
                        }
                    }
                    else {
                        //  $('#success').fadeIn(1000).append('<p>' + data.posted + '</p>');
                    }
                }
            });*@
            ////////////////////////////////////
            //productionVal//
            var productObj = {};
            var productObjArr = [];

            var productProjectMasterId;
            var productProjectModel;
            var productEmployeeCode;
            var productUserFullName;
            var productSourcingType;
            var productWpmsOrders;
            var productWarehouseEntryDate;
            var productExtendedWarehouseDate;
            var productProjectManagerUserId;
            var productOrderQuantity;
            var productTotalProductionQuantity;
            var productEffectiveDays;
            var productRewardPercentage;
            var productExistedPercentage;
            var productRewardAmount;
            var productDeductAmount;

            var productMonth;
            var productMonNum;
            var productYear;

            $("#tblProduction tr.tableTrCls2").each(function () {
                productObj = new Object();

                productProjectMasterId = $.trim($(this).find('td:eq(0)').text());
                productProjectModel = $.trim($(this).find('td:eq(1)').text());
                productEmployeeCode = $.trim($(this).find('td:eq(2)').text());
                productUserFullName = $.trim($(this).find('td:eq(3)').text());
                productSourcingType = $.trim($(this).find('td:eq(4)').text());
                productWpmsOrders = $.trim($(this).find('td:eq(5)').text());
                productWarehouseEntryDate = $.trim($(this).find('td:eq(6)').text());
                productExtendedWarehouseDate = $.trim($(this).find('td:eq(7)').text());
                productProjectManagerUserId = $.trim($(this).find('td:eq(8)').text());
                productOrderQuantity = $.trim($(this).find('td:eq(9)').text());
                productTotalProductionQuantity = $.trim($(this).find('td:eq(10)').text());
                productEffectiveDays = $.trim($(this).find('td:eq(11)').text());
                productRewardPercentage = $.trim($(this).find('td:eq(12)').text());
                productExistedPercentage = $.trim($(this).find('td:eq(13)').text());
                productRewardAmount = $.trim($(this).find('td:eq(14)').text());
                //hehe
                productDeductAmount = $.trim($(this).find("#pro_DeductAmount").val());

                productMonth = $('#DDDMonth option:selected').text();
                productMonNum = $('#DDDMonth option:selected').val();
                productYear = $('#DDDYear option:selected').val();
                //
                productObj.ProjectMasterId = productProjectMasterId;
                productObj.ProjectModel = productProjectModel;
                productObj.EmployeeCode = productEmployeeCode;
                productObj.UserFullName = productUserFullName;
                productObj.SourcingType = productSourcingType;
                productObj.WpmsOrders = productWpmsOrders;
                productObj.WarehouseEntryDate = productWarehouseEntryDate;
                productObj.ExtendedWarehouseDate = productExtendedWarehouseDate;
                productObj.ProjectManagerUserId = productProjectManagerUserId;
                productObj.OrderQuantity = productOrderQuantity;
                productObj.TotalProductionQuantity = productTotalProductionQuantity;
                productObj.EffectiveDays = productEffectiveDays;
                productObj.RewardPercentage = productRewardPercentage;
                productObj.ExistedPercentage = productExistedPercentage;
                productObj.RewardAmount = productRewardAmount;
                productObj.DeductAmount = productDeductAmount;

                productObj.Month = productMonth;
                productObj.MonNum = productMonNum;
                productObj.Year = productYear;

                productObjArr.push(productObj);
                console.log("productObjArr---->" + productObjArr);
            });

            $.ajax({
                type: 'POST',
                url: '@Url.Action("SaveProductionRewardData", "ProjectManager")',
                data: "{productObjArr:'" + JSON.stringify(productObjArr) + "'}",
                contentType: "application/json; charset=utf-8",
                dataType: 'json',
                async: false,
                success: function (data) {
                    productionVal = "yes";
                    if (!data.success) {
                        if (data.errors.name) {
                            //  $('.throw_error').fadeIn(1000).html(data.errors.name);
                        }
                    }
                    else {
                        //  $('#success').fadeIn(1000).append('<p>' + data.posted + '</p>');
                    }
                }
            });
            //end productionVal//

            //tblSalesOut
            @*var tblSalesOutObj = {};
            var tblSalesOutObjArr = [];

            var tblSalesOutProjectMasterId;
            var tblSalesOutProjectModel;
            var tblSalesOutEmployeeCode;
            var tblSalesOutUserFullName;
            var tblSalesOutOrders;
            var tblSalesOutWarehouseEntryDate;
            var tblSalesOutExtendedWarehouseDate;
            var tblSalesOutProjectManagerUserId;
            var tblSalesOutEffectiveDays;
            var tblSalesOutOrderQuantity;
            var tblSalesOutTblBarcodeIMEI;
            var tblSalesOutTotalSalesOut;
            var tblSalesOutRewardPercentage;
            var tblSalesOutExistedPercentage;
            var tblSalesOutRewardAmount;
            var tblSalesOutDeductAmount;

            var tblSalesOutMonth;
            var tblSalesOutMonNum;
            var tblSalesOutYear;

            $("#tblSalesOut tr.tableTrCls2").each(function () {
                tblSalesOutObj = new Object();

                tblSalesOutProjectMasterId = $.trim($(this).find('td:eq(0)').text());
                tblSalesOutProjectModel = $.trim($(this).find('td:eq(1)').text());
                tblSalesOutEmployeeCode = $.trim($(this).find('td:eq(2)').text());
                tblSalesOutUserFullName = $.trim($(this).find('td:eq(3)').text());
                tblSalesOutOrders = $.trim($(this).find('td:eq(4)').text());
                tblSalesOutWarehouseEntryDate = $.trim($(this).find('td:eq(5)').text());
                tblSalesOutExtendedWarehouseDate = $.trim($(this).find('td:eq(6)').text());
                tblSalesOutProjectManagerUserId = $.trim($(this).find('td:eq(7)').text());
                tblSalesOutEffectiveDays = $.trim($(this).find('td:eq(8)').text());
                tblSalesOutOrderQuantity = $.trim($(this).find('td:eq(9)').text());
                tblSalesOutTblBarcodeIMEI = $.trim($(this).find('td:eq(10)').text());
                tblSalesOutTotalSalesOut = $.trim($(this).find('td:eq(11)').text());
                tblSalesOutRewardPercentage = $.trim($(this).find('td:eq(12)').text());
                tblSalesOutExistedPercentage = $.trim($(this).find('td:eq(13)').text());
                tblSalesOutRewardAmount = $.trim($(this).find('td:eq(14)').text());
                tblSalesOutDeductAmount = $.trim($(this).find("#pro_DeductAmount").val());

                tblSalesOutMonth = $('#DDDMonth option:selected').text();
                tblSalesOutMonNum = $('#DDDMonth option:selected').val();
                tblSalesOutYear = $('#DDDYear option:selected').val();
                //
                tblSalesOutObj.ProjectMasterID = tblSalesOutProjectMasterId;
                tblSalesOutObj.ProjectModel = tblSalesOutProjectModel;
                tblSalesOutObj.EmployeeCode = tblSalesOutEmployeeCode;
                tblSalesOutObj.UserFullName = tblSalesOutUserFullName;
                tblSalesOutObj.Orders = tblSalesOutOrders;
                tblSalesOutObj.WarehouseEntryDate = tblSalesOutWarehouseEntryDate;
                tblSalesOutObj.ExtendedWarehouseDate = tblSalesOutExtendedWarehouseDate;
                tblSalesOutObj.ProjectManagerUserId = tblSalesOutProjectManagerUserId;
                tblSalesOutObj.EffectiveDays = tblSalesOutEffectiveDays;
                tblSalesOutObj.OrderQuantity = tblSalesOutOrderQuantity;
                tblSalesOutObj.TotalTblBarcodeIMEI = tblSalesOutTblBarcodeIMEI;
                tblSalesOutObj.TotalSalesOut = tblSalesOutTotalSalesOut;
                tblSalesOutObj.RewardPercentage = tblSalesOutRewardPercentage;
                tblSalesOutObj.ExistedPercentage = tblSalesOutExistedPercentage;
                tblSalesOutObj.RewardAmount = tblSalesOutRewardAmount;
                tblSalesOutObj.DeductAmount = tblSalesOutDeductAmount;

                tblSalesOutObj.Month = tblSalesOutMonth;
                tblSalesOutObj.MonNum = tblSalesOutMonNum;
                tblSalesOutObj.Year = tblSalesOutYear;

                tblSalesOutObjArr.push(tblSalesOutObj);
                console.log("tblSalesOutObjArr---->" + tblSalesOutObjArr);
            });

            $.ajax({
                type: 'POST',
                url: '@Url.Action("SaveSalesOutRewardData", "ProjectManager")',
                data: "{tblSalesOutObjArr:'" + JSON.stringify(tblSalesOutObjArr) + "'}",
                contentType: "application/json; charset=utf-8",
                dataType: 'json',
                async: false,
                success: function (data) {
                    salesOutVal = "yes";
                    if (!data.success) {
                        if (data.errors.name) {
                            //  $('.throw_error').fadeIn(1000).html(data.errors.name);
                        }
                    }
                    else {
                        //  $('#success').fadeIn(1000).append('<p>' + data.posted + '</p>');
                    }
                }
            });*@
            //end tblSalesOut
            // tblVessel

            @*var tblVesselObj = {};
            var tblVesselObjArr = [];

            var tblVesselProjectMasterId;
            var tblVesselProjectModel;
            var tblVesselEmployeeCode;
            var tblVesselUserFullName;
            var tblVesselProjectType;
            var tblVesselOrders;
            var tblVesselPoDate;
            var tblVesselLsdDate;
            var tblVesselProjectManagerUserId;
            var tblVesselPoVsLSDDiff;
            var tblVesselVesselDate;
            var tblVesselLsdVsVesselDiffForDeduct;
            var tblVesselDeductPoint;
            var tblVesselDeductedAmount;
            var tblVesselLsdVsVesselDiffForReward;
            var tblVesselRewardPoint;
            var tblVesselRewardAmount;

            var tblVesselMonth;
            var tblVesselMonNum;
            var tblVesselYear;

            $("#tblVessel tr.tableTrCls2").each(function () {
                tblVesselObj = new Object();

                tblVesselProjectMasterId = $.trim($(this).find('td:eq(0)').text());
                tblVesselProjectModel = $.trim($(this).find('td:eq(1)').text());
                tblVesselEmployeeCode = $.trim($(this).find('td:eq(2)').text());
                tblVesselUserFullName = $.trim($(this).find('td:eq(3)').text());
                tblVesselProjectManagerUserId = $.trim($(this).find('td:eq(4)').text());
                tblVesselProjectType = $.trim($(this).find('td:eq(5)').text());
                tblVesselOrders = $.trim($(this).find('td:eq(6)').text());
                tblVesselPoDate = $.trim($(this).find('td:eq(7)').text());
                tblVesselLsdDate = $.trim($(this).find('td:eq(8)').text());
                tblVesselPoVsLSDDiff = $.trim($(this).find('td:eq(9)').text());
                tblVesselVesselDate = $.trim($(this).find('td:eq(10)').text());
                tblVesselLsdVsVesselDiffForDeduct = $.trim($(this).find('td:eq(11)').text());
                tblVesselDeductPoint = $.trim($(this).find('td:eq(12)').text());
                tblVesselDeductedAmount = $.trim($(this).find('td:eq(13)').text());
                tblVesselLsdVsVesselDiffForReward = $.trim($(this).find('td:eq(14)').text());
                tblVesselRewardPoint = $.trim($(this).find('td:eq(15)').text());
                tblVesselRewardAmount = $.trim($(this).find('td:eq(16)').text());

                tblVesselMonth = $('#DDDMonth option:selected').text();
                tblVesselMonNum = $('#DDDMonth option:selected').val();
                tblVesselYear = $('#DDDYear option:selected').val();
                //
                tblVesselObj.ProjectMasterID = tblVesselProjectMasterId;
                tblVesselObj.ProjectName = tblVesselProjectModel;
                tblVesselObj.EmployeeCode = tblVesselEmployeeCode;
                tblVesselObj.UserFullName = tblVesselUserFullName;
                tblVesselObj.ProjectManagerUserId = tblVesselProjectManagerUserId;
                tblVesselObj.ProjectType = tblVesselProjectType;
                tblVesselObj.Orders = tblVesselOrders;
                tblVesselObj.PoDate = tblVesselPoDate;
                tblVesselObj.LSD = tblVesselLsdDate;
                tblVesselObj.PoVsLSDDiff = tblVesselPoVsLSDDiff;
                tblVesselObj.VesselDate = tblVesselVesselDate;
                tblVesselObj.LsdVsVesselDiffForDeduct = tblVesselLsdVsVesselDiffForDeduct;
                tblVesselObj.DeductPoint = tblVesselDeductPoint;
                tblVesselObj.DeductedAmount = tblVesselDeductedAmount;
                tblVesselObj.LsdVsVesselDiffForReward = tblVesselLsdVsVesselDiffForReward;
                tblVesselObj.RewardPoint = tblVesselRewardPoint;
                tblVesselObj.RewardAmount = tblVesselRewardAmount;


                tblVesselObj.Month = tblVesselMonth;
                tblVesselObj.MonNum = tblVesselMonNum;
                tblVesselObj.Year = tblVesselYear;

                tblVesselObjArr.push(tblVesselObj);
                console.log("tblVesselObjArr---->" + tblVesselObjArr);
            });

            $.ajax({
                type: 'POST',
                url: '@Url.Action("SaveVesselRewardOrPenaltiesData", "ProjectManager")',
                data: "{tblVesselObjArr:'" + JSON.stringify(tblVesselObjArr) + "'}",
                contentType: "application/json; charset=utf-8",
                dataType: 'json',
                async: false,
                success: function (data) {
                    vesselVal = "yes";
                    if (!data.success) {
                        if (data.errors.name) {
                            //  $('.throw_error').fadeIn(1000).html(data.errors.name);
                        }
                    }
                    else {
                        //  $('#success').fadeIn(1000).append('<p>' + data.posted + '</p>');
                    }
                }
            });*@
            //end tblVessel
            var empCode = $('#sltPerson option:selected').val();
            //if (issueVal == "yes" && poVal == "yes" && shipVal == "yes" && marketVal == "yes" && productionVal == "yes" && salesOutVal=="yes" &&  vesselVal == "yes") {
           // if (issueVal == "yes" && poRewardVal == "yes" && poVal == "yes" && piVal == "yes" && marketVal == "yes" && productionVal == "yes" && salesOutVal == "yes" && vesselVal == "yes") {
            if (issueVal == "yes" && poVal == "yes" && productionVal == "yes" && docVal == "yes" && rawVal == "yes" && shipClrVal == "yes") {
                $.ajax({
                    type: 'POST',
                    url: '@Url.Action("SaveTotalIncentive", "ProjectManager")',
                    data: "{ Month: '" + monthName
                        + "', MonNum: '" + monthNum
                        + "', Year: '" + yearName
                        + "', EmpCode: '" + empCode
                        + "'}",
                    contentType: "application/json; charset=utf-8",
                    dataType: 'json',
                    async: false,
                    success: function (data) {

                        if (!data.success) {
                            if (data.errors.name) {
                                //  $('.throw_error').fadeIn(1000).html(data.errors.name);
                            }
                        }
                        else {
                            //  $('#success').fadeIn(1000).append('<p>' + data.posted + '</p>');
                        }
                    }
                });
            }
            window.location = '@Url.Action("PmMonthlyIncentive", "ProjectManager")';

        });

        $("#btnAdd").on('click', function (e) {
            e.preventDefault();

            var incentiveTypeAndAmount = $('#PmIncentiveBaseModels_Id option:selected').text();
            console.log("incentiveTypeAndAmount  :" + incentiveTypeAndAmount);

            var incentiveTypeAndAmountSplit = incentiveTypeAndAmount.split('-');
            //alert(incentiveTypeAndAmountSplit);
            var incentiveType = incentiveTypeAndAmountSplit[0];
            var incentiveAmount = incentiveTypeAndAmountSplit[1];
            console.log("incentiveType---" + incentiveType);
            console.log("incentiveAmount---" + incentiveAmount);

            var incentiveId = $('#PmIncentiveBaseModels_Id option:selected').val();
            console.log("incentiveId  :" + incentiveId);

            var personEmpName = $('#sltPerson option:selected').text();
            console.log("personEmpName  :" + personEmpName);

            var personEmpCode = $('#sltPerson option:selected').val();
            console.log("personEmpCode  :" + personEmpCode);

            var projectName = $('#ProjectMasterId option:selected').text();
            console.log("projectName  :" + projectName);

            var projectMasterId = $('#ProjectMasterId option:selected').val();
            console.log("projectMasterId  :" + projectMasterId);

            var monName = $('#DDDMonth option:selected').text();
            var monId = $('#DDDMonth option:selected').val();
            console.log(monName);
            console.log(monId);

            var yearName = $('#DDDYear option:selected').text();
            var yearId = $('#DDDYear option:selected').val();
            console.log(yearName);
            console.log(yearId);


            if (monName == "SELECT MONTH") {

                alertify.dialog('alert').set({
                    'title': '   ',
                    'transition': 'zoom',
                    'message': "Please must select Month",
                }).show();
                return false;
            }
            if (yearName == "SELECT YEAR") {

                alertify.dialog('alert').set({
                    'title': '   ',
                    'transition': 'zoom',
                    'message': "Please must select Year",
                }).show();
                return false;
            }
            if (personEmpName == "SELECT PERSON") {

                alertify.dialog('alert').set({
                    'title': '   ',
                    'transition': 'zoom',
                    'message': "Please must select Person",
                }).show();
                return false;
            }

            var remarks = $('#PmIncentiveModels_Remarks').val();
            console.log(remarks);

            var deductAmount = $('#PmIncentiveModels_DeductionAmount').val();
            console.log(deductAmount);

            var d_remarks = $('#PmIncentiveModels_D_Remarks').val();
            console.log(d_remarks);


            //if (isNaN(deductAmount) && d_remarks == "") {
            //    alertify.dialog('alert').set({
            //        'title': '   ',
            //        'transition': 'zoom',
            //        'message': "Please must put Deduction Remarks",
            //    }).show();
            //    return false;
            //}

            var finalAmount = incentiveTypeAndAmountSplit[1] - deductAmount;
            console.log("finalAmount :" + finalAmount);

            $.post('@Url.Action("AddProject", "ProjectManager")', {
                incentiveType: incentiveType,
                incentiveAmount: incentiveAmount,
                incentiveId: incentiveId,
                personEmpCode: personEmpCode,
                projectName: projectName,
                projectMasterId: projectMasterId,
                monName: monName,
                monId: monId,
                yearName: yearName,
                yearId: yearId,
                remarks: remarks,
                deductAmount: deductAmount,
                d_remarks: d_remarks,
                finalAmount: incentiveTypeAndAmountSplit[1] - deductAmount
            }, function (data) {
                console.log(data);
                $('#tBody').append(data);

                //Add incentive
                //var final_Am_Id1 = $.trim($('#tbl').find('td:eq(10)').text());
                var final_Am_Id1 = +finalAmount;
                console.log("incentive :" + final_Am_Id1);
                AllFinalAmount += +final_Am_Id1;
                $('#FinalIssueAmount').val(AllFinalAmount.toFixed(2));

                // $('#FinalTotalAmount').val(+$('#FinalIssueAmount').val() + +$('#Deduction').val());
                $('#FinalTotalAmount').val(+$('#FinalIssueAmount').val());

                //end add incentive
            });
            //

            //
            $('#PmIncentiveModels_Remarks').val("");
            $('#PmIncentiveModels_DeductionAmount').val("");
            $('#PmIncentiveModels_D_Remarks').val("");

        });

        $("#btnAdd1").on('click', function (e) {
            e.preventDefault();

            var incentiveType = $('#PmIncentiveModels_OthersType').val();
            console.log("incentiveTypeAndAmount  :" + incentiveType);

            //var incentiveTypeAndAmountSplit = incentiveTypeAndAmount.split('-');
            ////alert(incentiveTypeAndAmountSplit);
            //var incentiveType = incentiveTypeAndAmountSplit[0];
            //var incentiveAmount = incentiveTypeAndAmountSplit[1];
            //console.log("incentiveType---" + incentiveType);
            //console.log("incentiveAmount---" + incentiveAmount);

            var personEmpName = $('#sltPerson option:selected').text();
            console.log("personEmpName  :" + personEmpName);

            var personEmpCode = $('#sltPerson option:selected').val();
            console.log("personEmpCode  :" + personEmpCode);

            var projectNameWithOrder = $('#projectIdForOthers option:selected').text();
            console.log("projectName  :" + projectNameWithOrder);

            var projectNameWithOrderSplit = projectNameWithOrder.split('(');
            var projectName = projectNameWithOrderSplit[0];

            console.log(projectName);

            var projectMasterId = $('#projectIdForOthers option:selected').val();
            console.log("projectMasterId  :" + projectMasterId);

            var monName = $('#DDDMonth option:selected').text();
            var monId = $('#DDDMonth option:selected').val();
            console.log(monName);
            console.log(monId);

            var yearName = $('#DDDYear option:selected').text();
            var yearId = $('#DDDYear option:selected').val();
            console.log(yearName);
            console.log(yearId);


            if (monName == "SELECT MONTH") {

                alertify.dialog('alert').set({
                    'title': '   ',
                    'transition': 'zoom',
                    'message': "Please must select Month",
                }).show();
                return false;
            }
            if (yearName == "SELECT YEAR") {

                alertify.dialog('alert').set({
                    'title': '   ',
                    'transition': 'zoom',
                    'message': "Please must select Year",
                }).show();
                return false;
            }
            if (personEmpName == "SELECT PERSON") {

                alertify.dialog('alert').set({
                    'title': '   ',
                    'transition': 'zoom',
                    'message': "Please must select Person",
                }).show();
                return false;
            }

            var addedAmount = $('#othersAmount').val();
            console.log(addedAmount);

            var remarks = $('#othersRemarks').val();
            console.log(remarks);

            if (remarks == "") {

                alertify.dialog('alert').set({
                    'title': '   ',
                    'transition': 'zoom',
                    'message': "Please must input Remarks",
                }).show();
                return false;
            }

            var deductAmount = $('#othersDeduct').val();
            console.log(deductAmount);

            var d_remarks = $('#others_D_Remarks').val();
            console.log(d_remarks);

            var finalAmount = addedAmount - deductAmount;
            console.log("finalAmount :" + finalAmount);

            $.post('@Url.Action("AddProjectForOthers", "ProjectManager")', {
                incentiveType: "Others",
                AddedAmount: addedAmount,
                personEmpCode: personEmpCode,
                projectName: projectName,
                projectMasterId: projectMasterId,
                monName: monName,
                monId: monId,
                yearName: yearName,
                yearId: yearId,
                remarks: remarks,
                deductAmount: deductAmount,
                d_remarks: d_remarks,
                finalAmount: addedAmount - deductAmount
            }, function (data) {
                console.log(data);
                $('#tBody5').append(data);

                //Add incentive
                //var final_Am_Id1 = $.trim($('#tbl5').find('td:eq(9)').text());
                var final_Am_Id1 = +finalAmount;
                console.log("incentive :" + final_Am_Id1);
                AllFinalAmount += +final_Am_Id1;
                $('#FinalIssueAmount').val(AllFinalAmount.toFixed(2));
                $('#FinalTotalAmount').val(+$('#FinalIssueAmount').val());
                // $('#FinalIncentive').val(+$('#FinalIssueAmount').val() + +$('#Deduction').val());

                //end add incentive
            });

            $('#PmIncentiveModels_OthersType').val("");
            $('#othersAmount').val("");
            $('#othersRemarks').val("");
            $('#othersDeduct').val("");
            $('#others_D_Remarks').val("");

        });

    });

    function removeDetailRow(element) {

        var detailRow = $(element).closest('tr');

        var finals = $.trim(detailRow.find(".finalAmount").html());

        var allFinals = +$('#FinalIssueAmount').val();

        // var allFinals2 = +AllFinalAmount - +finals;
        AllFinalAmount = +AllFinalAmount - +finals;
        $('#FinalIssueAmount').val(AllFinalAmount.toFixed(2));
        //$('#FinalTotalAmount').val(+$('#FinalIssueAmount').val() + +$('#Deduction').val());
        $('#FinalTotalAmount').val(+$('#FinalIssueAmount').val());

        $(detailRow).remove();
    }
    // var tblPoReward;
    //var tblPoPenalties;
    var tbl2;
    function LoadProject() {
         AllFinalAmount = 0;
         AllPenalties = 0;
        $('#FinalDeduction').val(0);
        $('#FinalAddedAmount').val(0);

        var selectedPersonText = document.getElementById('sltPerson');
        var selecteddropTextPersonName = selectedPersonText.options[selectedPersonText.selectedIndex].text;
        var selecteddropTextPersonEmpId = selectedPersonText.options[selectedPersonText.selectedIndex].value;
        console.log("selecteddropTextPersonName  :" + selecteddropTextPersonName);
        console.log("selecteddropTextPersonEmpId  :" + selecteddropTextPersonEmpId);

        var monthName = $('#DDDMonth option:selected').text();
        var monNum = $('#DDDMonth option:selected').val();
        var year = $('#DDDYear option:selected').val();

        //Incharge Percentage
        $.ajax({
            url: '@Url.Action("GetPmHeadPercentage", "ProjectManager")',
            type: "POST",
            dataType: "JSON",
            data: { employeeCode: selecteddropTextPersonEmpId, monthName: monthName, monNum: monNum, year: year },
            success: function (data) {
                var ss = "Details";
                console.log(data);
                $('#tblInchargePercentage tbody').empty();
                var items = $.parseJSON(data);

                $.each(items, function (index, obj) {
                    var row = ' <tr class="tableTrCls2" id="trIdForIncentive2"> <td id="teamTotals" class="teamTotals">' + obj.TeamIncentive + ' </td>' +
                        '<td id="incPercentage" class="incPercentage">' + obj.InchargePecentage + ' </td>' +
                         '<td id="month" class="month">' + obj.Month + ' </td><td id="year" class="year">' + obj.Year + ' </td>';
                    $("#tblInchargePercentage tbody").append(row);
                    //
                });
                $("#tblInchargePercentage tr.tableTrCls2").each(function () {
                    var final_Am_Id1 = $.trim($(this).find('td:eq(1)').text());
                    console.log("incentive :" + final_Am_Id1);
                    AllFinalAmount += +final_Am_Id1;
                });
                $('#FinalIssueAmount').val(AllFinalAmount.toFixed(2));
                $('#FinalTotalAmount').val(+AllFinalAmount.toFixed(2));
                //$('#FinalIncentive').val(+AllFinalAmount.toFixed(2) + +$('#Deduction').val());
            }
        });

        //tblPoReward

        @*$.ajax({
            url: '@Url.Action("GetPerPoRewardSumForPmHead", "ProjectManager")',//'/ProjectManager/GetPoProject',
            type: "POST",
            dataType: "JSON",
            data: { employeeCode: selecteddropTextPersonEmpId, monthName: monthName, monNum: monNum, year: year },
            success: function (data) {
                var ss = "Details";
                console.log(data);
                $('#tblPoReward tbody').empty();
                var items = $.parseJSON(data);

                $.each(items, function (index, obj) {
                    var row = ' <tr class="tableTrCls2" id="trIdForIncentive2"> <td id="po_ProjectName" class="po_ProjectName">' + obj.PoReward + ' </td> <td id="EmployeeCode" class="EmployeeCode">' + obj.EmployeeCode + ' </td><td id="MonNum" class="MonNum" style="display:none">' + obj.MonNum + ' </td>' +
                        '<td id="month" class="month">' + obj.Month + ' </td><td id="year" class="year">' + obj.Year + ' </td>' +
                        '<td  id="po_ProjectId" class="po_ProjectId">' +
                        '<a target="_blank" onclick="PoDetailsPageFunc()">' + ss + '</a> </td></tr>';
                    $("#tblPoReward tbody").append(row);
                    //
                });
                $("#tblPoReward tr.tableTrCls2").each(function () {
                    var final_Am_Id1 = $.trim($(this).find('td:eq(0)').text());
                    console.log("incentive :" + final_Am_Id1);
                    AllFinalAmount += +final_Am_Id1;
                });
                $('#FinalIssueAmount').val(AllFinalAmount.toFixed(2));
                $('#FinalTotalAmount').val(+AllFinalAmount.toFixed(2) + +$('#Deduction').val());
                //$('#FinalIncentive').val(+AllFinalAmount.toFixed(2) + +$('#Deduction').val());
            }
        });*@

        @*$.ajax({
            url: '@Url.Action("GetPenaltiesSumForPmHead", "ProjectManager")',//'/ProjectManager/GetPoProject',
            type: "POST",
            dataType: "JSON",
            data: { employeeCode: selecteddropTextPersonEmpId, monthName: monthName, monNum: monNum, year: year },
            success: function (data) {
                var ss = "Details";
                console.log(data);
                $('#tblPoPenalties tbody').empty();
                var items = $.parseJSON(data);

                $.each(items, function (index, obj) {
                    if (obj.Penalties == null) {
                        obj.Penalties = 0;
                    }
                    var row = ' <tr class="tableTrCls2" id="trIdForIncentive2"> <td id="po_ProjectName" class="po_ProjectName">' + obj.Penalties + ' </td> <td id="EmployeeCode" class="EmployeeCode">' + obj.EmployeeCode + ' </td><td id="MonNum" class="MonNum" style="display:none">' + obj.MonNum + ' </td>' +
                        '<td id="month" class="month">' + obj.Month + ' </td><td id="year" class="year">' + obj.Year + ' </td>' +
                        '<td  id="po_ProjectId" class="po_ProjectId">' +
                        '<a target="_blank" onclick="RatioWisePenaltiesPageFunc()">' + ss + '</a> </td></tr>';
                    $("#tblPoPenalties tbody").append(row);
                    //
                });
                $("#tblPoPenalties tr.tableTrCls2").each(function () {
                    var final_Am_Id1 = $.trim($(this).find('td:eq(0)').text());
                    console.log("incentive :" + final_Am_Id1);

                    AllPenalties += -final_Am_Id1;
                });
                $('#Deduction').val(AllPenalties.toFixed(2));

            }
        });*@
        $.ajax({
            url: '@Url.Action("GetProject", "ProjectManager")',//'/ProjectManager/GetProject',
            type: "GET",
            dataType: "JSON",
            data: { employeeCode: selecteddropTextPersonEmpId },
            success: function (data) {

                console.log(data);
                $('#ProjectMasterId').empty();
                $('#ProjectMasterId').append($('<option>', {
                    value: '',
                    text: 'SELECT PROJECT'
                }));
                var items = $.parseJSON(data);

                $.each(items, function (i, item) {
                    $('#ProjectMasterId').append($('<option>', {
                        value: item.Value,
                        text: item.Text
                    }));
                });
            }
        });

        $.ajax({
            url: '@Url.Action("GetPoProject", "ProjectManager")',//'/ProjectManager/GetPoProject',
            type: "GET",
            dataType: "JSON",
            data: { employeeCode: selecteddropTextPersonEmpId },
            success: function (data) {

                console.log(data);
                $('#tbl2 tbody').empty();
                //$("#tbl2").load("PmMonthlyIncentive.cshtml #tbl2");
                var items = $.parseJSON(data);

                $.each(items, function (index, obj) {
                    var newDate = new Date(obj.PoDate);
                    var poDate = moment(obj.PoDate).format('MM/DD/YYYY');
                    var day = newDate.getDate();
                    var month = newDate.getUTCMonth() + 1;
                    var year = newDate.getFullYear();

                    console.log(day + "-" + ("0" + (month)) + "-" + year);

                    var row = ' <tr class="tableTrCls2" id="trIdForIncentive2"> <td id="po_ProjectName" class="po_ProjectName">' + obj.ProjectName + ' </td><td  id="po_ProjectId" class="po_ProjectId" style="display:none;">' + obj.ProjectId +
                        ' </td><td id="po_EmployeeCode" class="po_EmployeeCode">' + obj.EmployeeCode + ' </td><td id="po_PoCategory" class="po_PoCategory">' + obj.PoCategory + '</td><td id="po_PoDate" class="po_PoDate">' + poDate + '</td><td id="po_OrderNumber" class="po_OrderNumber">' + obj.OrderNumber +
                        '</td><td id="po_Amount" class="po_Amount">' + obj.Amount + '</td><td  id="po_ProjectManagerUserId" class="po_ProjectManagerUserId" style="display:none;">' + obj.ProjectManagerUserId + '</td><td  id="po_ProjectType" class="po_ProjectType" style="display:none;">' + obj.ProjectType + '</td><td><input class="form-control po_Remarks" id="po_Remarks">' + "" + '</input></td><td class="po_D_Amount1" id="po_D_Amount1"><input class="form-control po_D_Amount" id="po_D_Amount" onchange="repeatOrderDeduct(this.value)">' + "" + '</input></td><td><input class="form-control po_D_Remarks"  id="po_D_Remarks">' + "" + '</input></td></tr>';
                    $("#tbl2 tbody").append(row);
                });
                $("#tbl2 tr.tableTrCls2").each(function () {
                    var final_Am_Id1 = $.trim($(this).find('td:eq(6)').text());
                    console.log("incentive :" + final_Am_Id1);
                    AllFinalAmount += +final_Am_Id1;
                });
                $('#FinalIssueAmount').val(AllFinalAmount.toFixed(2));
                $('#FinalTotalAmount').val(+AllFinalAmount.toFixed(2) + +$('#Deduction').val());
                // $('#FinalIncentive').val(+AllFinalAmount.toFixed(2) + +$('#Deduction').val());

            }
        });
        $.ajax({
            url: '@Url.Action("GetDocumentUploadIncentive", "ProjectManager")',
            type: "GET",
            dataType: "JSON",
            data: { employeeCode: selecteddropTextPersonEmpId, monthName: monthName, monNum: monNum, year: year },
            success: function (data) {

                console.log(data);
                $('#tblDoc tbody').empty();
                var items = $.parseJSON(data);

                $.each(items, function (index, obj) {
                    var newDate = new Date(obj.EffectiveMonth);
                    var effectiveMonth = moment(obj.EffectiveMonth).format('MM/DD/YYYY');
                    var day = newDate.getDate();
                    var month = newDate.getUTCMonth() + 1;
                    var year = newDate.getFullYear();

                    console.log(day + "-" + ("0" + (month)) + "-" + year);

                    var row = '<tr class="tableTrCls2" id="trIdForIncentive2"> <td id="doc_ProjectId" class="doc_ProjectId" style="display:none;">' + obj.ProjectIds + ' </td><td  id="doc_IncentiveType" class="doc_IncentiveType">' + obj.IncentiveType +
                        '</td><td id="doc_ProjectName" class="doc_ProjectName">' + obj.MultiProjectName + ' </td><td id="doc_Orders" class="doc_Orders">' + obj.Orders + '</td><td id="doc_EmployeeCode" class="doc_EmployeeCode">' + obj.EmployeeCode + '</td><td id="doc_EffectiveMonth" class="doc_EffectiveMonth">' + effectiveMonth +
                        '</td><td id="doc_AccessoriesType" class="doc_AccessoriesType">' + obj.AccessoriesType + '</td><td  id="doc_Remarks" class="doc_Remarks">' + obj.Remarks + '</td><td  id="doc_IsUpload" class="doc_IsUpload">' + obj.IsDocumentUploaded + '</td><td  id="doc_Currency" class="doc_Currency">' + obj.CurrencyType + '</td>' + '</td><td  id="doc_Amount" class="doc_Amount">' + obj.Amount + '</td>' +
                        '<td id="doc_FinalAmount1" class="doc_FinalAmount1"><input class="form-control doc_FinalAmount"  id="doc_FinalAmount" value=' + obj.Amount + ' " /></td></tr>';

                    $("#tblDoc tbody").append(row);
                });
               
                $("#tblDoc tr.tableTrCls2").each(function () {
                    var final_Am_Id1 = $.trim($(this).find('#doc_FinalAmount').val());
                    console.log("incentive :" + final_Am_Id1);
                    AllFinalAmount += +final_Am_Id1;
                });
                $('#FinalIssueAmount').val(AllFinalAmount.toFixed(2));
                $('#FinalTotalAmount').val(+AllFinalAmount.toFixed(2) + +$('#Deduction').val());
                // $('#FinalIncentive').val(+AllFinalAmount.toFixed(2) + +$('#Deduction').val());
            }
        });
        
        @*$.ajax({
            url: '@Url.Action("GetProjectClosingIncentive", "ProjectManager")',
            type: "GET",
            dataType: "JSON",
            data: { employeeCode: selecteddropTextPersonEmpId, monthName: monthName, monNum: monNum, year: year },
            success: function (data) {

                console.log(data);
                $('#tblProjectClosing tbody').empty();
                var items = $.parseJSON(data);

                $.each(items, function (index, obj) {
                    var newDate = new Date(obj.ProjectClosingDate);
                    var projectClosingDate = moment(obj.ProjectClosingDate).format('MM/DD/YYYY');
                    var day = newDate.getDate();
                    var month = newDate.getUTCMonth() + 1;
                    var year = newDate.getFullYear();
                    console.log(day + "-" + ("0" + (month)) + "-" + year);
                    
                    var newDate2 = new Date(obj.MarketClearanceDate);
                    var marketClearanceDate = moment(obj.MarketClearanceDate).format('MM/DD/YYYY');
                    var day2 = newDate2.getDate();
                    var month2 = newDate2.getUTCMonth() + 1;
                    var year2 = newDate2.getFullYear();

                    var row = '<tr class="tableTrCls2" id="trIdForIncentive2"> <td id="proClose_ProjectId" class="proClose_ProjectId" style="display:none;">' + obj.ProjectMasterId + ' </td><td  id="proClose_ProjectName" class="proClose_ProjectName">' + obj.ProjectName +
                        '</td><td id="proClose_Orders" class="proClose_Orders">' + obj.Orders + ' </td><td id="proClose_ProjectClosingDate" class="proClose_ProjectClosingDate">' + projectClosingDate + '</td><td id="proClose_MarketClearanceDate" class="proClose_MarketClearanceDate">' + marketClearanceDate + '</td><td id="proClose_EmployeeCode" class="proClose_EmployeeCode">' + obj.EmployeeCode +
                        '</td><td  id="proClose_Amount" class="proClose_Amount">' + obj.Amount + '</td>' +
                        '<td id="proClose_FinalAmount1" class="proClose_FinalAmount1"><input class="form-control proClose_FinalAmount"  id="proClose_FinalAmount" value=' + obj.Amount + ' disabled="disabled" /></td></tr>';

                    $("#tblProjectClosing tbody").append(row);
                });

                $("#tblProjectClosing tr.tableTrCls2").each(function () {
                    var final_Am_Id1 = $.trim($(this).find('#proClose_FinalAmount').val());
                    console.log("incentive :" + final_Am_Id1);
                    AllFinalAmount += +final_Am_Id1;
                });
                $('#FinalIssueAmount').val(AllFinalAmount.toFixed(2));
                $('#FinalTotalAmount').val(+AllFinalAmount.toFixed(2) + +$('#Deduction').val());
                // $('#FinalIncentive').val(+AllFinalAmount.toFixed(2) + +$('#Deduction').val());
            }
        });*@
        $.ajax({
            url: '@Url.Action("GetRawMaterialDelayUploadIncentive", "ProjectManager")',
            type: "GET",
            dataType: "JSON",
            data: { employeeCode: selecteddropTextPersonEmpId, monthName: monthName, monNum: monNum, year: year },
            success: function (data) {

                console.log(data);
                $('#tblRawMaterialDelay tbody').empty();
                var items = $.parseJSON(data);

                $.each(items, function (index, obj) {
                    var newDate = new Date(obj.ProjectClosingDate);
                    var projectManagerClearanceDate = moment(obj.ProjectManagerClearanceDate).format('MM/DD/YYYY');
                    var day = newDate.getDate();
                    var month = newDate.getUTCMonth() + 1;
                    var year = newDate.getFullYear();
                    console.log(day + "-" + ("0" + (month)) + "-" + year);

                    var newDate2 = new Date(obj.MarketClearanceDate);
                    var rawMaterialAddedDate = moment(obj.RawMaterialAddedDate).format('MM/DD/YYYY');
                    var day2 = newDate2.getDate();
                    var month2 = newDate2.getUTCMonth() + 1;
                    var year2 = newDate2.getFullYear();

                    var row = '<tr class="tableTrCls2" id="trIdForIncentive2"> <td id="delay_ProjectId" class="delay_ProjectId" style="display:none;">' + obj.ProjectMasterId + ' </td><td  id="delay_ProjectName" class="delay_ProjectName">' + obj.ProjectName +
                        '</td><td id="delay_Orders" class="delay_Orders">' + obj.Orders + ' </td><td id="delay_PoCategory" class="delay_PoCategory">' + obj.PoCategory + '</td><td id="delay_PoQuantity" class="delay_PoQuantity">' + obj.PoQuantity + '</td><td id="delay_PmClearanceDate" class="delay_PmClearanceDate">' +projectManagerClearanceDate +
                        '</td><td  id="delay_rawAddedDate" class="delay_rawAddedDate">' + rawMaterialAddedDate + '</td>' +
                        '</td><td  id="delay_DaysPassed" class="delay_DaysPassed">' + obj.DaysPassed + '</td>' +
                        '</td><td  id="delay_EmployeeCode" class="delay_EmployeeCode">' + obj.EmployeeCode + '</td>' +
                        '</td><td  id="delay_IncentiveName" class="delay_IncentiveName" style="display:none">' + obj.IncentiveName + '</td>' +
                        '</td><td  id="delay_Amount" class="delay_Amount">' + obj.Amount + '</td>' +
                        '<td id="delay_FinalAmount1" class="delay_FinalAmount1"><input class="form-control delay_FinalAmount"  id="delay_FinalAmount" value=' + obj.Amount + ' disabled="disabled" /></td></tr>';

                    $("#tblRawMaterialDelay tbody").append(row);
                });

                $("#tblRawMaterialDelay tr.tableTrCls2").each(function () {
                    var final_Am_Id1 = $.trim($(this).find('#delay_FinalAmount').val());
                    console.log("incentive :" + final_Am_Id1);
                    AllFinalAmount += +final_Am_Id1;
                });
                $('#FinalIssueAmount').val(AllFinalAmount.toFixed(2));
                $('#FinalTotalAmount').val(+AllFinalAmount.toFixed(2) + +$('#Deduction').val());
                // $('#FinalIncentive').val(+AllFinalAmount.toFixed(2) + +$('#Deduction').val());
            }
        });
        $.ajax({
            url: '@Url.Action("GetShipClearenceVsLsdIncentive", "ProjectManager")',
            type: "GET",
            dataType: "JSON",
            data: { employeeCode: selecteddropTextPersonEmpId, monthName: monthName, monNum: monNum, year: year },
            success: function (data) {

                console.log(data);
                $('#tblShipClearance tbody').empty();
                var items = $.parseJSON(data);

                $.each(items, function (index, obj) {
                    var newDate = new Date(obj.ProjectClosingDate);
                    var projectManagerClearanceDate = moment(obj.ProjectManagerClearanceDate).format('MM/DD/YYYY');
                    var day = newDate.getDate();
                    var month = newDate.getUTCMonth() + 1;
                    var year = newDate.getFullYear();
                    console.log(day + "-" + ("0" + (month)) + "-" + year);

                    var newDate2 = new Date(obj.MarketClearanceDate);
                    var lsd = moment(obj.LSD).format('MM/DD/YYYY');
                    var day2 = newDate2.getDate();
                    var month2 = newDate2.getUTCMonth() + 1;
                    var year2 = newDate2.getFullYear();

                    var row = '<tr class="tableTrCls2" id="trIdForIncentive2"> <td id="ship_ProjectId" class="ship_ProjectId" style="display:none;">' + obj.ProjectMasterId + ' </td><td  id="ship_ProjectName" class="ship_ProjectName">' + obj.ProjectName +
                        '</td><td id="ship_Orders" class="ship_Orders">' + obj.Orders + ' </td><td id="ship_ProjectType" class="ship_ProjectType">' + obj.ProjectType + '</td><td id="ship_PoCategory" class="ship_PoCategory">' + obj.PoCategory + '</td><td id="ship_PmClearanceDate" class="ship_PmClearanceDate">' + projectManagerClearanceDate +
                        '</td><td  id="ship_lsd" class="ship_lsd">' + lsd + '</td>' +
                        '</td><td  id="ship_DaysBeforeLsd" class="ship_DaysBeforeLsd">' + obj.DaysBeforeLsd + '</td>' +
                        '</td><td  id="ship_DaysAfterLsd" class="ship_DaysAfterLsd">' + obj.DaysAfterLsd + '</td>' +
                        '</td><td  id="ship_Reward" class="ship_Reward">' + obj.Reward + '</td>' +
                        '</td><td  id="ship_RealPenalties" class="ship_RealPenalties">' + obj.RealPenalties + '</td>' +
                        '</td><td  id="ship_Penalties" class="ship_Penalties">' + obj.Penalties + '</td>' +
                        '</td><td  id="ship_EmployeeCode" class="ship_EmployeeCode">' + obj.EmployeeCode + '</td>' +
                        '</td><td  id="ship_Amount" class="ship_Amount">' + obj.FinalAmount + '</td>' +
                        '<td id="ship_FinalAmount1" class="ship_FinalAmount1"><input class="form-control ship_FinalAmount"  id="ship_FinalAmount" value=' + obj.Amount + ' disabled="disabled" /></td></tr>';

                    $("#tblShipClearance tbody").append(row);
                });

                $("#tblShipClearance tr.tableTrCls2").each(function () {
                    var final_Am_Id1 = $.trim($(this).find('#ship_FinalAmount').val());
                    console.log("incentive :" + final_Am_Id1);
                    AllFinalAmount += +final_Am_Id1;
                });
                $('#FinalIssueAmount').val(AllFinalAmount.toFixed(2));
                $('#FinalTotalAmount').val(+AllFinalAmount.toFixed(2) + +$('#Deduction').val());
                // $('#FinalIncentive').val(+AllFinalAmount.toFixed(2) + +$('#Deduction').val());
            }
        });
        @*$.ajax({
            url: '@Url.Action("GetShipmentRelatedProject", "ProjectManager")',
            type: "GET",
            dataType: "JSON",
            data: { employeeCode: selecteddropTextPersonEmpId },
            success: function (data) {

                console.log(data);
                $('#tbl3 tbody').empty();
                var items = $.parseJSON(data);
                $.each(items, function (index, obj) {
                    var newDate = new Date(obj.ApproxShipmentDate);
                    var ApproxShipmentDate = moment(obj.ApproxShipmentDate).format('MM/DD/YYYY');
                    var day = newDate.getDate();
                    var month = newDate.getUTCMonth() + 1;
                    var year = newDate.getFullYear();

                    var newDate1 = new Date(obj.FlightDepartureDate);
                    var pmClearanceDate = moment(obj.FlightDepartureDate).format('MM/DD/YYYY');
                    var day1 = newDate1.getDate();
                    var month1 = newDate1.getUTCMonth() + 1;
                    var year1 = newDate1.getFullYear();

                    console.log(day + "-" + ("0" + (month)) + "-" + year);
                    console.log(day1 + "-" + ("0" + (month1)) + "-" + year1);
                    var row = ' <tr class="tableTrCls3" id="trIdForIncentive3"> <td id="ship_ProjectName" class="ship_ProjectName">' + obj.ProjectName + ' </td><td  id="ship_ProjectId" class="ship_ProjectId" style="display:none;">' + obj.ProjectId +
                        ' </td><td id="ship_EmployeeCode" class="ship_EmployeeCode">' + obj.EmployeeCode + ' </td><td id="ship_ProjectType" class="ship_ProjectType">' + obj.ProjectType + '</td><td id="ship_ApproxShipmentDate" class="ship_ApproxShipmentDate">' + ApproxShipmentDate + '</td><td id="ship_ChainaInspectionDate" class="ship_ChainaInspectionDate">' + pmClearanceDate +
                        ' </td><td id="ship_NoOfdays" class="ship_NoOfdays">' + obj.NoOfdays + ' </td><td id="ship_Order" class="ship_Order">' + obj.OrderNumber + '</td><td id="ship_Amount" class="ship_Amount">' + obj.Amount + '</td><td  id="ship_ProjectManagerUserId" class="ship_ProjectManagerUserId" style="display:none;">' + obj.ProjectManagerUserId + '</td><td><input class="form-control ship_Remarks" id="ship_Remarks">' + "" + '</input></td><td  class="ship_D_Amount" id="ship_D_Amount">' + obj.DeductionAmount.toFixed(4) + '</td><td><input class="form-control ship_D_Remarks"  id="ship_D_Remarks">' + "" + '</input></td><td  class="ship_finalAmount" id="ship_finalAmount">' + obj.FinalAmount.toFixed(4) + '</td></tr>';
                    $("#tbl3 tbody").append(row);
                });
            }
        });*@

        @*$.ajax({
            url: '@Url.Action("GetPiRelatedProject", "ProjectManager")',
            type: "POST",
            dataType: "JSON",
            data: { employeeCode: selecteddropTextPersonEmpId, monthName: monthName, monNum: monNum, year: year },

            success: function (data) {

                console.log(data);
                $('#tblForPi tbody').empty();
                var items = $.parseJSON(data);
                $.each(items, function (index, obj) {
                    var newDate = new Date(obj.PoDate);
                    var poDate = moment(obj.PoDate).format('YYYY-MM-DD');
                    var day = newDate.getDate();
                    var month = newDate.getUTCMonth() + 1;
                    var year = newDate.getFullYear();

                    var newDate1 = new Date(obj.ClosingDate);
                    var closingDate = moment(obj.ClosingDate).format('YYYY-MM-DD');
                    var day1 = newDate1.getDate();
                    var month1 = newDate1.getUTCMonth() + 1;
                    var year1 = newDate1.getFullYear();

                    //console.log(day + "-" + ("0" + (month)) + "-" + year);
                    //console.log(day1 + "-" + ("0" + (month1)) + "-" + year1);

                    var row = ' <tr class="tableTrCls3" id="trIdForIncentive3"> <td id="pi_ProjectName" class="pi_ProjectName">' + obj.ProjectName + ' </td><td  id="pi_ProjectId" class="pi_ProjectId" style="display:none;">' + obj.ProjectId +
                        ' </td><td id="pi_EmployeeCode" class="pi_EmployeeCode">' + obj.EmployeeCode + ' </td><td id="pi_PoCategory" class="pi_PoCategory">' + obj.PoCategory + '</td><td id="pi_PoDate" class="pi_PoDate">' + poDate + '</td><td id="pi_OrderNumber" class="pi_OrderNumber">' + obj.OrderNumber +
                        ' </td><td id="pi_ProjectManagerUserId" class="pi_ProjectManagerUserId" style="display:none;">' + obj.ProjectManagerUserId + ' </td><td id="pi_ClosingMonth" class="pi_ClosingMonth">' + obj.MonthName + ' </td><td id="pi_ClosingDate" class="pi_ClosingDate">' + closingDate + ' </td><td id="pi_ClosingType" class="pi_ClosingType">' + obj.ClosingType + ' </td><td id="pi_Amount" class="pi_Amount">' + obj.ClosingAmount + '</td><td><input class="form-control pi_Remarks" id="pi_Remarks">' + "" + '</input></td><td><input class="form-control pi_DeductAmount" id="pi_DeductAmount">' + "" + '</input></td><td><input class="form-control pi_D_Remarks"  id="pi_D_Remarks">' + "" + '</input></td></tr>';
                    $("#tblForPi tbody").append(row);
                });
                $("#tblForPi tr.tableTrCls2").each(function () {
                    var final_Am_Id1 = $.trim($(this).find('td:eq(10)').text());
                    console.log("incentive :" + final_Am_Id1);
                    AllFinalAmount += +final_Am_Id1;
                });
                $('#FinalIssueAmount').val(AllFinalAmount.toFixed(2));
                $('#FinalTotalAmount').val(+AllFinalAmount.toFixed(2) + +$('#Deduction').val());
                // $('#FinalIncentive').val(+AllFinalAmount.toFixed(2) + +$('#Deduction').val());

            }
        });*@
        $.ajax({
            url: '@Url.Action("GetProductionReward", "ProjectManager")',
            type: "POST",
            dataType: "JSON",
            data: { employeeCode: selecteddropTextPersonEmpId, monthName: monthName, monNum: monNum, year: year },
            success: function (data) {
                console.log(data);
                $('#tblProduction tbody').empty();
                var items = $.parseJSON(data);
                $.each(items, function (index, obj) {
                    var warehouseDate = moment(obj.WarehouseEntryDate).format('YYYY-MM-DD');
                    var extendedWarehouseDate = moment(obj.ExtendedWarehouseDate).format('YYYY-MM-DD');
                    //debugger;
                    var row = ' <tr class="tableTrCls2" id="trIdForIncentive2"> <td id="pro_ProjectId" class="pro_ProjectId" style="display:none;">' + obj.ProjectMasterID + ' </td><td  id="pro_ProjectModel" class="pro_ProjectModel">' + obj.ProjectModel +
                        ' </td><td id="pro_EmployeeCode" class="pro_EmployeeCode">' + obj.EmployeeCode + ' </td><td id="pro_UserFullName" class="pro_UserFullName" style="display:none;">' + obj.UserFullName + ' </td><td id="pro_SourcingType" class="pro_SourcingType">' + obj.SourcingType + '</td><td id="pro_WpmsOrders" class="pro_WpmsOrders">' + obj.WpmsOrders + '</td><td id="pro_WarehouseEntryDate" class="pro_WarehouseEntryDate">' + warehouseDate +
                        '</td><td id="pro_ExtendedWarehouseDate" class="pro_ExtendedWarehouseDate" style="display:none;">' + extendedWarehouseDate + '</td><td  id="pro_ProjectManagerUserId" class="pro_ProjectManagerUserId" style="display:none;">' + obj.ProjectManagerUserId + '</td><td  id="pro_OrderQuantity" class="pro_OrderQuantity">' + obj.OrderQuantity + '</td>' +
                        '<td  id="pro_TotalProductionQuantity" class="pro_TotalProductionQuantity">' + obj.TotalProductionQuantity + '</td><td  id="pro_EffectiveDays" class="pro_EffectiveDays">' + obj.EffectiveDays + '</td><td  id="pro_RewardPercentage" class="pro_RewardPercentage">' + obj.RewardPercentage + '</td>' +
                        '<td  id="pro_ExistedPercentage" class="pro_ExistedPercentage">' + obj.ExistedPercentage + '</td><td  id="pro_RewardAmount" class="pro_RewardAmount">' + obj.RewardAmount + '</td><td><input class="form-control pro_DeductAmount" id="pro_DeductAmount"  onchange="productionDeduct(this.value)">' + "" + '</input></td></tr>';
                    $("#tblProduction tbody").append(row);
                });
                $("#tblProduction tr.tableTrCls2").each(function () {
                    var final_Am_Id1 = $.trim($(this).find('td:eq(14)').text());
                    console.log("incentive :" + final_Am_Id1);
                    AllFinalAmount += +final_Am_Id1;
                });
                $('#FinalIssueAmount').val(AllFinalAmount.toFixed(2));
                $('#FinalTotalAmount').val(+AllFinalAmount.toFixed(2) + +$('#Deduction').val());
                //$('#FinalIncentive').val(+AllFinalAmount.toFixed(2) + +$('#Deduction').val());

            }
        });
        @*$.ajax({
            url: '@Url.Action("GetSoldOutRewardData", "ProjectManager")',//'/ProjectManager/GetPoProject',
            type: "POST",
            dataType: "JSON",
            data: { employeeCode: selecteddropTextPersonEmpId, monthName: monthName, monNum: monNum, year: year },
            success: function (data) {
                console.log(data);
                $('#tblSalesOut tbody').empty();
                var items = $.parseJSON(data);
                $.each(items, function (index, obj) {
                    var warehouseDate = moment(obj.WarehouseEntryDate).format('YYYY-MM-DD');
                    var extendedWarehouseDate = moment(obj.ExtendedWarehouseDate).format('YYYY-MM-DD');

                    var row = ' <tr class="tableTrCls2" id="trIdForIncentive2"> <td id="pro_ProjectId" class="pro_ProjectId" style="display:none;">' + obj.ProjectMasterID + ' </td><td  id="pro_ProjectModel" class="pro_ProjectModel">' + obj.ProjectModel +
                        ' </td><td id="pro_EmployeeCode" class="pro_EmployeeCode">' + obj.EmployeeCode + ' </td><td id="pro_UserFullName" class="pro_UserFullName" style="display:none;">' + obj.UserFullName + ' </td><td id="pro_WpmsOrders" class="pro_WpmsOrders">' + obj.Orders + '</td><td id="pro_WarehouseEntryDate" class="pro_WarehouseEntryDate">' + warehouseDate +
                        '</td><td id="pro_ExtendedWarehouseDate" class="pro_ExtendedWarehouseDate" style="display:none;">' + extendedWarehouseDate + '</td><td  id="pro_ProjectManagerUserId" class="pro_ProjectManagerUserId" style="display:none;">' + obj.ProjectManagerUserId + '</td><td  id="pro_EffectiveDays" class="pro_EffectiveDays">' + obj.EffectiveDays + '</td><td  id="pro_OrderQuantity" class="pro_OrderQuantity">' + obj.OrderQuantity + '</td>' +
                        '<td  id="pro_TotalTblBarcodeIMEI" class="pro_TotalTblBarcodeIMEI" style="display:none;">' + obj.TotalTblBarcodeIMEI + '</td><td  id="pro_TotalSalesOut" class="pro_TotalSalesOut">' + obj.TotalSalesOut + '</td><td  id="pro_RewardPercentage" class="pro_RewardPercentage">' + obj.RewardPercentage + '</td>' +
                        '<td  id="pro_ExistedPercentage" class="pro_ExistedPercentage">' + obj.ExistedPercentage + '</td><td  id="pro_RewardAmount" class="pro_RewardAmount">' + obj.RewardAmount + '</td><td><input class="form-control pro_DeductAmount" id="pro_DeductAmount" onchange="salesDeduct(this.value)">' + "" + '</input></td></tr>';
                    $("#tblSalesOut tbody").append(row);

                });
                $("#tblSalesOut tr.tableTrCls2").each(function () {
                    var final_Am_Id1 = $.trim($(this).find('td:eq(14)').text());
                    console.log("incentive :" + final_Am_Id1);
                    AllFinalAmount += +final_Am_Id1;
                });
                $('#FinalIssueAmount').val(AllFinalAmount.toFixed(2));
                $('#FinalTotalAmount').val(+AllFinalAmount.toFixed(2) + +$('#Deduction').val());
               // $('#FinalIncentive').val(+AllFinalAmount.toFixed(2) + +$('#Deduction').val());

            }
        });*@
        @*$.ajax({
            url: '@Url.Action("GetPmAndQcLsdToVesselData", "ProjectManager")',
            type: "POST",
            dataType: "JSON",
            data: { employeeCode: selecteddropTextPersonEmpId, monthName: monthName, monNum: monNum, year: year },
            success: function (data) {
                console.log(data);
                $('#tblVessel tbody').empty();
                var items = $.parseJSON(data);
                $.each(items, function (index, obj) {
                    var poDate = moment(obj.PoDate).format('YYYY-MM-DD');
                    var lsdDate = moment(obj.LSD).format('YYYY-MM-DD');
                    var vesselDate = moment(obj.VesselDate).format('YYYY-MM-DD');

                    var row = ' <tr class="tableTrCls2" id="trIdForIncentive2"> <td id="pro_ProjectId" class="pro_ProjectId" style="display:none;">' + obj.ProjectMasterID + ' </td><td  id="pro_ProjectModel" class="pro_ProjectModel">' + obj.ProjectName +
                        ' </td><td id="pro_EmployeeCode" class="pro_EmployeeCode">' + obj.EmployeeCode + ' </td><td id="pro_UserFullName" class="pro_UserFullName" style="display:none;">' + obj.UserFullName + ' </td>' +
                        '<td  id="pro_ProjectManagerUserId" class="pro_ProjectManagerUserId" style="display:none;">' + obj.ProjectManagerUserId + '</td><td id="pro_ProjectType" class="pro_ProjectType">' + obj.ProjectType + '</td><td id="pro_WpmsOrders" class="pro_WpmsOrders">' + obj.Orders + '</td><td id="pro_PoDate" class="pro_PoDate">' + poDate +
                        '</td><td id="pro_LSDDate" class="pro_LSDDate">' + lsdDate + '</td><td  id="pro_PoVsLSDDiff" class="pro_PoVsLSDDiff">' + obj.PoVsLSDDiff + '</td><td  id="pro_VesselDate" class="pro_VesselDate">' + vesselDate + '</td>' +
                        '<td  id="LsdVsVeselDiffForDeduct" class="LsdVsVeselDiffForDeduct">' + obj.LsdVsVesselDiffForDeduct + '</td><td  id="DeductPoint" class="DeductPoint">' + obj.DeductPoint + '</td><td  id="DeductedAmount" class="DeductedAmount">' + obj.DeductedAmount + '</td>' +
                        '<td  id="LsdVsVeselDiffForReward" class="LsdVsVeselDiffForReward">' + obj.LsdVsVesselDiffForReward + '</td><td  id="RewardPoint" class="RewardPoint">' + obj.RewardPoint + '</td><td  id="RewardAmount" class="RewardAmount">' + obj.RewardAmount + '</td></tr>';
                    $("#tblVessel tbody").append(row);

                });

                $("#tblVessel tr.tableTrCls2").each(function () {
                    var final_Am_Id1 = $.trim($(this).find('td:eq(13)').text());
                    console.log("incentive :" + final_Am_Id1);

                    AllPenalties += -final_Am_Id1;
                    //
                });
                $('#Deduction').val(AllPenalties.toFixed(2));

                $("#tblVessel tr.tableTrCls2").each(function () {
                    var final_Am_Id1 = $.trim($(this).find('td:eq(16)').text());
                    console.log("incentive :" + final_Am_Id1);

                    AllFinalAmount += +final_Am_Id1;
                });
                $('#FinalIssueAmount').val(AllFinalAmount.toFixed(2));
                $('#FinalTotalAmount').val(+AllFinalAmount.toFixed(2) + +$('#Deduction').val());
                //$('#FinalIncentive').val(+AllFinalAmount.toFixed(2) + +$('#Deduction').val());

            }
        });*@
        //All Amount Sum


    }
 
    function LoadProject1() {
        var selectedPersonText = document.getElementById('sltPerson1');
        var selecteddropTextPersonName = selectedPersonText.options[selectedPersonText.selectedIndex].text;
        var selecteddropTextPersonEmpId = selectedPersonText.options[selectedPersonText.selectedIndex].value;
        console.log("selecteddropTextPersonName  :" + selecteddropTextPersonName);
        console.log("selecteddropTextPersonEmpId  :" + selecteddropTextPersonEmpId);
        $.ajax({
            url: '@Url.Action("GetProject", "ProjectManager")',//'/ProjectManager/GetProject',
            type: "GET",
            dataType: "JSON",
            data: { employeeCode: selecteddropTextPersonEmpId },
            success: function (data) {

                console.log(data);
                $('#projectIdForOthers').empty();
                $('#projectIdForOthers').append($('<option>', {
                    value: '',
                    text: 'SELECT PROJECT'
                }));
                var items = $.parseJSON(data);
                $.each(items, function (i, item) {
                    $('#projectIdForOthers').append($('<option>', {
                        value: item.Value,
                        text: item.Text
                    }));
                });
            }
        });
    }

    //function removeDetailRow(element) {
    //    var detailRow = $(element).closest('tr');
    //    $(detailRow).remove();
    //}

    //salesDeduct
    function salesDeduct(element) {
        if (element == "") {
            $('#Deduction').val(AllPenalties.toFixed(2));
            $('#FinalTotalAmount').val(+$('#FinalIssueAmount').val() + +$('#Deduction').val());
            //   $('#FinalIncentive').val(+$('#FinalIssueAmount').val() + +$('#Deduction').val());
        } else {
            //  var detailRow = $(element).closest('tr');
            var finals = +element;
            var allFinals = -$('#Deduction').val();

            var allFinals2 = - +allFinals - +finals;
            $('#Deduction').val(allFinals2.toFixed(2));

            $('#FinalTotalAmount').val(+$('#FinalIssueAmount').val() + +$('#Deduction').val());
            //  $('#FinalIncentive').val(+$('#FinalIssueAmount').val() + +$('#Deduction').val());
        }

    }
    //productionDeduct
    function productionDeduct(element) {
        if (element == "") {
            $('#Deduction').val(AllPenalties.toFixed(2));
            $('#FinalTotalAmount').val(+$('#FinalIssueAmount').val() + +$('#Deduction').val());
            // $('#FinalIncentive').val(+$('#FinalIssueAmount').val() + +$('#Deduction').val());
        } else {
            //  var detailRow = $(element).closest('tr');
            var finals = +element;
            var allFinals = -$('#Deduction').val();

            var allFinals2 = - +allFinals - +finals;
            $('#Deduction').val(allFinals2.toFixed(2));

            $('#FinalTotalAmount').val(+$('#FinalIssueAmount').val() + +$('#Deduction').val());
            //  $('#FinalIncentive').val(+$('#FinalIssueAmount').val() + +$('#Deduction').val());
        }

    }
    function repeatOrderDeduct(element) {

        if (element == "") {
            $('#Deduction').val(AllPenalties.toFixed(2));
            $('#FinalTotalAmount').val(+$('#FinalIssueAmount').val() + +$('#Deduction').val());
            // $('#FinalIncentive').val(+$('#FinalIssueAmount').val() + +$('#Deduction').val());

        } else {
            //  var detailRow = $(element).closest('tr');
            var finals = +element;
            var allFinals = -$('#Deduction').val();

            var allFinals2 = - +allFinals - +finals;
            $('#Deduction').val(allFinals2.toFixed(2));
            $('#FinalTotalAmount').val(+$('#FinalIssueAmount').val() + +$('#Deduction').val());
            //  $('#FinalIncentive').val(+$('#FinalIssueAmount').val() + +$('#Deduction').val());
        }

    }
    //function uploadedDocDeduct(element) {

    //    if (element.trim() == "") {
    //        element = 0;
    //        $('#doc_FinalAmount').val(+$('#doc_Amount').text());

    //    } else {
    //        var allFinals = -$('#doc_DeductAmount').val();
    //        $('#doc_FinalAmount').val(+$('#doc_FinalAmount').val() + +allFinals);
    //    }
    //}
   
    //function FinalAddedAmountChange()
    //{
    //    var FinalTotalAmount = $('#FinalTotalAmount').val();
    //    var FinalAddedAmount = $('#FinalAddedAmount').val();
    //    var FinalDeduction = $('#FinalDeduction').val();
    //    var finals = 0;

    //    if (FinalTotalAmount != "") {
    //        finals = (+FinalTotalAmount + +FinalAddedAmount - +FinalDeduction);
    //        $('#FinalIncentive').val(finals.toFixed(2));

    //    } else {
    //        $('#FinalIncentive').val(FinalTotalAmount);
    //    }
    //}
    //function FinalDeductionChange() {
    //    var FinalTotalAmount = $('#FinalTotalAmount').val();
    //    var FinalDeduction = $('#FinalDeduction').val();
    //    var FinalAddedAmount = $('#FinalAddedAmount').val();
    //    var finals = 0;

    //    if (FinalTotalAmount != "") {
    //        finals = (+FinalTotalAmount + +FinalAddedAmount - +FinalDeduction);
    //        $('#FinalIncentive').val(finals);

    //    } else {
    //        $('#FinalIncentive').val(FinalTotalAmount);
    //    }
    //}
    $(document).on('submit', 'form', function () {
        var buttons = $(this).find('[type="submit"]');
        if ($(this).valid()) {
            buttons.each(function (btn) {
                $(buttons[btn]).prop('disabled', true);
            });
        } else {
            buttons.each(function (btn) {
                $(buttons[btn]).prop('disabled', false);
            });
        }
    });
    function winLoads() {
        windows.load();
    }
    function PoDetailsPageFunc() {
        var selectedPersonText = document.getElementById('sltPerson');
        var selecteddropTextPersonName = selectedPersonText.options[selectedPersonText.selectedIndex].text;
        var selecteddropTextPersonEmpId = selectedPersonText.options[selectedPersonText.selectedIndex].value;
        console.log("selecteddropTextPersonName  :" + selecteddropTextPersonName);
        console.log("selecteddropTextPersonEmpId  :" + selecteddropTextPersonEmpId);

        var monthName = $('#DDDMonth option:selected').text();
        var monNum = $('#DDDMonth option:selected').val();
        var year = $('#DDDYear option:selected').val();


        window.open('@Url.Action("PoDetailsPageForPmHead", "ProjectManager")' + '?EmpCode=' + selecteddropTextPersonEmpId +
            '&Month=' + monthName + '&MonNum=' + monNum + '&Year=' + year);

    }
    //RatioWisePenaltiesPageFunc
    function RatioWisePenaltiesPageFunc() {
        var selectedPersonText = document.getElementById('sltPerson');
        var selecteddropTextPersonName = selectedPersonText.options[selectedPersonText.selectedIndex].text;
        var selecteddropTextPersonEmpId = selectedPersonText.options[selectedPersonText.selectedIndex].value;
        console.log("selecteddropTextPersonName  :" + selecteddropTextPersonName);
        console.log("selecteddropTextPersonEmpId  :" + selecteddropTextPersonEmpId);

        var monthName = $('#DDDMonth option:selected').text();
        var monNum = $('#DDDMonth option:selected').val();
        var year = $('#DDDYear option:selected').val();


        window.open('@Url.Action("RatioWisePenaltiesForPmHead", "ProjectManager")' + '?EmpCode=' + selecteddropTextPersonEmpId +
            '&Month=' + monthName + '&MonNum=' + monNum + '&Year=' + year);

    }
</script>
