@using System.Diagnostics
@model ProjectManagement.Models.Custom_Pm_IncentiveModel

<div class="portlet box green-seagreen">
    <div class="portlet-title">
        <div class="caption">
            Welcome to Monthly Incentive Sheet of Project Manager
        </div>

    </div>
    <div class="portlet-body form">
        <br /><br /><br />
        <div class="row">
            <div class="col-lg-12">
                <div class="col-lg-5">
                    <div class="col-lg-3" style="color: brown;">Select Person</div>
                    <div class="col-lg-9">
                        @if (Model != null && Model.CmnUserModelsList.Any())
                        {
                            <div class="col-lg-12">
                                @Html.DropDownListFor(model => model.EmployeeCode, new SelectList(@Model.CmnUserModelsList, "EmployeeCode", "UserFullName"), "SELECT PERSON", new { @class = "dropForPerson form-control", @id = "sltPerson", Value = @Model.CmnUserModel.UserFullName })
                            
                            </div>
                        }
                    </div>
                </div>
                <div class="col-lg-3">
                    <div class="col-lg-5" style="color: brown;">Select Month</div>
                    <div class="col-lg-7">
                        @{
                            List<SelectListItem> listItems = new List<SelectListItem>();

                            listItems.Add(new SelectListItem
                            {
                                Text = "SELECT MONTH",
                                Value = "0"
                            });

                            listItems.Add(new SelectListItem
                            {
                                Text = "January",
                                Value = "1"
                            });
                            listItems.Add(new SelectListItem
                            {
                                Text = "February",
                                Value = "2",
                            });
                            listItems.Add(new SelectListItem
                            {
                                Text = "March",
                                Value = "3"
                            });
                            listItems.Add(new SelectListItem
                            {
                                Text = "April",
                                Value = "4"
                            });
                            listItems.Add(new SelectListItem
                            {
                                Text = "May",
                                Value = "5"
                            });
                            listItems.Add(new SelectListItem
                            {
                                Text = "June",
                                Value = "6"
                            });
                            listItems.Add(new SelectListItem
                            {
                                Text = "July",
                                Value = "7"
                            });
                            listItems.Add(new SelectListItem
                            {
                                Text = "August",
                                Value = "8"
                            });
                            listItems.Add(new SelectListItem
                            {
                                Text = "September",
                                Value = "9"
                            });
                            listItems.Add(new SelectListItem
                            {
                                Text = "October",
                                Value = "10"
                            });
                            listItems.Add(new SelectListItem
                            {
                                Text = "Nobember",
                                Value = "11"
                            });
                            listItems.Add(new SelectListItem
                            {
                                Text = "December",
                                Value = "12"
                            });
                        }
                        @Html.DropDownList("DDDMonth", new SelectList(listItems, "Value", "Text"), new { @class = "form-control DDDMonthCls1" })
                    </div>
                </div>
                <div class="col-lg-3">
                    <div class="col-lg-5" style="color: brown;">Select Year</div>
                    <div class="col-lg-7">
                        @{
                            List<SelectListItem> listItems2 = new List<SelectListItem>();
                            //listItems2.Add(new SelectListItem
                            //{
                            //    Text = "2015",
                            //    Value = "2015"
                            //});
                            //listItems2.Add(new SelectListItem
                            //{
                            //    Text = "2016",
                            //    Value = "2016",
                            //});
                            //listItems2.Add(new SelectListItem
                            //{
                            //    Text = "2017",
                            //    Value = "2017"
                            //});
                            listItems2.Add(new SelectListItem
                            {
                                Text = "2018",
                                Value = "2018"
                            });
                            listItems2.Add(new SelectListItem
                            {
                                Text = "2019",
                                Value = "2019"
                            });
                            listItems2.Add(new SelectListItem
                            {
                                Text = "2020",
                                Value = "2010"
                            });
                            listItems2.Add(new SelectListItem
                            {
                                Text = "2021",
                                Value = "2021"
                            });
                            listItems2.Add(new SelectListItem
                            {
                                Text = "2022",
                                Value = "2022"
                            });
                            listItems2.Add(new SelectListItem
                            {
                                Text = "2023",
                                Value = "2023"
                            });
                            listItems2.Add(new SelectListItem
                            {
                                Text = "2024",
                                Value = "2024"
                            });
                            listItems2.Add(new SelectListItem
                            {
                                Text = "2025",
                                Value = "2025"
                            });
                            listItems2.Add(new SelectListItem
                            {
                                Text = "2026",
                                Value = "2026"
                            });
                            listItems2.Add(new SelectListItem
                            {
                                Text = "2027",
                                Value = "2027"
                            });
                            listItems2.Add(new SelectListItem
                            {
                                Text = "2028",
                                Value = "2028"
                            });
                            listItems2.Add(new SelectListItem
                            {
                                Text = "2029",
                                Value = "2029"
                            });
                            listItems2.Add(new SelectListItem
                            {
                                Text = "2030",
                                Value = "2030"
                            });
                        }
                        @Html.DropDownList("DDDYear", new SelectList(listItems2, "Value", "Text"), "SELECT YEAR", new { @class = "form-control DDDYearCls" })
                    </div>
                </div>
                <div class="col-lg-1"></div>
            </div>

        </div>
        <br /><br /><br />
        <div class="form-actions">
            <div class="row">
                <div class="col-md-6" style="text-align: center">
                    <input class="btn sbold uppercase btn-outline red" type="submit" id="btnPrint" value="Print Per Person Sheet" />
                </div>
                <div class="col-md-6" style="text-align: center">
                    <input class="btn sbold uppercase btn-outline blue" type="submit" id="btnPrintForTopSheet" value="Print Top Sheet" />
                </div>
            </div>
        </div>
        <br /><br /><br />
        <div class="row">


            <div class="col-lg-12">
                <div class="col-lg-5">
                    <div class="col-lg-5" style="color: brown;">Select Person</div>
                    <div class="col-lg-7">
                        @if (Model != null && Model.CmnUserModelsList.Any())
                        {

                          
                                @Html.DropDownListFor(model => model.EmployeeCode, new SelectList(@Model.CmnUserModelsList, "EmployeeCode", "UserFullName"), "SELECT PERSON", new { @class = "dropForPerson2 form-control", @id = "sltPerson2", Value = @Model.CmnUserModel.UserFullName })


                        

                        }


                    </div>

                </div>
               
                <div class="col-lg-2"></div>
                <div class="col-lg-5">
                    <div class="col-lg-5" style="color: brown;"> Select Year</div>
                    <div class="col-lg-7">
                        @{
                            List<SelectListItem> listItems3 = new List<SelectListItem>();
                            listItems3.Add(new SelectListItem
                            {
                                Text = "2015",
                                Value = "2015"
                            });
                            listItems3.Add(new SelectListItem
                            {
                                Text = "2016",
                                Value = "2016",
                            });
                            listItems3.Add(new SelectListItem
                            {
                                Text = "2017",
                                Value = "2017"
                            });
                            listItems3.Add(new SelectListItem
                            {
                                Text = "2018",
                                Value = "2018"
                            });
                            listItems3.Add(new SelectListItem
                            {
                                Text = "2019",
                                Value = "2019"
                            });
                            listItems3.Add(new SelectListItem
                            {
                                Text = "2020",
                                Value = "2010"
                            });
                            listItems3.Add(new SelectListItem
                            {
                                Text = "2021",
                                Value = "2021"
                            });
                            listItems3.Add(new SelectListItem
                            {
                                Text = "2022",
                                Value = "2022"
                            });
                            listItems3.Add(new SelectListItem
                            {
                                Text = "2023",
                                Value = "2023"
                            });
                            listItems3.Add(new SelectListItem
                            {
                                Text = "2024",
                                Value = "2024"
                            });
                            listItems3.Add(new SelectListItem
                            {
                                Text = "2025",
                                Value = "2025"
                            });
                            listItems3.Add(new SelectListItem
                            {
                                Text = "2026",
                                Value = "2026"
                            });
                            listItems3.Add(new SelectListItem
                            {
                                Text = "2027",
                                Value = "2027"
                            });
                            listItems3.Add(new SelectListItem
                            {
                                Text = "2028",
                                Value = "2028"
                            });
                            listItems3.Add(new SelectListItem
                            {
                                Text = "2029",
                                Value = "2029"
                            });
                            listItems3.Add(new SelectListItem
                            {
                                Text = "2030",
                                Value = "2030"
                            });
                        }
                        @Html.DropDownList("DDDYear3", new SelectList(listItems3, "Value", "Text"), "SELECT YEAR", new { @class = "form-control DDDYearCls3" })
                    </div>
                </div>
            </div>
            <br/><br/>
            <div class="col-lg-12">
                <div class="col-lg-5">
                    <div class="col-lg-5" style="color: brown;">From</div>
                    <div class="col-lg-7">
                        @{
                            List<SelectListItem> listItems4 = new List<SelectListItem>();

                            listItems4.Add(new SelectListItem
                            {
                                Text = "SELECT MONTH",
                                Value = "0"
                            });

                            listItems4.Add(new SelectListItem
                            {
                                Text = "January",
                                Value = "1"
                            });
                            listItems4.Add(new SelectListItem
                            {
                                Text = "February",
                                Value = "2",
                            });
                            listItems4.Add(new SelectListItem
                            {
                                Text = "March",
                                Value = "3"
                            });
                            listItems4.Add(new SelectListItem
                            {
                                Text = "April",
                                Value = "4"
                            });
                            listItems4.Add(new SelectListItem
                            {
                                Text = "May",
                                Value = "5"
                            });
                            listItems4.Add(new SelectListItem
                            {
                                Text = "June",
                                Value = "6"
                            });
                            listItems4.Add(new SelectListItem
                            {
                                Text = "July",
                                Value = "7"
                            });
                            listItems4.Add(new SelectListItem
                            {
                                Text = "August",
                                Value = "8"
                            });
                            listItems4.Add(new SelectListItem
                            {
                                Text = "September",
                                Value = "9"
                            });
                            listItems4.Add(new SelectListItem
                            {
                                Text = "October",
                                Value = "10"
                            });
                            listItems4.Add(new SelectListItem
                            {
                                Text = "Nobember",
                                Value = "11"
                            });
                            listItems4.Add(new SelectListItem
                            {
                                Text = "December",
                                Value = "12"
                            });
                        }
                        @Html.DropDownList("DDDMonth4", new SelectList(listItems4, "Value", "Text"), new { @class = "form-control DDDMonthCls4" })
                    </div>
                </div>
                <div class="col-lg-2"></div>
                <div class="col-lg-5">
                    <div class="col-lg-5" style="color: brown;">To</div>
                    <div class="col-lg-7">
                        @{
                            List<SelectListItem> listItems5 = new List<SelectListItem>();

                            listItems5.Add(new SelectListItem
                            {
                                Text = "SELECT MONTH",
                                Value = "0"
                            });

                            listItems5.Add(new SelectListItem
                            {
                                Text = "January",
                                Value = "1"
                            });
                            listItems5.Add(new SelectListItem
                            {
                                Text = "February",
                                Value = "2",
                            });
                            listItems5.Add(new SelectListItem
                            {
                                Text = "March",
                                Value = "3"
                            });
                            listItems5.Add(new SelectListItem
                            {
                                Text = "April",
                                Value = "4"
                            });
                            listItems5.Add(new SelectListItem
                            {
                                Text = "May",
                                Value = "5"
                            });
                            listItems5.Add(new SelectListItem
                            {
                                Text = "June",
                                Value = "6"
                            });
                            listItems5.Add(new SelectListItem
                            {
                                Text = "July",
                                Value = "7"
                            });
                            listItems5.Add(new SelectListItem
                            {
                                Text = "August",
                                Value = "8"
                            });
                            listItems5.Add(new SelectListItem
                            {
                                Text = "September",
                                Value = "9"
                            });
                            listItems5.Add(new SelectListItem
                            {
                                Text = "October",
                                Value = "10"
                            });
                            listItems5.Add(new SelectListItem
                            {
                                Text = "Nobember",
                                Value = "11"
                            });
                            listItems5.Add(new SelectListItem
                            {
                                Text = "December",
                                Value = "12"
                            });
                        }
                        @Html.DropDownList("DDDMonth5", new SelectList(listItems5, "Value", "Text"), new { @class = "form-control DDDMonthCls5" })
                    </div>

                </div>
            </div>
            </div>
        <br /><br /><br />
        <div class="form-actions">
            <div class="row">
                <div class="col-md-3" style="text-align: center">
                </div>
                <div class="col-md-6" style="text-align: center">
                    <input class="btn sbold uppercase btn-outline blue" type="submit" id="btnPrintForFourMonth" value="Print Per Person Sheet For Previous Four Months" />
                </div>
                <div class="col-md-3" style="text-align: center">
                </div>
            </div>
        </div>
        <div>
        </div>
    </div>
</div>

<script>

    $(function () {
        $("#btnPrint").on('click', function (e) {
            e.preventDefault();
            var monthName = $('#DDDMonth option:selected').text();
            var monthNum = $('#DDDMonth option:selected').val();
            var yearName = $('#DDDYear option:selected').text();
            var personEmpName = $('#sltPerson option:selected').text();
            console.log("personEmpName  :" + personEmpName);

            var personEmpCode = $('#sltPerson option:selected').val();
            console.log("personEmpCode  :" + personEmpCode);

            if (personEmpName == "SELECT PERSON") {

                alertify.dialog('alert').set({
                    'title': '   ',
                    'transition': 'zoom',
                    'message': "Please must select Person",
                }).show();
                return false;
            }

            if (monthName == "SELECT MONTH") {

                alertify.dialog('alert').set({
                    'title': '   ',
                    'transition': 'zoom',
                    'message': "Please must select Month",
                }).show();
                return false;
            }
            if (yearName == "SELECT YEAR") {

                alertify.dialog('alert').set({
                    'title': '   ',
                    'transition': 'zoom',
                    'message': "Please must select Year",
                }).show();
                return false;
            }

            window.open('@Url.Action("PmIncentiveReportPerPerson", "ProjectManager")' + '?EmpCode=' + personEmpCode + '&Month=' + monthName + '&MonNum=' + monthNum + '&Year=' + yearName + '&Name=' + personEmpName);
        });

        $("#btnPrintForTopSheet").on('click', function (e) {
            e.preventDefault();
            var monthName = $('#DDDMonth option:selected').text();
            var monthNum = $('#DDDMonth option:selected').val();
            var yearName = $('#DDDYear option:selected').text();

            if (monthName == "SELECT MONTH") {

                alertify.dialog('alert').set({
                    'title': '   ',
                    'transition': 'zoom',
                    'message': "Please must select Month",
                }).show();
                return false;
            }
            if (yearName == "SELECT YEAR") {

                alertify.dialog('alert').set({
                    'title': '   ',
                    'transition': 'zoom',
                    'message': "Please must select Year",
                }).show();
                return false;
            }

            window.open('@Url.Action("PmIncentiveReportTopSheet", "ProjectManager")' + '?Month=' + monthName + '&MonNum=' + monthNum + '&Year=' + yearName);
        });

        $("#btnPrintForFourMonth").on('click', function (e) {
            e.preventDefault();
            var personEmpName = $('#sltPerson2 option:selected').text();
            console.log("personEmpName  :" + personEmpName);

            var personEmpCode = $('#sltPerson2 option:selected').val();
            console.log("personEmpCode  :" + personEmpCode);

            var monthName1 = $('#DDDMonth4 option:selected').text();
            var monthNum1 = $('#DDDMonth4 option:selected').val();
            var monthName2 = $('#DDDMonth5 option:selected').text();
            var monthNum2 = $('#DDDMonth5 option:selected').val();
            var yearName = $('#DDDYear3 option:selected').text();
         
            if (personEmpName == "SELECT PERSON") {

                alertify.dialog('alert').set({
                    'title': '   ',
                    'transition': 'zoom',
                    'message': "Please must select Person",
                }).show();
                return false;
            }

            if (yearName == "SELECT YEAR") {

                alertify.dialog('alert').set({
                    'title': '   ',
                    'transition': 'zoom',
                    'message': "Please must select Year",
                }).show();
                return false;
            }
            if (monthName1 == "SELECT MONTH") {

                alertify.dialog('alert').set({
                    'title': '   ',
                    'transition': 'zoom',
                    'message': "Please must select Month",
                }).show();
                return false;
            }
            if (monthName2 == "SELECT MONTH") {

                alertify.dialog('alert').set({
                    'title': '   ',
                    'transition': 'zoom',
                    'message': "Please must select Month",
                }).show();
                return false;
            }
            window.open('@Url.Action("PmIncentiveReportPreviousFourMonths", "ProjectManager")' + '?EmpCode=' + personEmpCode + '&MonthNum1=' + monthNum1 + '&MonthNum2=' + monthNum2 + '&YearName=' + yearName + '&Name=' + personEmpName);
        });
    });
</script>