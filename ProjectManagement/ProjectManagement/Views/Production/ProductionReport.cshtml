@using System.Diagnostics
@using Microsoft.Ajax.Utilities
@using ProjectManagement.Models
@model ProjectManagement.ViewModels.Production.VmBatteryProduction
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    List<CustomBatteryProduction> plans = (List<CustomBatteryProduction>)ViewBag.GetPartialProject;
}
<link href="~/Content/icheck/skins/all.css" rel="stylesheet" />
<link href="~/Content/bootstrap-fileinput/bootstrap-fileinput.css" rel="stylesheet" />
<script src="~/Scripts/jquery.unobtrusive-ajax.js"></script>
<script src="~/Content/bootstrap-fileinput/bootstrap-fileinput.js"></script>
<script src="~/Content/icheck/icheck.min.js"></script>
<script src="~/Scripts/moment.js"></script>
<script src="~/Content/bootstrap-datetimepicker/bootstrap-datetimepicker.js"></script>
<link href="~/Content/bootstrap-datetimepicker/css/bootstrap-datetimepicker.min.css" rel="stylesheet" type="text/css" />

@*datatable *@
<link href="~/assets/global/plugins/datatables/datatables.min.css" rel="stylesheet" type="text/css" />
<link href="~/assets/global/plugins/datatables/plugins/bootstrap/datatables.bootstrap.css" rel="stylesheet" type="text/css" />
<link href="~/assets/layouts/layout4/css/layout.min.css" rel="stylesheet" type="text/css" />
<link href="~/assets/layouts/layout4/css/themes/light.min.css" rel="stylesheet" type="text/css" id="style_color" />
<link href="~/assets/layouts/layout4/css/custom.min.css" rel="stylesheet" type="text/css" />
<link href="~/Content/loadingText.css" rel="stylesheet" />

<script src="~/Scripts/jquery.table2excel.js"></script>
@*NEw*@
<script src="~/Scripts/New_2019/dataTables.fixedColumns.min.js"></script>


<style>
    input[type=checkbox] {
        /* Double-sized Checkboxes */
        -ms-transform: scale(2); /* IE */
        -moz-transform: scale(2); /* FF */
        -webkit-transform: scale(2); /* Safari and Chrome */
        -o-transform: scale(2); /* Opera */
        padding: 10px;
    }

    .DTFC_LeftBodyWrapper {
        position: relative;
        top: -11px !important;
        left: 0px;
        overflow: hidden;
        height: 530px;
    }
</style>

<div class="note note-success">
    <p style="color: green;font-size: 20px;">  Production Report </p>
</div>

<div class="row">
    <div class="col-md-12">

        <div class="portlet light bordered">
            <div class="portlet-title">
                <div class="caption" style="color: brown;">
                    <span class="caption-subject #569450 sbold uppercase">  PRODUCTION PLAN REPORT</span>
                </div>
                @*<a id="dlink" style="display:none;"></a>
                    <button class="btn green btn-outline btn-circle btn-sm pull-right" onclick="tableToExcel('proBatteryPlanTable', 'name', 'CKD.xls')">
                        <i class="fa fa-save"></i>
                        Export as Excell
                    </button>*@
                @*<input type="button" onclick="tableToExcel('proBatteryPlanTable', 'CKDPlan', 'CKD.xls')" value="Export to Excel">*@
                @*<a class="btn btn-success" id="btnExport">Export</a>*@

                @*<a id="dlink" style="display:none;"></a>*@

                <button id="btnExport" class="btn green btn-outline btn-circle btn-sm pull-right">
                    <i class="fa fa-save"></i>
                    Export as Excell
                </button>
            </div>
            <div class="portlet box">
                <div class="portlet-title">
                    <div class="caption" style="color:brown;">
                        <i class="fa fa-cogs"></i>ALL PLAN
                    </div>
                    @*<div class="tools"> </div>*@
                    <div class="tools" style="background-color:green;">
                        <a title="" data-original-title="" href="javascript:;" class="collapse"> </a>
                        <a title="" data-original-title="" href="#portlet-config" data-toggle="modal" class="config"> </a>
                        <a title="" data-original-title="" href="javascript:;" class="reload"> </a>
                        <a title="" data-original-title="" href="javascript:;" class="remove"> </a>
                    </div>
                </div>
                <div class="portlet-body">
                    <div id="divScrollId" class="table-responsive table-scrollable divScrollId" style="overflow: auto;">
                        <table id="proBatteryPlanTable1" class="table table-striped table-bordered table-hover tbl21">
                            @*<table id="proBatteryPlanTable1" class="stripe row-border order-column" style="width:100%">*@
                            <thead class="flip-content proThd" style="background-color:  #8EA6AA;color: yellow">
                                <tr class="proThTr">
                                    <th>Production Information</th>
                                </tr>
                            </thead>
                            <tbody id="tBodyForGraph" class="tBodyForGraph">
                                <tr class="ttr1">
                                    <td class="ttd1" style="font-weight: bold">SMT-Material ReceiveDate</td>
                                </tr>
                                <tr class="ttr2">
                                    <td class="ttd2">SMT-IQC<br />CompleteDate</td>
                                </tr>
                                <tr class="ttr3">
                                    <td class="ttd3">SMT-Trial<br />ProductionDate</td>
                                </tr>
                                <tr class="ttr4">
                                    <td class="ttd4" style="font-weight: bold;color:red"> SMT-SmtMass<br /> ProductionDate</td>
                                </tr>
                                <tr class="ttr5">
                                    <td class="ttd5">SMT Line-1</td>
                                </tr>
                                <tr class="ttr6">
                                    <td class="ttd6">SMT Line-2</td>
                                </tr>

                                @*<tr class="ttr7">
                                        <td class="ttd7" style="font-weight: bold">Housing-Material<br /> ReceiveDate</td>
                                    </tr>
                                    <tr class="ttr8">
                                        <td class="ttd8">Housing-IQC<br />CompleteDate</td>
                                    </tr>
                                    <tr class="ttr9">
                                        <td class="ttd9">Housing-Trial<br />ProductionDate</td>
                                    </tr>
                                    <tr class="ttr10">
                                        <td class="ttd10">Housing-Reliability<br />TestDate</td>
                                    </tr>
                                    <tr class="ttr11">
                                        <td class="ttd11" style="font-weight: bold;color:red">Housing-Mass<br />ProductionDate</td>
                                    </tr>

                                    <tr class="ttr12">
                                        <td class="ttd12">Housing Line-1</td>
                                    </tr>
                                    <tr class="ttr121">
                                        <td class="ttd121">Housing Line-2</td>
                                    </tr>
                                    <tr class="ttr13">
                                        <td class="ttd13">Housing Line-3</td>
                                    </tr>
                                    <tr class="ttr14">
                                        <td class="ttd14">Housing Line-4</td>
                                    </tr>
                                    <tr class="ttr15">
                                        <td class="ttd15">Housing Line-5</td>
                                    </tr>
                                    <tr class="ttr16">
                                        <td class="ttd16">Housing Line-6</td>
                                    </tr>
                                    <tr class="ttr17">
                                        <td class="ttd17" style="font-weight: bold">Battery-Material<br /> ReceiveDate</td>
                                    </tr>
                                    <tr class="ttr18">
                                        <td class="ttd18">Battery-IQC<br />CompleteDate</td>
                                    </tr>
                                    <tr class="ttr19">
                                        <td class="ttd19">Battery-Trial<br />ProductionDate</td>
                                    </tr>
                                    <tr class="ttr20">
                                        <td class="ttd20">Battery-Reliability<br />TestDate</td>
                                    </tr>
                                    <tr class="ttr21">
                                        <td class="ttd21" style="font-weight: bold;color:red">Battery-Mass<br />ProductionDate</td>
                                    </tr>
                                    <tr class="ttr22">
                                        <td class="ttd22">Battery Line-1</td>
                                    </tr>
                                    <tr class="ttr23">
                                        <td class="ttd23">Battery Line-2</td>
                                    </tr>
                                    <tr class="ttr24">
                                        <td class="ttd24">Battery-Aging<br />Test</td>
                                    </tr>*@

                                <tr class="ttr25">
                                    <td class="ttd25" style="font-weight: bold">Assembly-Material<br /> ReceiveDate</td>
                                </tr>
                                <tr class="ttr26">
                                    <td class="ttd26">Assembly-IQC<br />CompleteDate</td>
                                </tr>
                                <tr class="ttr27">
                                    <td class="ttd27">Assembly-Trial<br />ProductionDate</td>
                                </tr>
                                <tr class="ttr28">
                                    <td class="ttd28">Assembly-Software<br />ConfirmationDate</td>
                                </tr>
                                <tr class="ttr29">
                                    <td class="ttd29">Assembly-R&D<br />ConfirmationDate</td>
                                </tr>
                                <tr class="ttr30">
                                    <td class="ttd30" style="font-weight: bold;color:red">Assembly-Mass<br />Production</td>
                                </tr>
                                <tr class="ttr31">
                                    <td class="ttd31">Assembly Line-1</td>
                                </tr>
                                <tr class="ttr32">
                                    <td class="ttd32">Assembly Line-2</td>
                                </tr>
                                <tr class="ttr33">
                                    <td class="ttd33">Assembly Line-3</td>
                                </tr>
                                <tr class="ttr34">
                                    <td class="ttd34">Assembly Line-4</td>
                                </tr>
                                <tr class="ttr35">
                                    <td class="ttd35">Assembly Line-5</td>
                                </tr>
                                <tr class="ttr36">
                                    <td class="ttd36" style="font-weight: bold;color:red">Packing-Mass<br />Production</td>
                                </tr>
                                <tr class="ttr37">
                                    <td class="ttd37">Packing Line-1</td>
                                </tr>
                                <tr class="ttr38">
                                    <td class="ttd38">Packing Line-2</td>
                                </tr>
                            </tbody>
                        </table>

                    </div>
                </div>

            </div>
        </div>

    </div>
</div>


<script type="text/javaScript">
    ////
   
    var arrList = [];
    var arrList1 = [];
    var arrList2 = [];
    var arrListForBatterySmt = [];
    var arrListForBatteryHousing = [];
    var arrListForBattery = [];
    var arrListForBatteryAssembly = [];
    var arrListForBatteryPacking = [];
  
    ////////////Ckd Report/////////////

    var today = new Date();
    var date = today.getFullYear() + '-' + (today.getMonth() -1) + '-' + '01';
    var date2 = today.getFullYear() + '-' + (today.getMonth() + 1) + '-' + '31';
    
    var startDate = moment(date);
    var endDate = moment(date2);

    var getDateArray = function (startDate, endDate) {
        var arr = new Array();
        var dt = new Date(startDate);

        while (dt <= endDate) {
            arr.push(new Date(dt));
            dt.setDate(dt.getDate() + 1);
        }
        return arr;
    };

    var dateArr = getDateArray(startDate, endDate);

    var dateArr1 = [];
    for (var i = 0; i < dateArr.length; i++) {

        dateArr1.push(moment(dateArr[i]).format('YYYY-MM-DD'));

    }
    var dateArr2 = JSON.stringify(dateArr1);

    function removeDuplicate(arr) {
        var c;
        var len = arr.length;
        var result = [];
        var obj = {};
        for (c = 0; c < len; c++) {
            obj[arr[c]] = 0;
        }
        for (c in obj) {
            result.push(c.trim());
        }
        return result;
    }

    $.ajax({
        url: '@Url.Action("GetCkdGrandChartData", "Production")',//'/ProjectManager/GetProject',
        type: "GET",
        dataType: "JSON",
        data: { dateArr2: dateArr2 },
        success: function (data) {

            console.log(data);
            var ll = data.length;
            console.log(ll);
            var dataList = [];

            for (var x in data) {
                dataList = data[x];
            }
            var l = dataList.length;

            for (var ii = 0; ii < l; ii++) {
                var productionDate = moment(dataList[ii].ProductionDate).format('YYYY-MM-DD');
                var tr = document.getElementById('proBatteryPlanTable1').tHead.children[0],
                th = document.createElement('th');
                th.innerHTML = productionDate;
                th.width = "80px";
                tr.appendChild(th);
                //ttr1

                if (dataList[ii].MetarialReceiveBSmt == null) {
                    dataList[ii].MetarialReceiveBSmt = "";
                    var body1 = '<td>--</td>';
                    $("#proBatteryPlanTable1 tr.ttr1").append(body1);

                }
                else if (dataList[ii].MetarialReceiveBSmt != null) {

                    var names13 = dataList[ii].MetarialReceiveBSmt;
                    var temp13 = names13.split(",").map(function (item) {
                        return item.trim();
                    });

                    var body11 = '<td>' + '<p style="background-color:#F9B071;color:black;font-weight:bold;width:150px">' + removeDuplicate(temp13) + '</p>' + '</td>';
                    $("#proBatteryPlanTable1 tr.ttr1").append(body11);
                    th.width = "150px";
                }

                if (dataList[ii].IqcCompleteBSmt == null) {
                    dataList[ii].IqcCompleteBSmt = "";
                    var body2 = '<td>--</td>';
                    $("#proBatteryPlanTable1 tr.ttr2").append(body2);

                }
                else if (dataList[ii].IqcCompleteBSmt != null) {

                    var names14 = dataList[ii].IqcCompleteBSmt;
                    var temp14 = names14.split(",").map(function (item) {
                        return item.trim();
                    });

                    var body22 = '<td>' + '<p style="background-color:#FCF506;color:black;font-weight:bold;width:150px">' + removeDuplicate(temp14) + '</p>' + '</td>';

                    $("#proBatteryPlanTable1 tr.ttr2").append(body22);
                    th.width = "150px";
                }

                if (dataList[ii].TrialProductionBSmt == null) {
                    dataList[ii].TrialProductionBSmt = "";
                    var body3 = '<td>--</td>';
                    $("#proBatteryPlanTable1 tr.ttr3").append(body3);

                }
                else if (dataList[ii].TrialProductionBSmt != null) {
                    var names15 = dataList[ii].TrialProductionBSmt;
                    var temp15 = names15.split(",").map(function (item) {
                        return item.trim();
                    });
                    var body33 = '<td>' + '<p style="background-color:#DCDDD5;color:black;font-weight:bold;width:150px">' + removeDuplicate(temp15) + '</p>' + '</td>';

                    $("#proBatteryPlanTable1 tr.ttr3").append(body33);
                    th.width = "150px";
                }
                var body4 = '<td>--</td>';
                $("#proBatteryPlanTable1 tr.ttr4").append(body4);

                if (dataList[ii].SmtLineOne == null) {
                    dataList[ii].SmtLineOne = "";
                    var body5 = '<td>--</td>';
                    $("#proBatteryPlanTable1 tr.ttr5").append(body5);

                }
                else if (dataList[ii].SmtLineOne != null) {
                    var names16 = dataList[ii].SmtLineOne;
                    var temp16 = names16.split(",").map(function (item) {
                        return item.trim();
                    });

                    var body55 = '<td>' + '<p style="background-color:#FEDC0B;color:black;font-weight:bold;width:150px">' + removeDuplicate(temp16) + '</p>' + '</td>';

                    $("#proBatteryPlanTable1 tr.ttr5").append(body55);
                    th.width = "150px";
                }

                if (dataList[ii].SmtLineTwo == null) {
                    dataList[ii].SmtLineTwo = "";
                    var body6 = '<td>--</td>';
                    $("#proBatteryPlanTable1 tr.ttr6").append(body6);

                }
                else if (dataList[ii].SmtLineTwo != null) {

                    var names17 = dataList[ii].SmtLineTwo;
                    var temp17 = names17.split(",").map(function (item) {
                        return item.trim();
                    });
                    var body66 = '<td>' + '<p style="background-color:#FEDC0B;color:black;font-weight:bold;width:150px">' + removeDuplicate(temp17) + '</p>' + '</td>';

                    $("#proBatteryPlanTable1 tr.ttr6").append(body66);
                    th.width = "150px";
                }

                //Housing
                //if (dataList[ii].MetarialReceiveBHousing == null) {
                //    dataList[ii].MetarialReceiveBHousing = "";
                //    var body7 = '<td>--</td>';
                //    $("#proBatteryPlanTable1 tr.ttr7").append(body7);

                //}
                //else if (dataList[ii].MetarialReceiveBHousing != null) {

                //    var body77 = '<td>' + '<p style="background-color:#FEDC0B;color:black;font-weight:bold;">' + dataList[ii].MetarialReceiveBHousing + '</p>' + '</td>';

                //    $("#proBatteryPlanTable1 tr.ttr7").append(body77);

                //}

                //if (dataList[ii].IqcCompleteBHousing == null) {
                //    dataList[ii].IqcCompleteBHousing = "";
                //    var body8 = '<td>--</td>';
                //    $("#proBatteryPlanTable1 tr.ttr8").append(body8);

                //}
                //else if (dataList[ii].IqcCompleteBHousing != null) {

                //    var body88 = '<td>' + '<p style="background-color:#FEDC0B;color:black;font-weight:bold;">' + dataList[ii].IqcCompleteBHousing + '</p>' + '</td>';

                //    $("#proBatteryPlanTable1 tr.ttr8").append(body88);

                //}
                //if (dataList[ii].TrialProductionBHousing == null) {
                //    dataList[ii].TrialProductionBHousing = "";
                //    var body9 = '<td>--</td>';
                //    $("#proBatteryPlanTable1 tr.ttr9").append(body9);

                //}
                //else if (dataList[ii].TrialProductionBHousing != null) {

                //    var body99 = '<td>' + '<p style="background-color:#FEDC0B;color:black;font-weight:bold;">' + dataList[ii].TrialProductionBHousing + '</p>' + '</td>';

                //    $("#proBatteryPlanTable1 tr.ttr9").append(body99);

                //}

                //if (dataList[ii].HousingBReliability == null) {
                //    dataList[ii].HousingBReliability = "";
                //    var body10 = '<td>--</td>';
                //    $("#proBatteryPlanTable1 tr.ttr10").append(body10);

                //}
                //else if (dataList[ii].HousingBReliability != null) {

                //    var body101 = '<td>' + '<p style="background-color:#FEDC0B;color:black;font-weight:bold;">' + dataList[ii].HousingBReliability + '</p>' + '</td>';

                //    $("#proBatteryPlanTable1 tr.ttr10").append(body101);

                //}
                //var body102 = '<td>--</td>';
                //$("#proBatteryPlanTable1 tr.ttr11").append(body102);

                //if (dataList[ii].HousingLineOne == null) {
                //    dataList[ii].HousingLineOne = "";
                //    var body12 = '<td>--</td>';
                //    $("#proBatteryPlanTable1 tr.ttr12").append(body12);

                //}
                //else if (dataList[ii].HousingLineOne != null) {

                //    var body1211 = '<td>' + '<p style="background-color:#FEDC0B;color:black;font-weight:bold;">' + dataList[ii].HousingLineOne + '</p>' + '</td>';

                //    $("#proBatteryPlanTable1 tr.ttr12").append(body1211);

                //}
                //if (dataList[ii].HousingLineTwo == null) {
                //    dataList[ii].HousingLineTwo = "";
                //    var body122 = '<td>--</td>';
                //    $("#proBatteryPlanTable1 tr.ttr121").append(body122);

                //}
                //else if (dataList[ii].HousingLineTwo != null) {

                //    var body13 = '<td>' + '<p style="background-color:#FEDC0B;color:black;font-weight:bold;">' + dataList[ii].HousingLineTwo + '</p>' + '</td>';

                //    $("#proBatteryPlanTable1 tr.ttr13").append(body13);

                //}

                //if (dataList[ii].HousingLineThree == null) {
                //    dataList[ii].HousingLineThree = "";
                //    var body103 = '<td>--</td>';
                //    $("#proBatteryPlanTable1 tr.ttr13").append(body103);

                //}
                //else if (dataList[ii].HousingLineThree != null) {

                //    var body131 = '<td>' + '<p style="background-color:#FEDC0B;color:black;font-weight:bold;">' + dataList[ii].HousingLineThree + '</p>' + '</td>';

                //    $("#proBatteryPlanTable1 tr.ttr13").append(body131);

                //}

                //if (dataList[ii].HousingLineFour == null) {
                //    dataList[ii].HousingLineFour = "";
                //    var body14 = '<td>--</td>';
                //    $("#proBatteryPlanTable1 tr.ttr14").append(body14);

                //}
                //else if (dataList[ii].HousingLineFour != null) {

                //    var body141 = '<td>' + '<p style="background-color:#FEDC0B;color:black;font-weight:bold;">' + dataList[ii].HousingLineFour + '</p>' + '</td>';

                //    $("#proBatteryPlanTable1 tr.ttr14").append(body141);

                //}

                //if (dataList[ii].HousingLineFive == null) {
                //    dataList[ii].HousingLineFive = "";
                //    var body15 = '<td>--</td>';
                //    $("#proBatteryPlanTable1 tr.ttr15").append(body15);

                //}
                //else if (dataList[ii].HousingLineFive != null) {

                //    var body151 = '<td>' + '<p style="background-color:#FEDC0B;color:black;font-weight:bold;">' + dataList[ii].HousingLineFive + '</p>' + '</td>';

                //    $("#proBatteryPlanTable1 tr.ttr15").append(body151);

                //}

                //if (dataList[ii].HousingLineSix == null) {
                //    dataList[ii].HousingLineSix = "";
                //    var body16 = '<td>--</td>';
                //    $("#proBatteryPlanTable1 tr.ttr16").append(body16);

                //}
                //else if (dataList[ii].HousingLineSix != null) {

                //    var body161 = '<td>' + '<p style="background-color:#FEDC0B;color:black;font-weight:bold;">' + dataList[ii].HousingLineSix + '</p>' + '</td>';

                //    $("#proBatteryPlanTable1 tr.ttr16").append(body161);

                //}


                //if (dataList[ii].BatteryMetarialReceive == null) {
                //    dataList[ii].BatteryMetarialReceive = "";
                //    var body17 = '<td>--</td>';
                //    $("#proBatteryPlanTable1 tr.ttr17").append(body17);

                //}
                //else if (dataList[ii].BatteryMetarialReceive != null) {

                //    var body171 = '<td>' + '<p style="background-color:#FEDC0B;color:black;font-weight:bold;">' + dataList[ii].BatteryMetarialReceive + '</p>' + '</td>';

                //    $("#proBatteryPlanTable1 tr.ttr17").append(body171);

                //}

                //if (dataList[ii].BatteryIqcComplete == null) {
                //    dataList[ii].BatteryIqcComplete = "";
                //    var body18 = '<td>--</td>';
                //    $("#proBatteryPlanTable1 tr.ttr18").append(body18);

                //}
                //else if (dataList[ii].BatteryIqcComplete != null) {

                //    var body181 = '<td>' + '<p style="background-color:#FEDC0B;color:black;font-weight:bold;">' + dataList[ii].BatteryIqcComplete + '</p>' + '</td>';

                //    $("#proBatteryPlanTable1 tr.ttr18").append(body181);

                //}
                //if (dataList[ii].BatteryTrialProduction == null) {
                //    dataList[ii].BatteryTrialProduction = "";
                //    var body19 = '<td>--</td>';
                //    $("#proBatteryPlanTable1 tr.ttr19").append(body19);

                //}
                //else if (dataList[ii].BatteryTrialProduction != null) {

                //    var body191 = '<td>' + '<p style="background-color:#FEDC0B;color:black;font-weight:bold;">' + dataList[ii].BatteryTrialProduction + '</p>' + '</td>';

                //    $("#proBatteryPlanTable1 tr.ttr19").append(body191);

                //}

                //if (dataList[ii].BatteryReliability == null) {
                //    dataList[ii].BatteryReliability = "";
                //    var body20 = '<td>--</td>';
                //    $("#proBatteryPlanTable1 tr.ttr20").append(body20);

                //}
                //else if (dataList[ii].BatteryReliability != null) {

                //    var body120 = '<td>' + '<p style="background-color:#FEDC0B;color:black;font-weight:bold;">' + dataList[ii].BatteryReliability + '</p>' + '</td>';

                //    $("#proBatteryPlanTable1 tr.ttr20").append(body120);

                //}

                //var body21 = '<td>--</td>';
                //$("#proBatteryPlanTable1 tr.ttr21").append(body21);

                //if (dataList[ii].BatteryLineOne == null) {
                //    dataList[ii].BatteryLineOne = "";
                //    var body221 = '<td>--</td>';
                //    $("#proBatteryPlanTable1 tr.ttr22").append(body221);

                //}
                //else if (dataList[ii].BatteryLineOne != null) {

                //    var body121 = '<td>' + '<p style="background-color:#FEDC0B;color:black;font-weight:bold;">' + dataList[ii].BatteryLineOne + '</p>' + '</td>';

                //    $("#proBatteryPlanTable1 tr.ttr22").append(body121);

                //}
                //if (dataList[ii].BatteryLineTwo == null) {
                //    dataList[ii].BatteryLineTwo = "";
                //    var body222 = '<td>--</td>';
                //    $("#proBatteryPlanTable1 tr.ttr23").append(body222);

                //}
                //else if (dataList[ii].BatteryLineTwo != null) {

                //    var body1222 = '<td>' + '<p style="background-color:#FEDC0B;color:black;font-weight:bold;">' + dataList[ii].BatteryLineTwo + '</p>' + '</td>';

                //    $("#proBatteryPlanTable1 tr.ttr23").append(body1222);

                //}

                //if (dataList[ii].BatteryAging == null) {
                //    dataList[ii].BatteryAging = "";
                //    var body24 = '<td>--</td>';
                //    $("#proBatteryPlanTable1 tr.ttr24").append(body24);

                //}
                //else if (dataList[ii].BatteryAging != null) {

                //    var body242 = '<td>' + '<p style="background-color:#FEDC0B;color:black;font-weight:bold;">' + dataList[ii].BatteryAging + '</p>' + '</td>';
                //    $("#proBatteryPlanTable1 tr.ttr24").append(body242);

                //}

                if (dataList[ii].MetarialReceiveAssembly == null) {
                    dataList[ii].MetarialReceiveAssembly = "";
                    var body25 = '<td>--</td>';
                    $("#proBatteryPlanTable1 tr.ttr25").append(body25);

                }
                else if (dataList[ii].MetarialReceiveAssembly != null) {

                    var names = dataList[ii].MetarialReceiveAssembly;
                    var temp = names.split(",").map(function (item) {
                        return item.trim();
                    });

                    var body252 = '<td>' + '<p style="background-color:#F9B071;color:black;font-weight:bold;width:150px">' + removeDuplicate(temp) + '</p>' + '</td>';
                    $("#proBatteryPlanTable1 tr.ttr25").append(body252);
                    th.width = "150px";
                }

                if (dataList[ii].IqcCompleteAssembly == null) {
                    dataList[ii].IqcCompleteAssembly = "";
                    var body26 = '<td>--</td>';
                    $("#proBatteryPlanTable1 tr.ttr26").append(body26);

                }
                else if (dataList[ii].IqcCompleteAssembly != null) {
                    var names1 = dataList[ii].IqcCompleteAssembly;
                    var temp1 = names1.split(",").map(function (item) {
                        return item.trim();
                    });
                    var body262 = '<td>' + '<p style="background-color:#FCF506;color:black;font-weight:bold;width:150px;">' + removeDuplicate(temp1) + '</p>' + '</td>';
                    $("#proBatteryPlanTable1 tr.ttr26").append(body262);
                    th.width = "150px";
                }
                if (dataList[ii].TrialProductionAssembly == null) {
                    dataList[ii].TrialProductionAssembly = "";
                    var body27 = '<td>--</td>';
                    $("#proBatteryPlanTable1 tr.ttr27").append(body27);

                }
                else if (dataList[ii].TrialProductionAssembly != null) {

                    var names2 = dataList[ii].TrialProductionAssembly;
                    var temp2 = names2.split(",").map(function (item) {
                        return item.trim();
                    });
                    var body272 = '<td>' + '<p style="background-color:#DCDDD5;color:black;font-weight:bold;width:150px">' + removeDuplicate(temp2) + '</p>' + '</td>';
                    $("#proBatteryPlanTable1 tr.ttr27").append(body272);
                    th.width = "150px";
                }

                if (dataList[ii].SoftwareConfirmationAssembly == null) {
                    dataList[ii].SoftwareConfirmationAssembly = "";
                    var body28 = '<td>--</td>';
                    $("#proBatteryPlanTable1 tr.ttr28").append(body28);

                }
                else if (dataList[ii].SoftwareConfirmationAssembly != null) {

                    var names3 = dataList[ii].SoftwareConfirmationAssembly;
                    var temp3 = names3.split(",").map(function (item) {
                        return item.trim();
                    });
                    var body282 = '<td>' + '<p style="background-color:#C2E3EB;color:black;font-weight:bold;width:150px">' + removeDuplicate(temp3) + '</p>' + '</td>';
                    $("#proBatteryPlanTable1 tr.ttr28").append(body282);
                    th.width = "150px";
                }

                if (dataList[ii].RnDConfirmAssembly == null) {
                    dataList[ii].RnDConfirmAssembly = "";
                    var body29 = '<td>--</td>';
                    $("#proBatteryPlanTable1 tr.ttr29").append(body29);

                }
                else if (dataList[ii].RnDConfirmAssembly != null) {

                    var names4 = dataList[ii].RnDConfirmAssembly;
                    var temp4 = names4.split(",").map(function (item) {
                        return item.trim();
                    });
                    var body292 = '<td>' + '<p style="background-color:#CDECB3;color:black;font-weight:bold;width:150px">' + removeDuplicate(temp4) + '</p>' + '</td>';
                    $("#proBatteryPlanTable1 tr.ttr29").append(body292);
                    th.width = "150px";
                }

                var body30 = '<td>--</td>';
                $("#proBatteryPlanTable1 tr.ttr30").append(body30);
                //
                if (dataList[ii].AssemblyLineOne == null) {
                    dataList[ii].AssemblyLineOne = "";
                    var body31 = '<td>--</td>';
                    $("#proBatteryPlanTable1 tr.ttr31").append(body31);
                }
                else if (dataList[ii].AssemblyLineOne != null) {

                    var names5 = dataList[ii].AssemblyLineOne;
                    var temp5 = names5.split(",").map(function (item) {
                        return item.trim();
                    });
                    var body313 = '<td>' + '<p style="background-color:#FEDC0B;color:black;font-weight:bold;width:150px">' + removeDuplicate(temp5) + '</p>' + '</td>';
                    $("#proBatteryPlanTable1 tr.ttr31").append(body313);
                    th.width = "150px";
                }

                if (dataList[ii].AssemblyLineTwo == null) {
                    dataList[ii].AssemblyLineTwo = "";
                    var body32 = '<td>--</td>';
                    $("#proBatteryPlanTable1 tr.ttr32").append(body32);
                }
                else if (dataList[ii].AssemblyLineTwo != null) {
                    var names6 = dataList[ii].AssemblyLineTwo;
                    var temp6 = names6.split(",").map(function (item) {
                        return item.trim();
                    });
                    var body322 = '<td>' + '<p style="background-color:#FEDC0B;color:black;font-weight:bold;width:150px">' + removeDuplicate(temp6) + '</p>' + '</td>';
                    $("#proBatteryPlanTable1 tr.ttr32").append(body322);
                    th.width = "150px";
                }

                if (dataList[ii].AssemblyLineThree == null) {
                    dataList[ii].AssemblyLineThree = "";
                    var body331 = '<td>--</td>';
                    $("#proBatteryPlanTable1 tr.ttr33").append(body331);
                }
                else if (dataList[ii].AssemblyLineThree != null) {
                    var names7 = dataList[ii].AssemblyLineThree;
                    var temp7 = names7.split(",").map(function (item) {
                        return item.trim();
                    });
                    var body332 = '<td>' + '<p style="background-color:#FEDC0B;color:black;font-weight:bold;width:150px">' + removeDuplicate(temp7) + '</p>' + '</td>';
                    $("#proBatteryPlanTable1 tr.ttr33").append(body332);
                    th.width = "150px";
                }

                if (dataList[ii].AssemblyLineFour == null) {
                    dataList[ii].AssemblyLineFour = "";
                    var body34 = '<td>--</td>';
                    $("#proBatteryPlanTable1 tr.ttr34").append(body34);
                }
                else if (dataList[ii].AssemblyLineFour != null) {
                    var names8 = dataList[ii].AssemblyLineFour;
                    var temp8 = names8.split(",").map(function (item) {
                        return item.trim();
                    });
                    var body341 = '<td>' + '<p style="background-color:#FEDC0B;color:black;font-weight:bold;width:150px">' + removeDuplicate(temp8) + '</p>' + '</td>';
                    $("#proBatteryPlanTable1 tr.ttr34").append(body341);
                    th.width = "150px";
                }

                if (dataList[ii].AssemblyLineFive == null) {
                    dataList[ii].AssemblyLineFive = "";
                    var body35 = '<td>--</td>';
                    $("#proBatteryPlanTable1 tr.ttr35").append(body35);
                }
                else if (dataList[ii].AssemblyLineFive != null) {

                    var names9 = dataList[ii].AssemblyLineFive;
                    var temp9 = names9.split(",").map(function (item) {
                        return item.trim();
                    });

                    var body351 = '<td>' + '<p style="background-color:#FEDC0B;color:black;font-weight:bold;width:150px">' + removeDuplicate(temp9) + '</p>' + '</td>';
                    $("#proBatteryPlanTable1 tr.ttr35").append(body351);
                    th.width = "150px";
                }

                var body36 = '<td>--</td>';
                $("#proBatteryPlanTable1 tr.ttr36").append(body36);

                if (dataList[ii].PackingLine1 == null) {
                    dataList[ii].PackingLine1 = "";
                    var body37 = '<td>--</td>';
                    $("#proBatteryPlanTable1 tr.ttr37").append(body37);
                }
                else if (dataList[ii].PackingLine1 != null) {
                    var names10 = dataList[ii].PackingLine1;
                    var temp10 = names10.split(",").map(function (item) {
                        return item.trim();
                    });

                    var body371 = '<td>' + '<p style="background-color:#FEDC0B;color:black;font-weight:bold;width:150px">' + removeDuplicate(temp10) + '</p>' + '</td>';
                    $("#proBatteryPlanTable1 tr.ttr37").append(body371);
                    th.width = "150px";
                }

                if (dataList[ii].PackingLine2 == null) {
                    dataList[ii].PackingLine2 = "";
                    var body38 = '<td>--</td>';
                    $("#proBatteryPlanTable1 tr.ttr38").append(body38);
                }
                else if (dataList[ii].PackingLine2 != null) {

                    var names11 = dataList[ii].PackingLine2;
                    var temp11 = names11.split(",").map(function (item) {
                        return item.trim();
                    });

                    var body381 = '<td>' + '<p style="background-color:#FEDC0B;color:black;font-weight:bold;width:150px">' + removeDuplicate(temp11) + '</p>' + '</td>';
                    $("#proBatteryPlanTable1 tr.ttr38").append(body381);
                    th.width = "150px";
                }
            }

            $('#proBatteryPlanTable1').DataTable({
                "scrollX": true,
                "scrollY": 550,
                "paging": false,
                "scrollCollapse": true,
                "sorting": false,
                "autoWidth": false,
                fixedColumns: {
                    leftColumns: 1,
                    // rightColumns: 1
                }
            });
        }

    });

    //end

   

    $("#btnExport").click(function (e) {
        var file = new Blob([$('.divScrollId').html()], { type: "application/vnd.ms-excel" });
        var url = URL.createObjectURL(file);
        var a = $("<a />", {
            href: url,
            download: "CKD.xls"
        }).appendTo("body").get(0).click();
        e.preventDefault();
    });
</script>
