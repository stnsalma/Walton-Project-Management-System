@using System
@using System.Diagnostics
@using System.Web.Mvc.Html
@using ProjectManagement.Infrastructures.Helper
@model ProjectManagement.ViewModels.Software.VmAllIncentiveList
@{
    ViewBag.Title = "HeadDeputyMonthlyIncentive";

}

<script src="~/Scripts/moment.js"></script>
<script src="~/Content/bootstrap-datetimepicker/bootstrap-datetimepicker.js"></script>
<link href="~/Content/bootstrap-datetimepicker/css/bootstrap-datetimepicker.min.css" rel="stylesheet" type="text/css" />
@*datatable *@
<link href="~/assets/global/plugins/datatables/datatables.min.css" rel="stylesheet" type="text/css" />
<link href="~/assets/global/plugins/datatables/plugins/bootstrap/datatables.bootstrap.css" rel="stylesheet" type="text/css" />
<link href="~/assets/layouts/layout4/css/layout.min.css" rel="stylesheet" type="text/css" />
<link href="~/assets/layouts/layout4/css/themes/light.min.css" rel="stylesheet" type="text/css" id="style_color" />
<link href="~/assets/layouts/layout4/css/custom.min.css" rel="stylesheet" type="text/css" />
<style>
    #loading {
        width: 100%;
        height: 100%;
        top: 70px;
        left: 0;
        position: fixed;
        display: block;
        opacity: 0.7;
        background-color: #fff;
        z-index: 999;
        text-align: center;
    }
    .page-header-fixed .page-container {
        margin-top: 0px;
    }

    .navbar-fixed-top {
        position: relative;
    }
</style>
<div class="note note-success">
    @if (@Model.RoleName == "QCHEAD")
    {
        <p style="color: red;font-size: 20px;"> Head Incentive</p>
    }
    @if (@Model.RoleName == "DEPUTY")
    {
        <p style="color: red;font-size: 20px;"> Deputy Incentive</p>
    }

</div>


<div class="portlet box green">
    <div class="portlet-title">
        <div class="caption">
            <i class="fa fa-picture"></i>INFO
        </div>
    </div>
    <div class="portlet-body" style="display: block;">
        <div class="row">
            <div class="col-lg-12">
                <div class="col-lg-4">
                    <div class="col-lg-6" style="text-align:right">ID :</div>
                    @if (Model != null)
                    {
                        <div class="col-lg-6" style="text-align:left" id="EmployeeCode">@Model.EmployeeCode</div>
                    }
                </div>
                <br />
                <div class="col-lg-4">
                    <div class="col-lg-6" style="text-align:right">Month :</div>
                    @if (Model != null)
                    {
                        <div class="col-lg-6" style="text-align:left" id="Month">@Model.Month</div>
                        <div class="col-lg-6" style="text-align:left;display:none" id="MonNum">@Model.MonNum</div>
                        <div class="col-lg-6" style="text-align:left;display:none" id="RoleName">@Model.RoleName</div>
                    }
                </div>
                <br />
                <div class="col-lg-4">
                    <div class="col-lg-6" style="text-align:right">Year :</div>
                    @if (Model != null)
                    {
                        <div class="col-lg-6" style="text-align:left" id="Year">@Model.Year</div>


                    }
                </div>
            </div>

        </div>

    </div>
</div>
<br />
@if (TempData["Message2"] != null)
{

    var msgss = TempData["Message2"];

    <div class="alert alert-danger alert-dismissable">
        <button type="button" class="close" data-dismiss="alert" aria-hidden="true"></button>
        <strong>Message:</strong> @msgss
    </div>


}
<div class="row">
    <div class="col-md-12">
        <!-- BEGIN EXAMPLE TABLE PORTLET-->
        <div class="portlet light bordered">
            <div class="portlet-title">
                <div class="col-lg-12">
                    <div class="caption font-dark">
                        <i class="icon-settings font-dark"></i>
                        <span class="caption-subject bold uppercase" style="color: red">Incentive</span>
                    </div>
                    <div class="tools"> </div>
                </div>
            </div>
            <div class="portlet-body">
                <table class="table table-striped table-bordered table-hover tbl1" id="tbl1">
                    <thead>
                        <tr>
                            <th style="text-align: center;font-size: 12px"> Team <br />Incentive </th>
                            <th style="text-align: center;font-size: 12px">Percentage(%) </th>
                            <th style="text-align: center;font-size: 12px"> Total<br />Incentive </th>
                        </tr>
                    </thead>
                    <tbody>
                        @if (@Model.QcHeadIncentiveList.Count != 0)
                        {
                            foreach (var item in Model.QcHeadIncentiveList)
                            {
                                <tr style="text-align: center" class="trClsforSize" id="trClsforSize">
                                    <td id="TeamIncentive">@Html.DisplayFor(modelItem => item.TeamIncentive)</td>
                                    <td id="SwPercentage">@Html.DisplayFor(modelItem => item.SwPercentage)</td>
                                    <td id="SwIncentive">@Html.DisplayFor(modelItem => item.SwIncentive)</td>
                                </tr>
                            }
                        }
                    </tbody>
                </table>
            </div>
        </div>
        <!-- END EXAMPLE TABLE PORTLET-->
        <!-- BEGIN EXAMPLE TABLE PORTLET-->
    </div>
</div>

@*<div class="row">
    <div class="col-md-12">
        <!-- BEGIN EXAMPLE TABLE PORTLET-->
        <div class="portlet light bordered">
            <div class="portlet-title">
                <div class="col-lg-12">
                    <div class="caption font-dark">
                        <i class="icon-settings font-dark"></i>
                        <span class="caption-subject bold uppercase" style="color: red">Penalties</span>
                    </div>
                    <div class="tools"> </div>
                </div>
            </div>
            <div class="portlet-body">
                <table class="table table-striped table-bordered table-hover tblAutoPenalties" id="tblAutoPenalties">
                    <thead>
                        <tr class="trClsforSize1">

                            <th style="text-align: center;font-size: 12px"> Project<br />Name </th>
                            <th style="text-align: center;font-size: 12px"> ReleaseDate </th>
                            <th style="text-align: center;font-size: 12px">Total<br /> Issue <br /> Percentage</th>
                            <th style="text-align: center;font-size: 12px"> Assigned<br />Persons </th>
                            <th style="text-align: center;font-size: 12px"> Total<br />Amount </th>
                            <th style="text-align: center;font-size: 12px"> Total<br />Penalties </th>
                            <th style="text-align: center;font-size: 12px"> Penalties<br />Percentage(%) </th>
                            <th style="text-align: center;font-size: 12px"> Previous<br />Deducted<br />Amount </th>
                            <th style="text-align: center;font-size: 12px"> Per Person<br /> Penalties </th>
                            <th style="text-align: center;font-size: 12px"> Final<br />Amount </th>
                            <th style="text-align: center;font-size: 12px;display: none"> MonthNum </th>
                            <th style="text-align: center;font-size: 12px"> Month </th>
                            <th style="text-align: center;font-size: 12px"> Year </th>
                        </tr>
                    </thead>
                    <tbody>
                        @if (Model.SwQcIssueDetailModelsPenalties.Count != 0)
                        {
                            foreach (var item in Model.SwQcIssueDetailModelsPenalties)
                            {
                                <tr style="text-align: center" class="trClsforSize" id="trClsforSize">

                                    <td>@item.ProjectName</td>
                                    <td> @if (@item.ReleaseDate != null)
                                    { @String.Format("{0:yyyy-MM-dd}", @item.ReleaseDate) }</td>
                                    <td>@item.TotalIssuePercentage</td>
                                    <td>@item.AssignedPersons</td>
                                    <td>@item.TotalAmount</td>
                                    <td>@item.TotalPenalties</td>
                                    <td>@item.PenaltiesPercentage</td>
                                    <td>@item.PreviousDeductedAmount</td>
                                    <td>@item.PerPersonPenalties</td>
                                    <td>@item.FinalAmount</td>
                                    <td style="display:none">@item.Months</td>
                                    <td>@item.Month</td>
                                    <td>@item.Years</td>
                                </tr>
                            }
                        }

                    </tbody>
                </table>
            </div>
        </div>
        <!-- END EXAMPLE TABLE PORTLET-->
        <!-- BEGIN EXAMPLE TABLE PORTLET-->
    </div>
</div>*@

<div class="row">
    <div class="col-md-12">
        <!-- BEGIN EXAMPLE TABLE PORTLET-->
        <div class="portlet light bordered">
            <div class="portlet-title">
                <div class="col-lg-12">
                    <div class="caption font-dark">
                        <i class="icon-settings font-dark"></i>
                        <span class="caption-subject bold uppercase" style="color: red">Others</span>
                    </div>
                    <div class="tools"> </div>
                </div>
            </div>
            <div class="portlet-body">
                <br />
                <div class="col-lg-12">
                    <div class="col-lg-1">******</div><div class="col-lg-4">
                        Others<br />
                        -------------------
                    </div><div class="col-lg-3"></div><div class="col-lg-4"></div>
                </div>
                <br /><br /><br />

                <div class="col-lg-12">
                    <div class="col-lg-4">
                        <div class="col-lg-3" style="color: brown;"> Others Type </div>
                        <div class="col-lg-9">
                            @Html.TextBoxFor(model => model.SwQcOthersIncentiveModel.OthersType, new { @class = "form-control" })

                        </div>
                    </div>

                    <div class="col-lg-4">

                        <div class="col-lg-4" style="color: brown;">Select Project</div>
                        <div class="col-lg-8">
                            @{
                                Debug.Assert(@Model != null, "@Model != null");
                            }
                            @Html.DropDownListFor(model => model.ProjectName, new SelectList(ViewBag.Projects, "Value", "Text"), "SELECT PROJECT", new { @class = "ddChosen form-control dropForProject12", @id = "projectNameForOthers" })


                        </div>

                    </div>
                    <div class="col-lg-4">
                        <label class="control-label col-lg-4" style="color: brown;">Added Amount</label>
                        <div class="col-lg-8">
                            @Html.TextBoxFor(model => model.SwQcOthersIncentiveModel.AddedAmount, new { @class = "form-control", @id = "othersAddedAmount", @type = "number" })
                        </div>
                    </div>

                </div>
                <br /><br />
                <div class="col-lg-12">

                    <div class="col-lg-4">
                        <label class="control-label col-lg-3" style="color: brown;">Remarks</label>
                        <div class="col-lg-9">
                            @Html.TextAreaFor(model => model.SwQcOthersIncentiveModel.AddAmountRemarks, new { @class = "form-control", @id = "othersAddedRemarks" })
                        </div>

                    </div>

                    <div class="col-lg-4">
                        <label class="control-label col-lg-4" style="color: brown">Deduct Amount</label>
                        <div class="col-lg-8">
                            @Html.TextBoxFor(model => model.SwQcOthersIncentiveModel.Deduction, new { @class = "form-control", @id = "othersDeduct", @type = "number" })
                        </div>
                    </div>
                    <div class="col-lg-4">
                        <label class="control-label col-lg-4" style="color: brown">Deduct Remarks</label>
                        <div class="col-lg-8">
                            @Html.TextAreaFor(model => model.SwQcOthersIncentiveModel.DeductionRemarks, new { @class = "form-control", @id = "others_D_Remarks" })
                        </div>
                    </div>
                </div>
                <br /><br /><br />
                <div class="col-lg-12">
                    <div class="col-lg-4"></div>
                    <div class="col-lg-4">
                        <button id="btnAddForOthersHead" class="btn btn-lg blue m-icon-big"><i class="fa fa-plus-circle" aria-hidden="true"></i>Add</button>
                    </div>
                    <div class="col-lg-4"></div>

                </div>
                <br /><br /><br />
            </div>

            <br /><br />
            <div class="row">
                <div class="col-sm-12">
                    <div class="portlet light bordered">
                        <div class="portlet box green-haze">
                            <div class="portlet-body">
                                <div class="table-scrollable table-responsive" style="overflow-y: auto;overflow-x: auto">

                                    <table class="table table-bordered table-striped table-condensed flip-content tblOthersHead" id="tblOthersHead" style="overflow-y: auto;overflow-x: auto">
                                        <thead>
                                            <tr>
                                                <th style="width: 100px;">Incentive Type</th>
                                                <th>P_Name</th>
                                                <th>EmpCode</th>
                                                <th>Added<br />Amount </th>
                                                <th>Added<br />Remarks </th>
                                                <th>Deduction </th>
                                                <th>Deduction<br />Remarks </th>
                                                <th>Final<br />Amount </th>
                                                <th>Month</th>
                                                <th>Year</th>
                                                <th>Action</th>
                                            </tr>
                                        </thead>
                                        <tbody id="tBodyOthersHead" class="tBodyOthersHead" style="overflow-y: auto;overflow-x: auto">

                                            @foreach (var ss in Model.SwQcOthersIncentiveModel.Custom_Sw_IncentiveModels)
                                            {
                                                Html.RenderPartial("~/Views/Software/Partial/_SwQcOthersIncentiveHead.cshtml", ss);

                                            }

                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
        <!-- END EXAMPLE TABLE PORTLET-->
        <!-- BEGIN EXAMPLE TABLE PORTLET-->
    </div>

</div>

<div class="row">
    <div class="col-md-12">
        <!-- BEGIN EXAMPLE TABLE PORTLET-->
        <div class="portlet light bordered">
            <div class="portlet-title">
                <div class="col-lg-12">
                    <div class="caption font-dark">
                        <i class="icon-settings font-dark"></i>
                        <span class="caption-subject bold uppercase" style="color: red">Penalties</span>
                    </div>
                    <div class="tools"> </div>
                </div>
            </div>
            <div class="portlet-body">
                <br />
                <div class="col-lg-12">
                    <div class="col-lg-1">******</div><div class="col-lg-4">
                                                          Penalties<br />
                                                          -------------------
                                                      </div><div class="col-lg-3"></div><div class="col-lg-4"></div>
                </div>
                <br /><br /><br />

                <div class="col-lg-12">
                    <div class="col-lg-4">
                        <div class="col-lg-4" style="color: brown;"> Penalties Reason </div>
                        <div class="col-lg-8">
                            @Html.TextBoxFor(model => model.SwQcOthersIncentiveModel2.PenaltiesReason, new { @class = "form-control PenaltiesReason" })

                        </div>
                    </div>

                    <div class="col-lg-4">

                        <div class="col-lg-4" style="color: brown;">Select Project</div>
                        <div class="col-lg-8">
                            @{
                                Debug.Assert(@Model != null, "@Model != null");
                            }
                            @Html.DropDownListFor(model => model.ProjectName, new SelectList(ViewBag.ProjectsPenalties, "Value", "Text"), "SELECT PROJECT", new { @class = "ddChosen form-control projectNameForPenalties", @id = "projectNameForPenalties" })


                        </div>

                    </div>
                    <div class="col-lg-4">
                        <label class="control-label col-lg-4" style="color: brown">Total Penalties</label>
                        <div class="col-lg-8">
                            @Html.TextBoxFor(model => model.SwQcOthersIncentiveModel2.TotalPenalties, new { @class = "form-control", @id = "penaltiesTotal", @type = "number",onchange="totalPenaltiesChange()" })
                        </div>
                    </div>

                </div>
                <br /><br />
                <div class="col-lg-12">
                    <div class="col-lg-4">
                        <label class="control-label col-lg-4" style="color: brown">Assigned Persons</label>
                        <div class="col-lg-8">
                            @Html.TextBoxFor(model => model.SwQcOthersIncentiveModel2.AssignedPersons, new { @class = "form-control", @id = "assignedPersons", @type = "number", @value="1", @disabled="disabled" })
                        </div>
                    </div>
                    <div class="col-lg-4">
                        <label class="control-label col-lg-4" style="color: brown">Particular Persons Penalties</label>
                        <div class="col-lg-8">
                            @Html.TextBoxFor(model => model.SwQcOthersIncentiveModel2.ParticularPersonsPenalties, new { @class = "form-control", @id = "ParticularPersonsPenalties", disabled = "disabled" })
                        </div>
                    </div>

                    <div class="col-lg-4">
                        <label class="control-label col-lg-4" style="color: brown">Penalty Remarks</label>
                        <div class="col-lg-8">
                            @Html.TextAreaFor(model => model.SwQcOthersIncentiveModel2.PenaltiesRemarks, new { @class = "form-control", @id = "penaltiesRemarks" })
                        </div>
                    </div>
                </div>
                <br /><br /><br />
                <div class="col-lg-12">
                    <div class="col-lg-4"></div>
                    <div class="col-lg-4">
                        <button id="btnAddForPenalties" class="btn btn-lg blue m-icon-big"><i class="fa fa-plus-circle" aria-hidden="true"></i>Add</button>
                    </div>
                    <div class="col-lg-4"></div>

                </div>
                <br /><br /><br />
            </div>

            <br /><br />
            <div class="row">
                <div class="col-sm-12">
                    <div class="portlet light bordered">
                        <div class="portlet box green-haze">
                            <div class="portlet-body">
                                <div class="table-scrollable table-responsive" style="overflow-y: auto;overflow-x: auto">
                                    <table class="table table-bordered table-striped table-condensed flip-content" id="tblPenalties" style="overflow-y: auto;overflow-x: auto">
                                        <thead>
                                            <tr>
                                                <th style="width: 100px;">Penalties Reason</th>
                                                <th>P_Name</th>
                                                <th>EmpCode</th>
                                                <th>Total<br />Penalties</th>
                                                <th>Assigned<br />Persons</th>
                                                <th>Particular<br />Persons<br />Penalties</th>
                                                <th>Penalty<br />Remarks</th>
                                                <th>F_Amount</th>
                                                <th>Month</th>
                                                <th>Year</th>
                                                <th>Action</th>
                                            </tr>
                                        </thead>
                                        <tbody id="tBodyPenalties" class="tBodyPenalties" style="overflow-y: auto;overflow-x: auto">
                                            @foreach (var swQcOthers in Model.SwQcOthersIncentiveModel2.Custom_Sw_IncentiveModels)
                                            {
                                                Html.RenderPartial("~/Views/Software/Partial/_SwQcPenaltiesForIncentive.cshtml", swQcOthers);
                                            }

                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
        <!-- END EXAMPLE TABLE PORTLET-->
        <!-- BEGIN EXAMPLE TABLE PORTLET-->
    </div>

</div>
<br /><br />
<div class="row" style="display:none">
    <div class="col-sm-12">
        <div class="portlet light bordered">
            <div class="portlet-title">
                <div class="col-lg-12">
                    <div class="caption font-dark">
                        <i class="icon-settings font-dark"></i>
                        <span class="caption-subject bold uppercase" style="color: red">Total Reward & Penalties</span>
                    </div>
                    <div class="tools"> </div>
                </div>
            </div>
            <div class="portlet-body">
                <div>
                    <table class="table table-bordered table-striped table-condensed flip-content" id="tblRewardPenalties" style="overflow-y: auto;overflow-x: auto;width: 400px">
                        <thead>
                            <tr>
                                <th>Total<br /> Reward</th>
                                <th>Total<br />Penalties</th>

                            </tr>
                        </thead>
                        <tbody>
                            @*@if (ViewBag.GetRewardAndPenaltiesDeputyAndHead != null)
                            {
                                foreach (var items in ViewBag.GetRewardAndPenaltiesDeputyAndHead)
                                {
                                    if (@items.TotalReward1 != null && @items.TotalDeduction1 != null)
                                    {
                                        <tr>
                                            <td><input id="tRewards" value="@items.TotalReward1" disabled="disabled" /></td>
                                            <td><input id="tPenalties" value="@items.TotalDeduction1" disabled="disabled" /></td>
                                        </tr>
                                    }
                                }
                            }*@
                            <tr>
                                <td><input id="tRewards" value="0" disabled="disabled" /></td>
                                <td><input id="tPenalties" value="0" disabled="disabled" /></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

        </div>
    </div>
</div>


<br /><br />
<div class="row">
    <div class="col-md-12">
        <!-- BEGIN EXAMPLE TABLE PORTLET-->
        <div class="portlet light bordered">
            <div class="portlet-title">
                <div class="col-lg-12">
                    <div class="caption font-dark">
                        <i class="icon-settings font-dark"></i>
                        <span class="caption-subject bold uppercase" style="color: red">Final Incentive</span>
                    </div>
                    <div class="tools"> </div>
                </div>
            </div>
            <div class="portlet-body">
                <br />
                <div class="col-lg-12">
                    <div class="col-lg-1">******</div><div class="col-lg-4">
                        Total Incentive<br />
                        -------------------
                    </div><div class="col-lg-3"></div><div class="col-lg-4"></div>
                </div>
                <br /><br /><br />
                <div class="col-lg-12">
                    <div class="col-lg-4">
                        <div class="col-lg-4" style="color: brown;"> Total Issue Incentive </div>
                        <div class="col-lg-8">
                            @Html.TextBoxFor(model => model.SwQcOthersIncentiveModelTotal.FinalIssueAmount, new { @class = "form-control FinalIssueAmount", @id = "FinalIssueAmount", disabled = "disabled" })
                        </div>
                    </div>
                    <div class="col-lg-4"></div>
                    <div class="col-lg-4"></div>
                </div>
                <br /><br />
                <div class="col-lg-12">
                    <div class="col-lg-4">
                        <div class="col-lg-4" style="color: brown;"> Total Incentive </div>
                        <div class="col-lg-8">
                            @Html.TextBoxFor(model => model.SwQcOthersIncentiveModelTotal.FinalTotalAmount, new { @class = "form-control FinalTotalAmount", @id = "FinalTotalAmount", disabled = "disabled" })

                        </div>
                    </div>
                    <div class="col-lg-4">
                        <label class="control-label col-lg-4" style="color: brown">Added Amount</label>
                        <div class="col-lg-8">
                            @Html.TextBoxFor(model => model.SwQcOthersIncentiveModelTotal.FinalAddedAmount, new { @class = "form-control", @id = "FinalAddedAmount", @type = "number", onchange = "FinalAddedAmountChange()" })
                        </div>
                    </div>

                    <div class="col-lg-4">

                        <label class="control-label col-lg-4" style="color: brown">Added Remarks</label>
                        <div class="col-lg-8">
                            @Html.TextBoxFor(model => model.SwQcOthersIncentiveModelTotal.FinalAddedRemarks, new { @class = "form-control", @id = "FinalAddedRemarks" })
                        </div>
                    </div>


                </div>
                <br /><br />
                <div class="col-lg-12">
                    <div class="col-lg-4">

                        <div class="col-lg-4" style="color: brown;">Deduction</div>
                        <div class="col-lg-8">
                            @Html.TextBoxFor(model => model.SwQcOthersIncentiveModelTotal.FinalDeduction, new { @class = "form-control FinalDeduction", @id = "FinalDeduction", @type = "number", onchange = "FinalDeductionChange()" })


                        </div>

                    </div>
                    <div class="col-lg-4">
                        <label class="control-label col-lg-4" style="color: brown">Deduction Remarks</label>
                        <div class="col-lg-8">
                            @Html.TextBoxFor(model => model.SwQcOthersIncentiveModelTotal.FinalDeductionRemarks, new { @class = "form-control", @id = "FinalDeductionRemarks" })
                        </div>
                    </div>
                    <div class="col-lg-4">
                        <label class="control-label col-lg-4" style="color: brown">Final Incentive</label>
                        <div class="col-lg-8">
                            @Html.TextBoxFor(model => model.SwQcOthersIncentiveModelTotal.FinalIncentive, new { @class = "form-control", @id = "FinalIncentive", disabled = "disabled" })
                        </div>
                    </div>

                </div>
                <br /><br />
            </div>
        </div>
        <!-- END EXAMPLE TABLE PORTLET-->
        <!-- BEGIN EXAMPLE TABLE PORTLET-->
    </div>

</div>
<div class="form-actions">
    <div class="row">
        <div class="col-md-6">
            <input class="btn sbold uppercase btn-outline red-flamingo btnFinalSubmitHead" type="submit" id="btnFinalSubmitHead" value="Final Submit" onchange="winLoads()" />
        </div>

    </div>
</div>
<br /><br />
<div id="loading" style="display: none;text-align: center;">
    <img src="~/img/loading-spinner-grey.gif" />
</div>

<script>
    $(function () {
        $("body:first").addClass("page-sidebar-closed");
        $("ul.page-sidebar-menu").addClass("page-sidebar-menu-closed");
    });
    function winLoads() {
        windows.load();
    }
    function totalPenaltiesChange() {
        var penaltiesTotal = $('#penaltiesTotal').val();
        $('#ParticularPersonsPenalties').val(penaltiesTotal);
    }
    
    function removeDetailRow(element) {

        var detailRow = $(element).closest('tr');

       
        var finals = $.trim(detailRow.find(".finalAmount").html());
        var allFinals = +$('#FinalTotalAmount').val();
        var allFinals2 = +allFinals - +finals;
        $('#FinalTotalAmount').val(allFinals2);
            
        //
        var penalFinal = $.trim(detailRow.find(".finalAmounts").html());
        var allFinals4 = +$('#FinalTotalAmount').val();
        var allFinals5 = +allFinals4 + +penalFinal;
        $('#FinalTotalAmount').val(allFinals5);

        var FinalTotalAmounts = $('#FinalTotalAmount').val();
        var FinalIncentive = $('#FinalIncentive').val(FinalTotalAmounts);

            
        
        $(detailRow).remove();
    }
    function FinalAddedAmountChange() {
        var FinalTotalAmount = $('#FinalTotalAmount').val();
        var FinalAddedAmount = $('#FinalAddedAmount').val();
        var FinalDeduction = $('#FinalDeduction').val();
        var finals = 0;

        if (FinalTotalAmount != "") {
            finals = (+FinalTotalAmount + +FinalAddedAmount - +FinalDeduction);
            $('#FinalIncentive').val(finals);

        } else {
            $('#FinalIncentive').val(FinalTotalAmount);
        }
    }
    function FinalDeductionChange() {
        var FinalTotalAmount = $('#FinalTotalAmount').val();
        var FinalDeduction = $('#FinalDeduction').val();
        var FinalAddedAmount = $('#FinalAddedAmount').val();
        var finals = 0;

        if (FinalTotalAmount != "") {
            finals = (+FinalTotalAmount + +FinalAddedAmount - +FinalDeduction);
            $('#FinalIncentive').val(finals);

        } else {
            $('#FinalIncentive').val(FinalTotalAmount);
        }
    }
    var FinalTotalAmounts1 = 0;
    var AllFinalAmount = 0;
    $(function () {
        var assignedPersons = $('#assignedPersons').val();
        if (assignedPersons=="0") {
            assignedPersons = "1";
            $('#assignedPersons').val(assignedPersons);
        }

        $("#tbl1 tr.trClsforSize").each(function () {
            var teamIncentive = $.trim($(this).find('#SwIncentive').text());
            AllFinalAmount += +$.trim($(this).find('#SwIncentive').text());
        });
        //$("#tblAutoPenalties tr.trClsforSize").each(function () {
        //    var final_Am_Id1 = $.trim($(this).find('td:eq(9)').text());
        //    console.log("incentive :" + final_Am_Id1);

        //    AllFinalAmount += -final_Am_Id1;
        //});
        
        var FinalIssueAmount = $('#FinalIssueAmount').val(AllFinalAmount.toFixed(2));

        var FinalTotalAmounts = $('#FinalTotalAmount').val(AllFinalAmount.toFixed(2));
        console.log("ff-->" + FinalTotalAmounts);

        //
        var tRewards = $('#tRewards').val();
        if (tRewards == undefined) {
            tRewards = 0;
        }
        var tPenalties = $('#tPenalties').val();
        if (tPenalties == undefined) {
            tPenalties = 0;
        }
        //
        
        var FinalIssueAmount1 = $('#FinalIssueAmount').val();
        
        if (tPenalties < 0) {
            tPenalties = -+tPenalties;
        }

        if (tPenalties > 0 && FinalIssueAmount1 < 0)
        {
            FinalTotalAmounts = +tRewards - +tPenalties + +FinalIssueAmount1;
            FinalTotalAmounts = $('#FinalTotalAmount').val(FinalTotalAmounts.toFixed(2));
            FinalTotalAmounts = +$('#FinalTotalAmount').val();
        }
        else
        {
            FinalTotalAmounts = +$('#FinalTotalAmount').val();
            FinalTotalAmounts = +FinalTotalAmounts + +tRewards - +tPenalties;
            FinalTotalAmounts = $('#FinalTotalAmount').val(FinalTotalAmounts);
        }

      
        var FinalIncentive = $('#FinalIncentive').val($('#FinalTotalAmount').val());
        //

       

        $("#btnAddForOthersHead").on('click', function (e) {
            e.preventDefault();
            var incentiveType = $('#SwQcOthersIncentiveModel_OthersType').val();
            console.log("incentiveType :" + incentiveType);

            if (incentiveType == "") {
                alertify.dialog('alert').set({
                    'title': '   ',
                    'transition': 'zoom',
                    'message': "Please must Input Others Type",
                }).show();
                return false;
            }

            var projectNameForOthers = $('#projectNameForOthers option:selected').text();
            console.log("projectName  :" + projectNameForOthers);


            if (projectNameForOthers == "SELECT PROJECT") {
                projectNameForOthers = "";
            }

            var personEmpCode = $('#EmployeeCode').text();
            var monName = $('#Month').text();
            var monId = $('#MonNum').text();
            var yearName = $('#Year').text();
            var yearId = $('#Year').text();
            var roleName = $('#RoleName').text();

            var addedAmount = $('#othersAddedAmount').val();
            console.log(addedAmount);
            if (addedAmount == "") {
                addedAmount = "0";
            }
            var othersAddedRemarks = $('#othersAddedRemarks').val();
            console.log(othersAddedRemarks);

            var othersDeduct = $('#othersDeduct').val();
            if (othersDeduct == "") {
                othersDeduct = "0";
            }
            var others_D_Remarks = $('#others_D_Remarks').val();

            if ((othersDeduct != "0") && others_D_Remarks == "") {
                alertify.dialog('alert').set({
                    'title': '   ',
                    'transition': 'zoom',
                    'message': "Please must Input Deduct Remarks",
                }).show();
                return false;
            }
            if (othersDeduct == "0" && addedAmount == "0") {
                alertify.dialog('alert').set({
                    'title': '   ',
                    'transition': 'zoom',
                    'message': "Please must Input Added Amount Or Deduct Amount",
                }).show();
                return false;
            }
            var finalAmount = addedAmount - othersDeduct;
            //finals
            var allFinals = +$('#FinalTotalAmount').val();
            var allFinals2 = +allFinals + +finalAmount;
            $('#FinalTotalAmount').val(allFinals2);

            var FinalTotalAmounts = $('#FinalTotalAmount').val();
            var FinalIncentive = $('#FinalIncentive').val(FinalTotalAmounts);
            //end finals
            $.post('@Url.Action("AddProjectsForOthersHead", "Software")', {
                    incentiveType: incentiveType,
                    addedAmount: addedAmount,
                    personEmpCode: personEmpCode,
                    projectNameForOthers: projectNameForOthers,
                    monName: monName,
                    monId: monId,
                    yearName: yearName,
                    yearId: yearId,
                    othersAddedRemarks: othersAddedRemarks,
                    othersDeduct: othersDeduct,
                    others_D_Remarks: others_D_Remarks,
                    finalAmount: addedAmount - othersDeduct
                }, function (data) {
                    console.log(data);
                    $('#tBodyOthersHead').append(data);
                });

            $('#SwQcOthersIncentiveModel_OthersType').val("");
            $('#othersAddedAmount').val("");
            $('#othersAddedRemarks').val("");
            $('#othersDeduct').val("");
            $('#others_D_Remarks').val("");

        });

        $("#btnAddForPenalties").on('click', function (e) {
            e.preventDefault();
            var penaltiesReason = $('#SwQcOthersIncentiveModel2_PenaltiesReason').val();

            var projectNameForPenalties = $('#projectNameForPenalties option:selected').text();
            console.log("projectNameForPenalties  :" + projectNameForPenalties);


            var personEmpCode = $('#EmployeeCode').text();
            var monName = $('#Month').text();
            var monId = $('#MonNum').text();
            var yearName = $('#Year').text();
            var yearId = $('#Year').text();
            var roleName = $('#RoleName').text();


            //
            if (penaltiesReason == "") {
                alertify.dialog('alert').set({
                    'title': '   ',
                    'transition': 'zoom',
                    'message': "Please must select Penalties Reason",
                }).show();
                return false;
            }

            if (projectNameForPenalties == "SELECT PROJECT") {
                alertify.dialog('alert').set({
                    'title': '   ',
                    'transition': 'zoom',
                    'message': "Please must Select Project",
                }).show();
                return false;
            }
            var penaltiesTotal = $('#penaltiesTotal').val();
            
            if (penaltiesTotal=="") {
                penaltiesTotal = "0";
            }
            var assignedPersons = $('#assignedPersons').val();


            if (penaltiesTotal == "0") {
                alertify.dialog('alert').set({
                    'title': '   ',
                    'transition': 'zoom',
                    'message': "Please must Input Total Penalties",
                }).show();
                return false;
            }

            if (assignedPersons == "0") {
                alertify.dialog('alert').set({
                    'title': '   ',
                    'transition': 'zoom',
                    'message': "Please must Input Assigned Persons",
                }).show();
                return false;
            }
            var ParticularPersonsPenalties = $('#ParticularPersonsPenalties').val();
            if (ParticularPersonsPenalties == "") {
                ParticularPersonsPenalties = "0";
            }
            var penaltiesRemarks = $('#penaltiesRemarks').val();

            var finalAmount = $('#ParticularPersonsPenalties').val();
            console.log("finalAmount :" + finalAmount);

            //
            var allFinals = +$('#FinalTotalAmount').val();

            var allFinals2 = +allFinals - +finalAmount;

            $('#FinalTotalAmount').val(allFinals2);
            var FinalTotalAmounts = $('#FinalTotalAmount').val();
            //FinalIncentive
            var FinalIncentive = $('#FinalIncentive').val(FinalTotalAmounts);

            
            //

            $.post('@Url.Action("AddProjectsForPenaltiesHead", "Software")', {
                    penaltiesReason: penaltiesReason,
                    penaltiesTotal: penaltiesTotal,
                    personEmpCode: personEmpCode,
                    projectNameForPenalties: projectNameForPenalties,
                    monName: monName,
                    monId: monId,
                    yearName: yearName,
                    yearId: yearId,
                    assignedPersons: assignedPersons,
                    ParticularPersonsPenalties: ParticularPersonsPenalties,
                    penaltiesRemarks: penaltiesRemarks,
                    finalAmount: finalAmount
                }, function (data) {
                    console.log(data);
                    $('#tBodyPenalties').append(data);
                });

            $('#SwQcOthersIncentiveModel2_PenaltiesReason').val("");
            $('#penaltiesTotal').val("");
            $('#ParticularPersonsPenalties').val("");
            $('#penaltiesRemarks').val("");
          
        });
        
        //Final Submit
        
        $("#btnFinalSubmitHead").on('click', function (e) {
            e.preventDefault();
          
            
            //var personEmpCode = $('#EmployeeCode').text();
            //var monName = $('#Month').text();
            //var monId = $('#MonNum').text();
            //var yearName = $('#Year').text();
            //var yearId = $('#Year').text();
            //var roleName = $('#RoleName').text();


            var othersVal = "";
            var autoPenaltiesVal = "";
            var penaltiesVal = "";
            var finalInsVal = "";

            var monthName = $('#Month').text();
            var monthNum = $('#MonNum').text();
            var yearName = $('#Year').text();
            var roleName = $('#RoleName').text();
            var personEmpCode = $('#EmployeeCode').text();
           
            //var objAutoPenal = {};
            //var objAutoPenalArr = [];

            //var projectNamePenal;
            //var releaseDate;
            //var totalIssuePercentage;
            //var assignedPersonsPenal;
            //var totalAmountPenal;
            //var totalPenalties;
            //var penaltiespercentage;
            //var previousDeductedAmount;
            //var perPersonPenalties;
            //var finalAmountPenal;
            //
            @*$("#tblAutoPenalties tr.trClsforSize").each(function () {
                objAutoPenal = new Object();

                projectNamePenal = $.trim($(this).find('td:eq(0)').text());
                releaseDate = $.trim($(this).find('td:eq(1)').text());
                totalIssuePercentage = $.trim($(this).find('td:eq(2)').text());
                assignedPersonsPenal = $.trim($(this).find('td:eq(3)').text());
                totalAmountPenal = $.trim($(this).find('td:eq(4)').text());
                totalPenalties = $.trim($(this).find('td:eq(5)').text());
                penaltiespercentage = $.trim($(this).find('td:eq(6)').text());
                previousDeductedAmount = $.trim($(this).find('td:eq(7)').text());
                perPersonPenalties = $.trim($(this).find('td:eq(8)').text());
                finalAmountPenal = $.trim($(this).find('td:eq(9)').text());

                //objAutoPenal
                objAutoPenal.ProjectName = projectNamePenal;
                objAutoPenal.ReleaseDate = releaseDate;
                objAutoPenal.TotalIssuePercentage = totalIssuePercentage;
                objAutoPenal.AssignedPersons = assignedPersonsPenal;
                objAutoPenal.TotalAmount = totalAmountPenal;
                objAutoPenal.TotalPenalties = totalPenalties;
                objAutoPenal.PenaltiesPercentage = penaltiespercentage;
                objAutoPenal.PreviousDeductedAmount = previousDeductedAmount;
                objAutoPenal.PerPersonPenalties = perPersonPenalties;
                objAutoPenal.FinalAmount = finalAmountPenal;

                objAutoPenal.EmployeeCode = personEmpCode;
                objAutoPenal.MonNum = monthNum;
                objAutoPenal.Month = monthName;
                objAutoPenal.Year = yearName;
                //objAutoPenalArr
                objAutoPenalArr.push(objAutoPenal);
                console.log("objAutoPenalArr---->" + objAutoPenalArr);
            });

            $.ajax({
                type: 'POST',
                url: '@Url.Action("SaveSwIncentive_AutoPenalties", "Software")',
                data: "{objAutoPenalArr:'" + JSON.stringify(objAutoPenalArr) + "'}",
                contentType: "application/json; charset=utf-8",
                dataType: 'json',
                async: false,
                success: function (data) {
                    console.log(data);
                    autoPenaltiesVal = "yes";
                }
            });//end Ajax penalties*@

            //Others
            var objOthers = {};
            var objOthersArr = [];


            var othersOthersType;
            var othersProjectName;
            var othersAddedAmount;
            var othersAddAmountRemarks;
            var othersDeduction;
            var othersDeductionRemarks;
            var othersFinalAmount;

            $("#tblOthersHead tr.tableTrCls").each(function () {
                objOthers = new Object();

                //others
                othersOthersType = $.trim($(this).find('td:eq(1)').text());
                othersProjectName = $.trim($(this).find('td:eq(2)').text());
                othersAddedAmount = $.trim($(this).find('td:eq(4)').text());
                othersAddAmountRemarks = $.trim($(this).find('td:eq(5)').text());
                othersDeduction = $.trim($(this).find('td:eq(6)').text());
                othersDeductionRemarks = $.trim($(this).find('td:eq(7)').text());
                othersFinalAmount = $.trim($(this).find('td:eq(8)').text());

                //objOthers
                objOthers.OthersType = othersOthersType;
                objOthers.ProjectName = othersProjectName;
                objOthers.AddedAmount = othersAddedAmount;
                objOthers.AddAmountRemarks = othersAddAmountRemarks;
                objOthers.Deduction = othersDeduction;
                objOthers.DeductionRemarks = othersDeductionRemarks;
                objOthers.FinalAmount = othersFinalAmount;

                objOthers.EmployeeCode = personEmpCode;
                objOthers.MonNum = monthNum;
                objOthers.Month = monthName;
                objOthers.Year = yearName;
                //objField
                objOthersArr.push(objOthers);
                console.log("objOthersArr---->" + objOthersArr);
            });

            $.ajax({
                type: 'POST',
                url: '@Url.Action("SaveSwIncentive_OthersHead", "Software")',
                data: "{objOthersArr:'" + JSON.stringify(objOthersArr) + "'}",
                contentType: "application/json; charset=utf-8",
                dataType: 'json',
                async: false,
                success: function (data) {
                    console.log(data);
                    othersVal = "yes";
                }
            });//end Ajax others

            //Penalties
            var objPenalties = {};
            var objPenaltiesArr = [];

            //penalties
            var penaltiesPenaltiesReason;
            var penaltiesProjectName;
            var penaltiesTotalPenalties;
            var penaltiesAssignedPersons;
            var penaltiesParticularPersonsPenalties;
            var penaltiesPenaltiesRemarks;
            var penaltiesFinalAmount;
            $("#tblPenalties tr.tableTrCls").each(function () {
                objPenalties = new Object();

                //penalties
                penaltiesPenaltiesReason = $.trim($(this).find('td:eq(1)').text());
                penaltiesProjectName = $.trim($(this).find('td:eq(2)').text());
                penaltiesTotalPenalties = $.trim($(this).find('td:eq(4)').text());
                penaltiesAssignedPersons = $.trim($(this).find('td:eq(5)').text());
                penaltiesParticularPersonsPenalties = $.trim($(this).find('td:eq(6)').text());
                penaltiesPenaltiesRemarks = $.trim($(this).find('td:eq(7)').text());
                penaltiesFinalAmount = $.trim($(this).find('td:eq(8)').text());

                //objPenalties
                objPenalties.PenaltiesReason = penaltiesPenaltiesReason;
                objPenalties.ProjectName = penaltiesProjectName;
                objPenalties.TotalPenalties = penaltiesTotalPenalties;
                objPenalties.AssignedPersons = penaltiesAssignedPersons;
                objPenalties.ParticularPersonsPenalties = penaltiesParticularPersonsPenalties;
                objPenalties.PenaltiesRemarks = penaltiesPenaltiesRemarks;
                objPenalties.FinalAmount = penaltiesFinalAmount;

                objPenalties.EmployeeCode = personEmpCode;
                objPenalties.MonNum = monthNum;
                objPenalties.Month = monthName;
                objPenalties.Year = yearName;
                //objField
                objPenaltiesArr.push(objPenalties);
                console.log("objPenaltiesArr---->" + objPenaltiesArr);
            });
            $.ajax({
                type: 'POST',
                url: '@Url.Action("SaveSwIncentive_PenaltiesHead", "Software")',
                data: "{objPenaltiesArr:'" + JSON.stringify(objPenaltiesArr) + "'}",
                contentType: "application/json; charset=utf-8",
                dataType: 'json',
                async: false,
                success: function (data) {
                    console.log(data);
                    penaltiesVal = "yes";
                }
            });//end Ajax penalties


           

            //Final
            var objFinal = {};
            var objFinalArr = [];

            //
            //final
            //var hundredPercentIssueAmount = $('#HundredPercentIssueAmount').val();
            var finalTotalAmount = $('#FinalTotalAmount').val();
            var finalAddedAmount = $('#FinalAddedAmount').val();
            var finalAddedRemarks = $('#FinalAddedRemarks').val();
            var finalDeduction = $('#FinalDeduction').val();
            var finalDeductionRemarks = $('#FinalDeductionRemarks').val();
            var finalIncentive = $('#FinalIncentive').val();

            if (finalAddedAmount == "") {
                finalAddedAmount = "0";
            }
            if (finalDeduction == "") {
                finalDeduction = "0";
            }

            if (finalAddedAmount != "0" && finalAddedRemarks == "") {
                alertify.dialog('alert').set({
                    'title': '   ',
                    'transition': 'zoom',
                    'message': "Please must Input Added Remarks",
                }).show();
                return false;
            }
            if (finalDeduction != "0" && finalDeductionRemarks == "") {
                alertify.dialog('alert').set({
                    'title': '   ',
                    'transition': 'zoom',
                    'message': "Please must Input Deduction Remarks",
                }).show();
                return false;
            }

            //objFinal.HundredPercentIssueAmount = hundredPercentIssueAmount;
            objFinal.FinalTotalAmount = finalTotalAmount;
            objFinal.FinalAddedAmount = finalAddedAmount;
            objFinal.FinalAddedRemarks = finalAddedRemarks;
            objFinal.FinalDeduction = finalDeduction;
            objFinal.FinalDeductionRemarks = finalDeductionRemarks;
            objFinal.FinalIncentive = finalIncentive;

            objFinal.PerPersonReward = tRewards;
            objFinal.PerPersonPenalties = tPenalties;
            objFinal.FinalIssueAmount = $('#FinalIssueAmount').val();

            objFinal.EmployeeCode = personEmpCode;
            objFinal.MonNum = monthNum;
            objFinal.Month = monthName;
            objFinal.Year = yearName;
            objFinal.RoleName = roleName;

            objFinalArr.push(objFinal);
            
            $('#loading').show();
            $.ajax({
                type: 'POST',
                url: '@Url.Action("SaveSwIncentive_IncentiveHead", "Software")',
                data: "{objFinalArr:'" + JSON.stringify(objFinalArr) + "'}",
                contentType: "application/json; charset=utf-8",
                dataType: 'json',
                async: false,
                success: function (data) {
                    console.log(data);
                    finalInsVal = "yes";
                    if (data.data == "ok") {
                        $('#loading').hide();
                        
                        window.location.reload(true);
                        window.location = '@Url.Action("HeadDeputyMonthlyIncentive", "Software")';

                        alertify.dialog('alert').set({
                            'title': '   ',
                            'transition': 'zoom',
                            'message': "Incentive Generated Successfully.",
                        }).show();

                        return false;
                    }
                    else {
                        $('#loading').hide();
                        
                        window.location.reload(true);
                        window.location = '@Url.Action("HeadDeputyMonthlyIncentive", "Software")';

                        alertify.dialog('alert').set({
                            'title': '   ',
                            'transition': 'zoom',
                            'message': "Incentive Already Generated.",
                        }).show();

                        return false;
                    }
                }
            });//end Ajax Finals


        });//end Final Submit Button
    });//end document
</script>

<script src="~/assets/global/scripts/datatable.js" type="text/javascript"></script>
<script src="~/assets/global/plugins/datatables/datatables.min.js" type="text/javascript"></script>
<script src="~/assets/global/plugins/datatables/plugins/bootstrap/datatables.bootstrap.js" type="text/javascript"></script>
<script src="~/assets/pages/scripts/table-datatables-rowreorder.min.js" type="text/javascript"></script>