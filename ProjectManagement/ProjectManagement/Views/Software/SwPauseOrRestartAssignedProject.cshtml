@using System.Runtime.InteropServices
@using System.Web.Mvc.Html
@using Microsoft.Ajax.Utilities
@using ProjectManagement.Models
@model ProjectManagement.ViewModels.Software.VmSwQcSpecificationModified


<link href="~/assets/global/plugins/datatables/datatables.min.css" rel="stylesheet" type="text/css" />
<link href="~/assets/global/plugins/datatables/plugins/bootstrap/datatables.bootstrap.css" rel="stylesheet" type="text/css" />
<link href="~/assets/layouts/layout4/css/layout.min.css" rel="stylesheet" type="text/css" />
<link href="~/assets/layouts/layout4/css/themes/light.min.css" rel="stylesheet" type="text/css" id="style_color" />
<link href="~/assets/layouts/layout4/css/custom.min.css" rel="stylesheet" type="text/css" />
@*<script src="~/Scripts/jquery.blockui.min.js"></script>
    <script src="~/Scripts/jquery.slimscroll.min.js"></script>*@
<style>
    #loading {
        width: 100%;
        height: 100%;
        top: 70px;
        left: 0;
        position: fixed;
        display: block;
        opacity: 0.7;
        background-color: #fff;
        z-index: 999;
        text-align: center;
    }
</style>

@*<div class="portlet box green">
        <div class="portlet-title">
            <div class="caption">
                <i class="icon-list"></i>Assigned Projects to QC
            </div>


            <div class="tools">
                <a href="javascript:;" class="collapse"> </a>

                <a href="javascript:;" class="reload"> </a>
            </div>

        </div>

        <div class="portlet-body flip-scroll">
            <div class="row">
                <div class="table-scrollable">
                    <table class="table table-bordered table-striped table-condensed flip-content" id="tblAssignedProjectstatus">
                        <thead class="flip-content">
                            <tr>
                                <th class="text-center"> # </th>
                                <th class="text-center"> Project Name </th>
                                <th class="text-center">Project Type</th>
                                <th class="text-center">QcHead<br /> AssignTime</th>
                                <th class="text-center">Assigned <br />Persons</th>
                                <th class="text-center">QC Deadline</th>

                                <th class="text-center">Software<br />Version<br />Name</th>
                                <th class="text-center">Software<br />VersionNo</th>
                                <th class="text-center">Test<br />Phase</th>
                                <th class="text-center"> Supplier Name </th>
                                <th class="text-center"> Supplier<br /> Model<br /> Name </th>
                                <th class="text-center">PM_Name</th>
                                <th class="text-center">PM Assign Time</th>
                                <th class="text-center">Status</th>
                                <th class="text-center">Paused_Date</th>
                                <th class="text-center">Action</th>
                                <th class="text-center">Delete/Re-assign QC</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var item in ViewBag.GetAssignedProjectToQCStatus)
                            {
                                <tr>
                                    <td class="text-center"></td>
                                    <td class="text-center" style="display: none"><input type="hidden" value="@item.ProjectMasterId" id="ProMasID"></td>
                                    <td class="text-center" style="display: none"><input type="hidden" value="@item.SwQcHeadAssignId" id="ProInchargeID"></td>
                                    <td class="text-center">@item.ProjectName</td>
                                    <td class="text-center">@item.ProjectType</td>
                                    <td class="text-center" style="display: none"><input type="hidden" value="@item.AssignedPerson" id="assignPersonName"></td>
                                    <td class="text-center" style="display: none"><input type="hidden" value="@item.ProjectPmAssignId" id="projectPmAssignId"></td>
                                    <td class="text-center">
                                        @if (@item.SwQcHeadToQcAssignTime != null)
                                        {@String.Format("{0:yyyy-MM-dd}", @item.SwQcHeadToQcAssignTime)}
                                    </td>
                                    <td class="text-center">@item.AssignedPerson</td>
                                    <td class="text-center">
                                        @if (@item.ApproxInchargeToQcDeliveryDate != null)
                                        {@String.Format("{0:yyyy-MM-dd}", @item.ApproxInchargeToQcDeliveryDate)}
                                    </td>
                                    <td class="text-center">@item.SoftwareVersionName</td>
                                    <td class="text-center">@item.SoftwareVersionNo</td>
                                    <td class="text-center">@item.TestPhaseName</td>
                                    <td class="text-center">@item.SupplierName</td>
                                    <td class="text-center">@item.SupplierModelName</td>
                                    <td class="text-center">@item.ProjectManagerUserName</td>
                                    <td class="text-center">
                                        @if (@item.PmToQcHeadAssignTime != null)
                                        {@String.Format("{0:yyyy-MM-dd}", @item.PmToQcHeadAssignTime)}
                                    </td>
                                    <td class="text-center">
                                        @if (item.Status == "NEW")
                                        {
                                            <span class="label label-sm label-success"> @item.Status </span>

                                        }
                                        else if (item.Status == "ASSIGNED")
                                        {
                                            <span class="label label-sm label-primary"> @item.Status </span>

                                        }

                                        else if (item.Status == "QCCOMPLETED")
                                        {
                                            <span class="label label-sm label-info"> @item.Status </span>

                                        }
                                        else if (item.Status == "PAUSED")
                                        {
                                            <span class="label label-sm label-danger"> @item.Status </span>

                                        }

                                    </td>
                                    <td class="text-center">
                                        @if (@item.Status == "PAUSED")
                                        {
                                            if (@item.PausedDate != null)
                                            {
                                                @String.Format("{0:yyyy-MM-dd}", @item.PausedDate)
                                            }
                                        }
                                    </td>
                                    <td class="text-center">
                                        @if (item.Status == "ASSIGNED")
                                        {
                                            <button type="button" class="btn btn-danger btnPaused" id="btnPaused" onclick="buttonPausedFunction()">
                                                <span class="glyphicon glyphicon-pause">PAUSE</span>
                                            </button>
                                        }
                                        else if (item.Status == "PAUSED")
                                        {
                                            <button type="button" class="btn btn-success btnRestart" id="btnRestart">
                                                <span class="glyphicon glyphicon-repeat">RESTART</span>
                                            </button>

                                        }

                                    </td>
                                    <td class="text-center">

                                        @if (item.Status == "PAUSED")
                                        {
                                            <button type="button" class="btn btn-danger btnDeleteOrReassign" id="btnDeleteOrReassign">
                                                <span class="glyphicon glyphicon-remove">Delete / ReAssign</span>
                                            </button>


                                        }

                                    </td>


                                </tr>
                            }

                        </tbody>
                    </table>
                </div>
                <input type="hidden" id="rowNumber" value="" />
                <div class="rvmCls" style="margin-left: 20px;">
                    @Html.ActionLink("Back", "SwQcInchargeDashboard")
                </div>
            </div>
        </div>

    </div>*@

<div class="row">
    <div class="col-md-12">
        <!-- BEGIN EXAMPLE TABLE PORTLET-->
        <div class="portlet light bordered">
            <div class="portlet-title">
                <div class="col-lg-12">
                    <div class="caption font-dark">
                        <i class="icon-settings font-dark"></i>
                        <span class="caption-subject bold uppercase"> Assigned Projects to QC</span>
                    </div>
                    <div class="tools"> </div>
                </div>
            </div>
            <div class="portlet-body table-scrollable">
                <table class="table table-striped table-bordered table-hover tblAssignedProjectstatus" id="tblAssignedProjectstatus">
                    <thead style="background-color: #4a8099;color: white;">
                        <tr>
                            <th class="text-center"> # </th>
                            <th class="text-center"> Project Name </th>
                            <th class="text-center">PoCategory</th>
                            <th class="text-center">QcHead<br /> AssignTime</th>
                            <th class="text-center">Assigned <br />Persons</th>
                            <th class="text-center">QC Deadline</th>
                            <th class="text-center">Software<br />Version<br />Name</th>
                            <th class="text-center">Software<br />VersionNo</th>
                            <th class="text-center">Test<br />Phase</th>
                            <th class="text-center"> Supplier Name </th>
                            <th class="text-center"> Supplier<br /> Model<br /> Name </th>
                            <th class="text-center">PM_Name</th>
                            <th class="text-center">PM Assign Time</th>
                            <th class="text-center">Status</th>
                            <th class="text-center">Paused_Date</th>
                            <th class="text-center">Action</th>
                            <th class="text-center">Delete/Re-assign QC</th>

                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in ViewBag.GetAssignedProjectToQCStatus)
                        {
                            <tr>
                                <td class="text-center"></td>
                                <td class="text-center" style="display: none"><input type="hidden" value="@item.ProjectMasterId" id="ProMasID"></td>
                                <td class="text-center" style="display: none"><input type="hidden" value="@item.SwQcHeadAssignId" id="ProInchargeID"></td>
                                <td class="text-center">@item.ProjectName</td>
                                <td class="text-center">@item.SourcingType</td>
                                <td class="text-center" style="display: none"><input type="hidden" value="@item.AssignedPerson" id="assignPersonName"></td>
                                <td class="text-center" style="display: none"><input type="hidden" value="@item.ProjectPmAssignId" id="projectPmAssignId"></td>
                                <td class="text-center">
                                    @if (@item.SwQcHeadToQcAssignTime != null)
                                    {@String.Format("{0:yyyy-MM-dd HH:mm:ss tt}", @item.SwQcHeadToQcAssignTime)}
                                </td>
                                <td class="text-center">@item.AssignedPerson</td>
                                <td class="text-center">
                                    @if (@item.ApproxInchargeToQcDeliveryDate != null)
                                    {@String.Format("{0:yyyy-MM-dd}", @item.ApproxInchargeToQcDeliveryDate)}
                                </td>
                                <td class="text-center">@item.SoftwareVersionName</td>
                                <td class="text-center">@item.SoftwareVersionNo</td>
                                <td class="text-center">@item.TestPhaseName</td>
                                <td class="text-center">@item.SupplierName</td>
                                <td class="text-center">@item.SupplierModelName</td>
                                <td class="text-center">@item.ProjectManagerUserName</td>
                                <td class="text-center">
                                    @if (@item.PmToQcHeadAssignTime != null)
                                    {@String.Format("{0:yyyy-MM-dd HH:mm:ss tt}", @item.PmToQcHeadAssignTime)}
                                </td>
                                <td class="text-center">
                                    @if (item.Status == "NEW")
                                    {
                                        <span class="label label-sm label-success"> @item.Status </span>

                                    }
                                    else if (item.Status == "ASSIGNED")
                                    {
                                        <span class="label label-sm label-primary"> @item.Status </span>

                                    }

                                    else if (item.Status == "QCCOMPLETED")
                                    {
                                        <span class="label label-sm label-info"> @item.Status </span>

                                    }
                                    else if (item.Status == "PAUSED")
                                    {
                                        <span class="label label-sm label-danger"> @item.Status </span>

                                    }

                                </td>
                                <td class="text-center">
                                    @if (@item.Status == "PAUSED")
                                    {
                                        if (@item.PausedDate != null)
                                        {
                                            @String.Format("{0:yyyy-MM-dd HH:mm:ss tt}", @item.PausedDate)
                                        }
                                    }
                                </td>
                                <td class="text-center">
                                    @if (item.Status == "ASSIGNED")
                                    {
                                        <button type="button" class="btn btn-danger btnPaused" id="btnPaused" onclick="buttonPausedFunction()">
                                            <span class="glyphicon glyphicon-pause">PAUSE</span>
                                        </button>
                                    }
                                    else if (item.Status == "PAUSED")
                                    {
                                        <button type="button" class="btn btn-success btnRestart" id="btnRestart">
                                            <span class="glyphicon glyphicon-repeat">RESTART</span>
                                        </button>

                                    }

                                </td>
                                <td class="text-center">

                                    @if (item.Status == "PAUSED")
                                    {
                                        <button type="button" class="btn btn-danger btnDeleteOrReassign" id="btnDeleteOrReassign">
                                            <span class="glyphicon glyphicon-remove">Delete / ReAssign</span>
                                        </button>
                                    }

                                </td>


                            </tr>
                        }

                    </tbody>
                </table>
                <br /><br /><br />
                <div class="rvmCls" style="margin-left: 5px;">
                    @Html.ActionLink("Back to Dashboard", "SwQcInchargeDashboard")
                </div>
            </div>
        </div>

    </div>

</div>

<div id="loading" style="display: none;text-align: center;">
    <img src="~/img/loading-spinner-grey.gif" />
</div>
<!--Modal Code-->
<div id="assignQCModal" class="modal fade" tabindex="-1" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
                <h4 class="modal-title" id="lblprojectMasterId" style="display:none;"></h4>
                <h4 class="modal-title" id="lblSwInchargeId" style="display:none;"></h4>
                <h4 class="modal-title" id="lblPmAssignId" style="display:none;"></h4>
            </div>
            <div class="modal-body">

                <div class="row">
                    <div class="col-md-12">
                        <form action="#" id="" class="form-horizontal">
                            <div class="form-body">
                                <div class="form-group">
                                    <label class="control-label col-md-3" style="width: 33.666667%;">
                                        Project Name

                                    </label>
                                    <div class="col-md-6">
                                        <input name="lblprojectName" id="lblprojectName" disabled="disabled" type="text" class="form-control">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="control-label col-md-3" id="SwInchargePausedOrAssignedComment" style="width: 33.666667%;">
                                        Remarks

                                    </label>
                                    <div class="col-md-6">
                                        <textarea class="form-control" rows="3" name="txtQCHeadRemarks" id="txtQCHeadRemarks"></textarea>
                                    </div>
                                </div>
                            </div>

                        </form>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" data-dismiss="modal" class="btn btn-circle default btn-outline">Cancel</button>
                <button type="button" data-dismiss="modal" class="btn btn-circle blue  btn-outline" id="btnQCAssignProjectPaused">Confirm</button>
            </div>
        </div>
    </div>
</div>


<!----Modal for Qc Re Assign--->
<div id="QcInchargeToQcReAssignModal" class="modal fade" tabindex="-1" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
                <h4 class="modal-title" style="font-weight: bold;color: black;">Delete/Re-Assign project to single/multiple QC</h4>
                <h4 class="modal-title" id="lblprojectMasterId1" style="display:none;"></h4>
                <h4 class="modal-title" id="lblSwInchargeId1" style="display:none;"></h4>
                <h4 class="modal-title" id="lblprojectPmAssignId1" style="display:none;"></h4>
            </div>
            <div class="modal-body">
                <form>
                    <div class="form-group">

                        <label for="recipient-name" class="control-label">Project Name :</label>
                        <input name="lblprojectName1" id="lblprojectName1" disabled="disabled" type="text" class="form-control">
                    </div>

                    <div class="form-group">

                        <label for="recipient-name" class="control-label">Assigned Persons Name :</label>
                        <input name="lblAssignPersonName1" id="lblAssignPersonName1" disabled="disabled" type="text" class="form-control">
                    </div>

                    <div class="form-group">
                        <label for="multiple" class="control-label">Delete any Assigned QC's (If necessary) :</label>


                        <select name="multiple" id="multiple1" class="form-control" multiple>
                            @*@foreach (CmnUserModel item in Model.CmnUserModels)
                                {
                                    <option value="@item.CmnUserId">
                                        @item.UserFullName _ @item.EmployeeCode
                                    </option>
                                }*@



                            @*@foreach (var item1 in ViewBag.GetDeletedPersonNameLists)
                                {
                                        <option value="@item1.CmnUserId">
                                            @item1.UserFullName _ @item1.EmployeeCode
                                        </option>
                                }*@


                        </select>

                    </div>

                    <div class="form-group">
                        <label for="message-text" class="control-label">Remarks, why you are deleting User ?</label>
                        <textarea name="SwInchargeDeleteQcComment" id="SwInchargeDeleteQcComment" class="form-control"></textarea>
                    </div>

                    <div class="form-group">
                        <label for="multiple" class="control-label">Assign New Qcs (If necessary) :</label>
                        <select name="multiple" id="multiple2" class="form-control" multiple>
                            @foreach (CmnUserModel item in Model.CmnUserModels)
                            {
                                <option value="@item.CmnUserId">
                                    @item.UserFullName _ @item.EmployeeCode
                                </option>
                            }

                        </select>
                    </div>

                    <div class="form-group">
                        <label for="message-text" class="control-label">Comments :</label>
                        <textarea name="SwInchargeReassignToQcComment" id="SwInchargeReassignToQcComment" class="form-control"></textarea>
                    </div>
                    <div class="form-group">
                        <label class="control-label">Approx. QC completion Time</label>

                        <input class="form-control" name="ApproxInchargeToQcDeliveryDate" id="ApproxInchargeToQcDeliveryDate" type="text" placeholder="yyyy-mm-dd">

                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" data-dismiss="modal" class="btn btn-circle default btn-outline">Cancel</button>
                <button type="button" data-dismiss="modal" class="btn btn-circle blue  btn-outline" id="btnReAssignToQcConfirm" onclick="buttonReAssignFunction()">Confirm</button>
            </div>
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
</div>


<script type="text/javaScript">
    //$('#tblAssignedProjectstatus').DataTable({
    //    //"scrollX": true,
    //    //"scrollY": 500,
    //    //"paging": false,
    //});
    $(function () {

        var currentRow;
        $('#tblAssignedProjectstatus tr').each(function (index) {
            $(this).find('td:nth-child(1)').html(index++);
        });

        var date = new Date();
        var today = new Date(date.getFullYear(), date.getMonth(), date.getDate());
        $('#ApproxInchargeToQcDeliveryDate').datepicker({
            // format: 'dd/mm/yyyy',
            format: 'yyyy-mm-dd',
            autoclose: true,
            startDate: today,
            endDate: 0
        });

        $('#multiple1').chosen({
            disable_search_threshold: 10,
            no_results_text: "Oops, nothing found!",
            width: "95%"
        });

        $('#multiple2').chosen({
            disable_search_threshold: 10,
            no_results_text: "Oops, nothing found!",
            width: "95%"
        });



        $('.btnDeleteOrReassign').on('click', function (e) {
            e.preventDefault();
            // refresh();
            var projectMasterId = $(this).parents('tr').find('input:hidden[id=ProMasID]').val();
            var swqcInchargeId = $(this).parents('tr').find('input:hidden[id=ProInchargeID]').val();
            var projectPmAssignId = $(this).parents('tr').find('input:hidden[id=projectPmAssignId]').val();

            var rowIndex = $(this).closest('tr').index() + 1;
            var table = document.getElementById('tblAssignedProjectstatus');
            var projectName = table.rows[rowIndex].cells[3].innerHTML;

            var assignPersonNames = $(this).parents('tr').find('input:hidden[id=assignPersonName]').val();
            console.log("assignPersonName  :" + assignPersonNames);

            $('#QcInchargeToQcReAssignModal').modal();
            $('#lblprojectName1').val(projectName);
            $('#lblprojectMasterId1').val(projectMasterId);
            $('#lblSwInchargeId1').val(swqcInchargeId);
            $('#lblprojectPmAssignId1').val(projectPmAssignId);

            $('#lblAssignPersonName1').val(assignPersonNames);

            currentRow = $(this).closest('tr');

            console.log("projectMasterId  :" + projectMasterId);
            console.log("swqcInchargeId  :" + swqcInchargeId);
            console.log("projectPmAssignId  :" + projectPmAssignId);
            console.log("projectName  :" + projectName);
            console.log("assignPersonName  :" + assignPersonNames);


            $.ajax({
                type: 'POST',
                url: '@Url.Action("DeletedUserIdList", "Software")',
                data: "{ projectMasterId: '" + projectMasterId
                    + "', swqcInchargeId: '" + swqcInchargeId
                    + "', projectPmAssignId: '" + projectPmAssignId

                    + "'}",
                contentType: "application/json; charset=utf-8",
                dataType: 'json',
                async: false,
                success: function (data) {
                    console.log(data);
                    $('#multiple1').empty();
                    //var parsed = JSON.parse(data);
                    //console.log(parsed);
                    var len = data.length;
                    console.log(len);
                    for (var i = 0; i < len; i++) {
                        var o = new Option(data[i].UserFullName + ' _ ' + data[i].EmployeeCode, data[i].CmnUserId);
                        //var option = //' <option value="' + data[i].CmnUserId + '">' + data[i].UserFullName + ' _ ' + data[i].EmployeeCode + '</option>';
                        $('#multiple1').append(o);
                    }
                    $('#multiple1').trigger("chosen:updated");
                }
            });
            e.preventDefault(); //Prevent the default submit

        });


        $('#btnReAssignToQcConfirm').on('click', function (e) {
           // e.preventDefault();
            $('#QcInchargeToQcReAssignModal').modal('hide');
            
            var swAssignPeopleDelete = $('#multiple1').val();
            var swAssignPeopleReassign = $('#multiple2').val();
            var swInchargeDeleteQcComment1 = $('#SwInchargeDeleteQcComment').val();

            if (swAssignPeopleDelete != null && (swInchargeDeleteQcComment1.length == 0 || swInchargeDeleteQcComment1 == null || swInchargeDeleteQcComment1 == "undefined")) {
                $('#QcInchargeToQcReAssignModal').modal('hide');
                alertify.dialog('alert').set({
                    'title': '   ',
                    'transition': 'zoom',
                    'message': "Please must write Remarks, why you are deleting User?",
                }).show();

                return false;
            }

            //Approx. QC completion Time
            var swAproDate = $('#ApproxInchargeToQcDeliveryDate').val();

            if (swAssignPeopleReassign != null && (swAproDate == "" || swAproDate == null)) {
                $('#QcInchargeToQcReAssignModal').modal('hide');
                // alert("Please must Load a Project which you want to submit to QcInchare..");
                alertify.dialog('alert').set({
                    'title': '   ',
                    'transition': 'zoom',
                    'message': "Please must Select Approx. QC completion Time.",
                }).show();

                return false;
            }

            if (swAssignPeopleDelete == null && swAssignPeopleReassign == null) {
                $('#QcInchargeToQcReAssignModal').modal('hide');
                alertify.dialog('alert').set({
                    'title': '   ',
                    'transition': 'zoom',
                    'message': "Please must Select any person.",
                }).show();

                return false;
            }
            var projectMasterId = $('#lblprojectMasterId1').val();
            var swqcInchargeId = $('#lblSwInchargeId1').val();
            var projectPmAssignId = $('#lblprojectPmAssignId1').val();


            var approxInchargeToQcDeliveryDate = $('#ApproxInchargeToQcDeliveryDate').val();
            var swInchargeDeleteQcComment = $('#SwInchargeDeleteQcComment').val();
            var swQcInchargeReassignToQcComment = $('#SwInchargeReassignToQcComment').val();
            var multideleteValue = $('#multiple1').val();
            var multiReassignValue = $('#multiple2').val();

            console.log(projectMasterId);
            console.log(swqcInchargeId);
            console.log(projectPmAssignId);
            console.log(approxInchargeToQcDeliveryDate);
            console.log(swInchargeDeleteQcComment);
            console.log(swQcInchargeReassignToQcComment);
            console.log(multideleteValue);
            console.log(multiReassignValue);

            var obj = {};

            obj.projectMasterId = projectMasterId;
            obj.swqcInchargeId = swqcInchargeId;
            obj.projectPmAssignId = projectPmAssignId;
            obj.approxInchargeToQcDeliveryDate = approxInchargeToQcDeliveryDate;
            obj.swInchargeDeleteQcComment = swInchargeDeleteQcComment;
            obj.swQcInchargeReassignToQcComment = swQcInchargeReassignToQcComment;
            obj.multideleteValue = multideleteValue;
            obj.multiReassignValue = multiReassignValue;


            console.log(obj.projectMasterId);
            console.log(obj.swqcInchargeId);
            console.log(obj.projectPmAssignId);
            console.log(obj.approxInchargeToQcDeliveryDate);
            console.log(obj.swInchargeDeleteQcComment);
            console.log(obj.swQcInchargeReassignToQcComment);
            console.log(obj.multideleteValue);
            console.log(obj.multiReassignValue);

            alertify.confirm('Confirm message', 'Do you want to Proceed this?', function () {
                $('#loading').show();
                alertify.success('Successfully Done.');
           
                $.ajax({
                    url: '@Url.Action("QCDeleteOrReassignByQcIncharge", "Software")',
                    type: 'POST',
                    data: "{ projectMasterId: '" + obj.projectMasterId
                        + "', swqcInchargeId: '" + obj.swqcInchargeId
                        + "', projectPmAssignId: '" + obj.projectPmAssignId
                        + "', approxInchargeToQcDeliveryDate: '" + obj.approxInchargeToQcDeliveryDate
                        + "', swInchargeDeleteQcComment: '" + obj.swInchargeDeleteQcComment
                        + "', swQcInchargeReassignToQcComment: '" + obj.swQcInchargeReassignToQcComment
                        + "', multideleteValue: '" + obj.multideleteValue
                        + "', multiReassignValue: '" + obj.multiReassignValue
                        + "'}",
                    contentType: "application/json; charset=utf-8",
                    dataType: 'json',
                    async: false,
                    success: function (data) {
                        if (data == "OK") {

                            $('#SwInchargeDeleteQcComment').val('');
                            $('#SwInchargeReassignToQcComment').val('');
                            $('#ApproxInchargeToQcDeliveryDate').val('');

                            window.location = '@Url.Action("SwPauseOrRestartAssignedProject", "Software")';
                            window.location.reload(true);
                            $('#loading').hide();
                        }
                    }
                });
                e.preventDefault(); //Prevent the default submit
            }
            , function () {
                alertify.error('Cancel');

            });

        });

        $('.btnPaused').on('click', function (e) {
            e.preventDefault();
            var projectMasterId = $(this).parents('tr').find('input:hidden[id=ProMasID]').val();
            var swqcInchargeId = $(this).parents('tr').find('input:hidden[id=ProInchargeID]').val();
            var pmAssignId = $(this).parents('tr').find('input:hidden[id=projectPmAssignId]').val();

            var rowIndex = $(this).closest('tr').index() + 1;
            var table = document.getElementById('tblAssignedProjectstatus');
            var projectName = table.rows[rowIndex].cells[3].innerHTML;

            $('#assignQCModal').modal();
            $('#lblprojectName').val(projectName);
            $('#lblprojectMasterId').val(projectMasterId);
            $('#lblSwInchargeId').val(swqcInchargeId);
            $('#lblPmAssignId').val(pmAssignId);
            currentRow = $(this).closest('tr');

            console.log("projectMasterId  :" + projectMasterId);
            console.log("swqcInchargeId  :" + swqcInchargeId);
            console.log("projectName  :" + projectName);
            console.log("pmAssignId  :" + pmAssignId);
        });

        $('#btnQCAssignProjectPaused').on('click', function () {
            $('#assignQCModal').modal('hide');

            var projectHeadRemarks = $('#txtQCHeadRemarks').val();
            if (projectHeadRemarks == "") {
                alertify.dialog('alert').set({
                    'title': '   ',
                    'transition': 'zoom',
                    'message': "Please must put pause reason.",
                }).show();
                $('#assignQCModal').modal('hide');
                return false;
            }
            var projectMsterId = $('#lblprojectMasterId').val();
            var projectName = $('#lblprojectName').val();
            var swqcInchargeId = $('#lblSwInchargeId').val();
            var pmAssignId = $('#lblPmAssignId').val();

            $('#lblprojectName').val($.trim($(this).closest('tr').find('td:eq(3)').text()));

            var obj = {};
            obj.projectHeadRemarks = projectHeadRemarks;
            obj.projectMsterId = projectMsterId;
            obj.projectName = projectName;
            obj.swqcInchargeId = swqcInchargeId;
            obj.pmAssignId = pmAssignId;

            console.log(obj.projectMsterId + "p id :" + obj.projectHeadRemarks + "remarks  :" + obj.projectName + "name---" + obj.swqcInchargeId + "incharge id" + obj.pmAssignId);

            alertify.confirm('Project Paused Confirmation', 'Do you want to Pause this Running Project?', function () {
                $('#loading').show();
                alertify.success('Successfully Paused.');
                $.ajax({
                    url: '@Url.Action("SwPauseOrRestartAssignedProject", "Software")',
                    type: 'POST',
                    data: JSON.stringify(obj),
                    contentType: 'application/json; charset=utf-8',
                    success: function (data) {
                        //if (!data.success) {
                        //    if (data.errors.name) {
                        //        //  $('.throw_error').fadeIn(1000).html(data.errors.name);
                        //    }
                        //}
                        //else {
                        //    //  $('#success').fadeIn(1000).append('<p>' + data.posted + '</p>');

                        //    console.log(data);
                        //}
                        if (data == "OK") {

                            $('#txtQCHeadRemarks').val('');

                            window.location = '@Url.Action("SwPauseOrRestartAssignedProject", "Software")';
                            window.location.reload(true);
                            $('#loading').hide();
                        }
                    }
                });
                event.preventDefault(); //Prevent the default submit
            }
                , function () {
                    alertify.error('Cancel');

                });
        });
        //function refresh() {
        //    $.blockUI({ message: '<h1><img src="~/img/loading-spinner-grey.gif" /> Please Wait..</h1>' });
        //    setTimeout(function () {
        //        window.location.reload();
        //    }, 1000);
        //}
        $('.btnRestart').on('click', function (e) {
            e.preventDefault();

            var projectMasterId = $(this).parents('tr').find('input:hidden[id=ProMasID]').val();
            var swqcInchargeId = $(this).parents('tr').find('input:hidden[id=ProInchargeID]').val();
            var pmAssignId = $(this).parents('tr').find('input:hidden[id=projectPmAssignId]').val();

            var rowIndex = $(this).closest('tr').index() + 1;
            var table = document.getElementById('tblAssignedProjectstatus');
            var projectName = table.rows[rowIndex].cells[3].innerHTML;

            //currentRow = $(this).closest('tr');

            console.log("projectMasterId  :" + projectMasterId);
            console.log("swqcInchargeId  :" + swqcInchargeId);
            console.log("projectName  :" + projectName);
            console.log("pmAssignId  :" + pmAssignId);

            alertify.confirm('Project Paused Confirmation', 'Do you want to Restart this Paused Project?', function () {
                $('#loading').show();
                alertify.success('Successfully Assigned.');

                console.log("projectMasterId  1:" + projectMasterId);
                console.log("swqcInchargeId  1:" + swqcInchargeId);
                console.log("projectName  1:" + projectName);

                var obj = {};

                obj.projectMasterId = projectMasterId;
                obj.projectName = projectName;
                obj.swqcInchargeId = swqcInchargeId;
                obj.pmAssignId = pmAssignId;

                $.ajax({
                    url: '@Url.Action("SwRestartAssignedProject", "Software")',
                    type: 'POST',
                    data: JSON.stringify(obj),
                    contentType: 'application/json; charset=utf-8',
                    success: function (data) {
                        //if (!data.success) {
                        //    if (data.errors.name) {
                        //        //  $('.throw_error').fadeIn(1000).html(data.errors.name);
                        //    }
                        //}
                        //else {
                        //    //  $('#success').fadeIn(1000).append('<p>' + data.posted + '</p>');

                        //    console.log(data);
                        //}
                        if (data == "OK") {
                            window.location = '@Url.Action("SwPauseOrRestartAssignedProject", "Software")';
                            window.location.reload(true);
                            $('#loading').hide();
                        }
                    }
                });
                event.preventDefault(); //Prevent the default submit

            }
                , function () {
                    alertify.error('Cancel');

                });
        });

    });

    $(document).on('submit', 'form', function () {
        var buttons = $(this).find('[type="submit"]');
        if ($(this).valid()) {
            buttons.each(function (btn) {
                $(buttons[btn]).prop('disabled', true);
            });
        } else {
            buttons.each(function (btn) {
                $(buttons[btn]).prop('disabled', false);
            });
        }
    });

    function buttonPausedFunction() {
        var buttons = $(this).find('[id="btnQCAssignProjectPaused"]');
        if ($(this).valid()) {
            buttons.each(function (btn) {
                $(buttons[btn]).prop('disabled', true);
            });
        } else {
            buttons.each(function (btn) {
                $(buttons[btn]).prop('disabled', false);
            });
        }
    }
    //btnReAssignToQcConfirm
    function buttonReAssignFunction() {
        var buttons = $(this).find('[id="btnReAssignToQcConfirm"]');
        if ($(this).valid()) {
            buttons.each(function (btn) {
                $(buttons[btn]).prop('disabled', true);
            });
        } else {
            buttons.each(function (btn) {
                $(buttons[btn]).prop('disabled', false);
            });
        }
    }
</script>

<script src="~/assets/global/scripts/datatable.js" type="text/javascript"></script>
<script src="~/assets/global/plugins/datatables/datatables.min.js" type="text/javascript"></script>
<script src="~/assets/global/plugins/datatables/plugins/bootstrap/datatables.bootstrap.js" type="text/javascript"></script>
<script src="~/assets/pages/scripts/table-datatables-rowreorder.min.js" type="text/javascript"></script>